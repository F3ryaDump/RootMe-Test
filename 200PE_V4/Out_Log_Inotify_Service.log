

==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FkCwIK1qENzxzIKGni.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 504e51418d856d664db23dd55a61352d                                                   |
| sha1                   | 522c0fb1ed2b9594e7a2aab9481883da57d8ca23                                           |
| sha256                 | f190e142f402de460455ff2d1835294a3e118ba74d76aa092af49372bb9b76f4                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FkCwIK1qENzxzIKGni.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FkCwIK1qENzxzIKGni.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777901
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 1.00:1)
Time: 42.201 sec (0 m 42 s)
Start Date: 2022:02:07 11:05:37
End Date:   2022:02:07 11:06:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:05:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FkCwIK1qENzxzIKGni.exe SCORE: 109 TYPE: EXE SIZE: 5120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1b6a1c9610> 
MD5: 504e51418d856d664db23dd55a61352d 
SHA1: 522c0fb1ed2b9594e7a2aab9481883da57d8ca23 
SHA256: f190e142f402de460455ff2d1835294a3e118ba74d76aa092af49372bb9b76f4 CREATED: Mon Feb  7 11:05:37 2022 MODIFIED: Mon Feb  7 11:05:37 2022 ACCESSED: Mon Feb  7 11:06:25 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_3 SUBSCORE: 2 
DESCRIPTION: Low entropy - very sparse data or repeating plaintext REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:06:25Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_3
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_3', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('ImportTableIsBad', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['109']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1747.4862029323024
============================================


==================================================================
Fichier HTTP-FkCwIK1qENzxzIKGni.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F5ljGF1auspPwC6XQ9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F5ljGF1auspPwC6XQ9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777901
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 4.88 MB
Data read: 4.59 MB (ratio 1.06:1)
Time: 42.153 sec (0 m 42 s)
Start Date: 2022:02:07 11:06:26
End Date:   2022:02:07 11:07:08

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 4: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:06:26Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F5ljGF1auspPwC6XQ9.exe SCORE: 534 TYPE: EXE SIZE: 4809232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6bdeaf7fa0> 
MD5: 2be5d5def542fd59a2278a656b074f65 
SHA1: 9bbc3f83076e41f3b69c11aa061adea74fca7e7c 
SHA256: 09d53831ce63aea279aaa08d670b6290312f63fedfe1981f819e58d774a68fa0 CREATED: Mon Feb  7 11:06:26 2022 MODIFIED: Mon Feb  7 11:06:26 2022 ACCESSED: Mon Feb  7 11:07:17 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_19: Yara Rule MATCH: Debugger_Check__RemoteAPI SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: CheckRemoteDebuggerPresent
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_23: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_24: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
REASON_25: Yara Rule MATCH: RijnDael_AES_CHAR SUBSCORE: 15 
DESCRIPTION: RijnDael AES (check2) [char] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:07:29Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		Debugger_Check__QueryInfo
60		Debugger_Check__RemoteAPI
20		isExecutable
10		Contains_PE_File
25		Crypt32_CryptBinaryToString_API
15		RIPEMD160_Constants
20		SHA1_Constants
15		RijnDael_AES_CHAR

Score total: 534

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2be5d5def542fd59a2278a656b074f65                                                   |
| sha1                   | 9bbc3f83076e41f3b69c11aa061adea74fca7e7c                                           |
| sha256                 | 09d53831ce63aea279aaa08d670b6290312f63fedfe1981f819e58d774a68fa0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F5ljGF1auspPwC6XQ9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
| DATA                        | Decompress Data::QuickLZ [C0025.001]                                          |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints (2 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (15 matches)            | anti-analysis/anti-vm/vm-detection                   |
| check HTTP status code (3 matches)                   | communication/http/client                            |
| decompress data using QuickLZ                        | data-manipulation/compression                        |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| encode data using XOR (32 matches)                   | data-manipulation/encoding/xor                       |
| hash data via BCrypt (4 matches)                     | data-manipulation/hashing                            |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| hash data using SHA1 (3 matches)                     | data-manipulation/hashing/sha1                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (3 matches)   | host-interaction/driver                              |
| get system information on Windows (21 matches)       | host-interaction/os/info                             |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (48 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]

Score total: 23.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('Debugger_Check__QueryInfo', '60'), ('Debugger_Check__RemoteAPI', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Crypt32_CryptBinaryToString_API', '25'), ('RIPEMD160_Constants', '15'), ('SHA1_Constants', '20'), ('RijnDael_AES_CHAR', '15')]
-------------- LOKI_Score ------------
['534']
-------------- CAPA_Score ------------
['23.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8922.239980185186
============================================


==================================================================
Fichier HTTP-F5ljGF1auspPwC6XQ9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FA5eEJ1Nrp60CYfvHj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f72d773f13ceb6b842a9d29c56f8880f                                                   |
| sha1                   | 967eea1c315970db632b9dabeaf10ee5b9d47696                                           |
| sha256                 | d66e15eea51ebd4bfd13f8c97646253740b1e6a99328d22232fd01ae13ef5d05                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FA5eEJ1Nrp60CYfvHj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | HTTP Communication::IWebBrowser [C0002.010]                                   |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| initialize IWebBrowser2                              | communication/http                                   |
| interact with driver via control codes               | host-interaction/driver                              |
| write file on Windows                                | host-interaction/file-system/write                   |
| create service                                       | host-interaction/service/create                      |
| start service                                        | host-interaction/service/start                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3		- Execution::System Services::Service Execution [T1569.002;3]

Score total: 13.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FA5eEJ1Nrp60CYfvHj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777901
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 41.402 sec (0 m 41 s)
Start Date: 2022:02:07 11:29:57
End Date:   2022:02:07 11:30:38

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 8: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 2-3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbf in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 3-4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8e in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdc in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfb in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb0 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf4 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdf in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 9: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8e in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe1 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:29:58Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FA5eEJ1Nrp60CYfvHj.exe SCORE: 729 TYPE: EXE SIZE: 24576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7feff94cbfa0> 
MD5: f72d773f13ceb6b842a9d29c56f8880f 
SHA1: 967eea1c315970db632b9dabeaf10ee5b9d47696 
SHA256: d66e15eea51ebd4bfd13f8c97646253740b1e6a99328d22232fd01ae13ef5d05 CREATED: Mon Feb  7 11:29:56 2022 MODIFIED: Mon Feb  7 11:29:56 2022 ACCESSED: Mon Feb  7 11:30:55 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68f040400068741c400064a100000000506489250000000083ec585356578965e8ff154440400033d28ad48915545540008bc881e1ff0000008 ... (truncated)
REASON_6: Yara Rule MATCH: Installer_VISE_Custom_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a100000000506489250000000083ec585356578965e8ff154440400033d28ad48915545540008bc881e1ff000000890d
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a10000000050 Str2: 558bec6aff683044400068741c400064a10000000050 Str3: 558bec6aff684844400068741c40006 ... (truncated)
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a10000000050 Str2: 558bec6aff683044400068741c400064a10000000050 Str3: 558bec6aff684844400068741c40006 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec53 Str3: 558bec51 Str4: 558bec8b Str5: 558bec83 Str6: 558bec81 Str7: 558bec57 Str8: 558bec6aff68f040400068741c40 ... (truncated)
REASON_10: Yara Rule MATCH: Installer_VISE_Custom SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a100000000506489250000000083ec585356578965e8ff154440400033d28ad48915545540008bc881e1ff000000890d
REASON_11: Yara Rule MATCH: Armadillo_v4x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 40400085c00f84160100006a006a006a006a006a0068a85040006a016a036a0168ff010f006898504000689850400050ff15084040008b Str2: 6a006a006801efcd ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a1000000005064892500000000 Str2: 558bec6aff683044400068741c400064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:30:55Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_4
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Installer_VISE_Custom_additional
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Installer_VISE_Custom
70		Armadillo_v4x
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 729

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Installer_VISE_Custom_additional', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Installer_VISE_Custom', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['729']
-------------- CAPA_Score ------------
['13.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
11823.231785562315
============================================


==================================================================
Fichier HTTP-FA5eEJ1Nrp60CYfvHj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Feayh03iMJajG9KyNl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | d707382b7d60eb8830a2da9d6480062a                                                   |
| sha1                   | 4c721616200b2cd92d7716981999d94f549732a8                                           |
| sha256                 | bf331cdf306fe1d01a5b4b81b898a268d0d1c8461c4aeda19d5c67f5fad981b1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Feayh03iMJajG9KyNl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Feayh03iMJajG9KyNl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777901
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 42.804 sec (0 m 42 s)
Start Date: 2022:02:07 11:30:55
End Date:   2022:02:07 11:31:38

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:30:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Feayh03iMJajG9KyNl.exe SCORE: 264 TYPE: EXE SIZE: 59904 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f07cd9b0fa0> 
MD5: d707382b7d60eb8830a2da9d6480062a 
SHA1: 4c721616200b2cd92d7716981999d94f549732a8 
SHA256: bf331cdf306fe1d01a5b4b81b898a268d0d1c8461c4aeda19d5c67f5fad981b1 CREATED: Mon Feb  7 11:30:55 2022 MODIFIED: Mon Feb  7 11:30:55 2022 ACCESSED: Mon Feb  7 11:31:48 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e83b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:31:48Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 264

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['264']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4263.928520696095
============================================


==================================================================
Fichier HTTP-Feayh03iMJajG9KyNl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFVOwGLc96Lqtvmdf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5f69f4f8683151a59c5a11265b4a3c96                                                   |
| sha1                   | 95ae738ab6b2cc92d88e3debbaacdd924bc27f5e                                           |
| sha256                 | edc1b6a3e4fde216a323329e35f4192b0f49bc68285ee67036deff9e94c4e33a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFVOwGLc96Lqtvmdf.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFVOwGLc96Lqtvmdf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777901
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 40.355 sec (0 m 40 s)
Start Date: 2022:02:07 11:31:48
End Date:   2022:02:07 11:32:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:31:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFVOwGLc96Lqtvmdf.exe SCORE: 229 TYPE: EXE SIZE: 30720 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f538f63efa0> 
MD5: 5f69f4f8683151a59c5a11265b4a3c96 
SHA1: 95ae738ab6b2cc92d88e3debbaacdd924bc27f5e 
SHA256: edc1b6a3e4fde216a323329e35f4192b0f49bc68285ee67036deff9e94c4e33a CREATED: Mon Feb  7 11:31:48 2022 MODIFIED: Mon Feb  7 11:31:48 2022 ACCESSED: Mon Feb  7 11:32:41 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e80b0300004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:32:41Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3649.358033885638
============================================


==================================================================
Fichier HTTP-FFVOwGLc96Lqtvmdf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fg1vV04dL4ulqK5j6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ed888dc2f04f5eac83d6d14088d002de                                                   |
| sha1                   | b6ec6a00d53f4ee8ef51d7e533f63d4f9cd171f4                                           |
| sha256                 | c78dae3e6ef91539408d1def9724f89b1aae44e4003f464d21f20e28abc8310a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fg1vV04dL4ulqK5j6.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | System Information Discovery:: \[T1082]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Check String:: [C0019]                                                        |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| compiled with py2exe (2 matches)                     | compiler/py2exe                                      |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (3 matches)  | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| read file via mapping                                | host-interaction/file-system/read                    |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| terminate process                                    | host-interaction/process/terminate                   |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| linked against ZLIB                                  | linking/static/zlib                                  |
| parse PE header                                      | load-code/pe                                         |
| reference startup folder                             | persistence/startup-folder                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 17.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fg1vV04dL4ulqK5j6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777901
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 22.61 MB
Data read: 4.47 MB (ratio 5.06:1)
Time: 94.614 sec (1 m 34 s)
Start Date: 2022:02:07 11:32:42
End Date:   2022:02:07 11:34:16

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ldpreload', '15'), ('ft_exe', '10'), ('ConventionEngine_Anomaly_OutsideOfDebug', '50'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('Visual_Cpp_2005_Release_Microsoft', '70'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('HasRichSignature', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('DebuggerException__ConsoleCtrl_v1', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('Check_OutputDebugStringA_iat_v1', '30'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Netwalker', '60'), ('isExecutable', '20'), ('py2exe', '5'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('CRC16_table', '15'), ('MD5_Constants', '20'), ('RIPEMD160_Constants', '15'), ('SHA1_Constants', '20'), ('SHA512_Constants', '20'), ('SHA2_BLAKE2_IVs', '20'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['2409']
-------------- CAPA_Score ------------
['17.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
38519.27159993292
============================================


==================================================================
Fichier HTTP-Fg1vV04dL4ulqK5j6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FWeSY33VLHWW7QFHlg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FWeSY33VLHWW7QFHlg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777901
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.30 MB
Data read: 1.23 MB (ratio 1.06:1)
Time: 41.453 sec (0 m 41 s)
Start Date: 2022:02:07 11:34:17
End Date:   2022:02:07 11:34:58

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:34:17Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FWeSY33VLHWW7QFHlg.exe SCORE: 324 TYPE: EXE SIZE: 1288704 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb47c244fa0> 
MD5: 84aa261b1e0160be470ee27610bc65aa 
SHA1: cb517e3380f9b826bc4feccb23b0485951d86bc9 
SHA256: 352f2217ae1b5baabe77d8c9b74356cdbcd893799add6580b2960b19efb8800a CREATED: Mon Feb  7 11:34:17 2022 MODIFIED: Mon Feb  7 11:34:17 2022 ACCESSED: Mon Feb  7 11:35:09 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: possible_includes_base64_packed_functions SUBSCORE: 25 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: atob Str2: This Str3: prog Str4: rogr Str5: ogra Str6: gram Str7: cann Str8: anno Str9: nnot Str10: mode Str11: Rich Str12: ichq Str1 ... (truncated)
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8f30800004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 75e40ac34da01d8b94fb6c09da8faff9 Str2: fd9a02c99d8294ea49df9fe274c83d4e Str3: f0b3cb648fe4baa9256ee1b64fd823bb Str4: 246bafd328781690 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:35:28Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
25		possible_includes_base64_packed_functions
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 324

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 84aa261b1e0160be470ee27610bc65aa                                                   |
| sha1                   | cb517e3380f9b826bc4feccb23b0485951d86bc9                                           |
| sha256                 | 352f2217ae1b5baabe77d8c9b74356cdbcd893799add6580b2960b19efb8800a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FWeSY33VLHWW7QFHlg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| hash data using fnv (3 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| access PEB ldr_data (41 matches)                     | linking/runtime-linking                              |
| parse PE header (125 matches)                        | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
2		- Execution::Shared Modules [T1129;2]

Score total: 6.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('possible_includes_base64_packed_functions', '25'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['324']
-------------- CAPA_Score ------------
['6.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5254.769682472141
============================================


==================================================================
Fichier HTTP-FWeSY33VLHWW7QFHlg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FpUvEP2sNB18Z1sFPj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FpUvEP2sNB18Z1sFPj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777921
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 37.097 sec (0 m 37 s)
Start Date: 2022:02:07 11:39:21
End Date:   2022:02:07 11:39:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Installer_VISE_Custom_additional', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Installer_VISE_Custom', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Check_OutputDebugStringA_iat_v1', '30'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('VC6_Random', '15')]
-------------- LOKI_Score ------------
['824']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
13059.519905879573
============================================


==================================================================
Fichier HTTP-FpUvEP2sNB18Z1sFPj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1sdCE3pfeGagGSyC5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5108f54e67cc5d1a44db4fb64a6045c2                                                   |
| sha1                   | 5cb13a7e44537498c988358cd59a155d2d497c0d                                           |
| sha256                 | 8c43c3947c1d6599e9f115eb82c6e6829fa3affd993f0b4207a1e3bf023d1fe8                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F1sdCE3pfeGagGSyC5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists (6 matches)                     | host-interaction/file-system/exists                  |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::Query Registry [T1012;1]

Score total: 12.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1sdCE3pfeGagGSyC5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777921
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 43.654 sec (0 m 43 s)
Start Date: 2022:02:07 11:40:14
End Date:   2022:02:07 11:40:58

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:40:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F1sdCE3pfeGagGSyC5.exe SCORE: 394 TYPE: EXE SIZE: 69120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb636107fa0> 
MD5: 5108f54e67cc5d1a44db4fb64a6045c2 
SHA1: 5cb13a7e44537498c988358cd59a155d2d497c0d 
SHA256: 8c43c3947c1d6599e9f115eb82c6e6829fa3affd993f0b4207a1e3bf023d1fe8 CREATED: Mon Feb  7 11:40:14 2022 MODIFIED: Mon Feb  7 11:40:14 2022 ACCESSED: Mon Feb  7 11:41:04 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:41:04Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 394

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_token', '65'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['394']
-------------- CAPA_Score ------------
['12.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6493.886967667896
============================================


==================================================================
Fichier HTTP-F1sdCE3pfeGagGSyC5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FGGGTX2rBjqpao5Ril.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FGGGTX2rBjqpao5Ril.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777921
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.24 MB
Data read: 0.23 MB (ratio 1.02:1)
Time: 43.646 sec (0 m 43 s)
Start Date: 2022:02:07 11:41:05
End Date:   2022:02:07 11:41:49

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:41:05Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FGGGTX2rBjqpao5Ril.exe SCORE: 574 TYPE: EXE SIZE: 245760 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb75af59fa0> 
MD5: 01e057351737ec63730e86352e4e7436 
SHA1: e59a43da67d67361a7db486148e1ba86008725f9 
SHA256: a275b52cf71d8809455e69e46b073d9c802f5a045850c2598885d3d974ad07a5 CREATED: Mon Feb  7 11:41:05 2022 MODIFIED: Mon Feb  7 11:41:05 2022 ACCESSED: Mon Feb  7 11:41:56 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateThread
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e82b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateThread
REASON_17: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:41:57Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
60		win_mutex
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
45		Inject_Thread
60		Debugger_Check__QueryInfo
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 574

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 01e057351737ec63730e86352e4e7436                                                   |
| sha1                   | e59a43da67d67361a7db486148e1ba86008725f9                                           |
| sha256                 | a275b52cf71d8809455e69e46b073d9c802f5a045850c2598885d3d974ad07a5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FGGGTX2rBjqpao5Ril.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
| DISCOVERY                   | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Get File Attributes:: [C0049]                                                 |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| hash data via BCrypt (2 matches)                     | data-manipulation/hashing                            |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments (3 matches)            | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path (6 matches)                     | host-interaction/file-system                         |
| create directory                                     | host-interaction/file-system/create                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get file size                                        | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information (2 matches)                     | host-interaction/hardware/storage                    |
| print debug messages (7 matches)                     | host-interaction/log/debug/write-event               |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| check mutex                                          | host-interaction/mutex                               |
| check mutex and exit                                 | host-interaction/mutex                               |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| read process memory (21 matches)                     | host-interaction/process                             |
| enumerate process modules (6 matches)                | host-interaction/process/modules/list                |
| terminate process via fastfail (10 matches)          | host-interaction/process/terminate                   |
| query or enumerate registry value (14 matches)       | host-interaction/registry                            |
| set registry value (12 matches)                      | host-interaction/registry/create                     |
| delete registry key (4 matches)                      | host-interaction/registry/delete                     |
| delete registry value (2 matches)                    | host-interaction/registry/delete                     |
| start service                                        | host-interaction/service/start                       |
| get token membership (4 matches)                     | host-interaction/session                             |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| access PE header                                     | load-code/pe                                         |
| parse PE header (11 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::System Owner/User Discovery [T1033;3]
4		- Discovery::Process Discovery [T1057;4]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 27.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_mutex', '60'), ('win_registry', '20'), ('win_token', '65'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Inject_Thread', '45'), ('Debugger_Check__QueryInfo', '60'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['574']
-------------- CAPA_Score ------------
['27.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
9645.984061343232
============================================


==================================================================
Fichier HTTP-FGGGTX2rBjqpao5Ril.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FzA3A81FsCOwgXrXV4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FzA3A81FsCOwgXrXV4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777921
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.45 MB
Data read: 0.43 MB (ratio 1.05:1)
Time: 44.328 sec (0 m 44 s)
Start Date: 2022:02:07 11:42:10
End Date:   2022:02:07 11:42:54

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x82 in position 9: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:42:10Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FzA3A81FsCOwgXrXV4.exe SCORE: 239 TYPE: EXE SIZE: 453168 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f98cc04dfa0> 
MD5: 811f0bf8bf1262b9fdc256b21599e800 
SHA1: 0f0b33ac2b42e951c556560a9a7e11dff8a691fa 
SHA256: d2f7a0266bcc4eb8521bcdbf98a37dccc27891b6cc96aaf7fc2c1ec77b4d81b7 CREATED: Mon Feb  7 11:42:10 2022 MODIFIED: Mon Feb  7 11:42:10 2022 ACCESSED: Mon Feb  7 11:43:02 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 30600000000202003082602206092a864886f70d010702a08260133082600f020101310b300906052b0e03021a05003068060a2b060104018237020104a05a3058303 ... (truncated)
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:43:03Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDigitalSignature
10		HasDebugData
10		HasRichSignature
2		PE_File
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 239

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 811f0bf8bf1262b9fdc256b21599e800                                                   |
| sha1                   | 0f0b33ac2b42e951c556560a9a7e11dff8a691fa                                           |
| sha256                 | d2f7a0266bcc4eb8521bcdbf98a37dccc27891b6cc96aaf7fc2c1ec77b4d81b7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FzA3A81FsCOwgXrXV4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR (36 matches)                   | data-manipulation/encoding/xor                       |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| check OS version                                     | host-interaction/os/version                          |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE exports (5 matches)                         | load-code/pe                                         |
| parse PE header (29 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 10.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDigitalSignature', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['239']
-------------- CAPA_Score ------------
['10.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3997.397273053793
============================================


==================================================================
Fichier HTTP-FzA3A81FsCOwgXrXV4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fdf0UY3tPOdsfoRBi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c0781854a5cd83024f2f8683eb888a3c                                                   |
| sha1                   | 9fe6eb078a48b15a5c2be4ffbebf42f611bca0ff                                           |
| sha256                 | 17656523a20593ad128ec1bb0df99e025a3430e33b6a2cf4f613d14a00ae41d3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fdf0UY3tPOdsfoRBi.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fdf0UY3tPOdsfoRBi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777921
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 41.725 sec (0 m 41 s)
Start Date: 2022:02:07 11:43:46
End Date:   2022:02:07 11:44:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:43:46Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fdf0UY3tPOdsfoRBi.exe SCORE: 194 TYPE: EXE SIZE: 63488 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb96a082fa0> 
MD5: c0781854a5cd83024f2f8683eb888a3c 
SHA1: 9fe6eb078a48b15a5c2be4ffbebf42f611bca0ff 
SHA256: 17656523a20593ad128ec1bb0df99e025a3430e33b6a2cf4f613d14a00ae41d3 CREATED: Mon Feb  7 11:43:46 2022 MODIFIED: Mon Feb  7 11:43:46 2022 ACCESSED: Mon Feb  7 11:44:35 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:44:35Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 194

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['194']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3134.550662823626
============================================


==================================================================
Fichier HTTP-Fdf0UY3tPOdsfoRBi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FZSHVu3Cz2t68jMcxb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:44:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FZSHVu3Cz2t68jMcxb.exe SCORE: 1089 TYPE: EXE SIZE: 937984 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f56ab0e3fa0> 
MD5: ad4229879180e267f431ac6666b6a0a2 
SHA1: c191c35ac423b381efc84edce74d7a96dbd9ac7d 
SHA256: aa52dcaf6df43c6aa872fe0f73725f61e082d32c33fc976741d4eca17679533d CREATED: Mon Feb  7 11:44:35 2022 MODIFIED: Mon Feb  7 11:44:35 2022 ACCESSED: Mon Feb  7 11:45:07 2022 
REASON_1: Malware Hash TYPE: SHA1 HASH: c191c35ac423b381efc84edce74d7a96dbd9ac7d SUBSCORE: 100 DESC: Continued GreenBug/Shamoon attacks against Saudi Arabia https://twitter.com/eyalsela/status/885893685325574144
REASON_2: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: socket Str3: connect
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: win_ismdoor_auto SUBSCORE: 45 
DESCRIPTION: Detects win.ismdoor. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 32c0eb05c0e804240184c00f94c3 Str2: c1e00803c88bd98bc148c1e81283e03f Str3: 83e11f49c1e805428b04820fa3c873034533c9 Str4: 4883ec40488bda ... (truncated)
REASON_8: Yara Rule MATCH: ConventionEngine_Keyword_Bot SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_9: Yara Rule MATCH: ConventionEngine_Term_Documents SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_10: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_11: Yara Rule MATCH: ConventionEngine_Term_VisualStudio SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_12: Yara Rule MATCH: Greenbug_Malware_4 SUBSCORE: 70 
DESCRIPTION: Detects ISMDoor Backdoor REF: https://goo.gl/urp4CD AUTHOR: Florian Roth 
MATCHES: Str1: c:\windows	emp	mp8873
REASON_13: Yara Rule MATCH: Greenbug_Malware_5 SUBSCORE: 70 
DESCRIPTION: Auto-generated rule REF: https://goo.gl/urp4CD AUTHOR: Florian Roth 
MATCHES: Str1: cmd /u /c WMIC /Node:localhost /Namespace:oot\SecurityCenter Str2: cmd /a /c net user administrator /domain >> Str3: ============= ... (truncated)
REASON_14: Yara Rule MATCH: Recon_Commands_Windows_Gen1 SUBSCORE: 60 
DESCRIPTION: Detects a set of reconnaissance commands on Windows systems REF: https://goo.gl/MSJCxP AUTHOR: Florian Roth 
MATCHES: Str1: netstat -an Str2: net view Str3: net user Str4: systeminfo Str5: net user administrator
REASON_15: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_17: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_18: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_21: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_22: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_24: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_25: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_26: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_27: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_28: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_29: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_30: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: A67D0DB885A343257654
REASON_31: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: A67D0DB8A2A173347654432503702AA3 Str2: A67D0DB8A2A173347654432503701111 Str3: A67D0DB885A3432576548A2A03707334 Str4: A67D0DB885A34325 ... (truncated)
REASON_32: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_33: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_34: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:45:08Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
50		network_tcp_socket
65		screenshot
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
45		win_ismdoor_auto
50		ConventionEngine_Keyword_Bot
50		ConventionEngine_Term_Documents
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_VisualStudio
70		Greenbug_Malware_4
70		Greenbug_Malware_5
60		Recon_Commands_Windows_Gen1
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		DebuggerException__SetConsoleCtrl_v1
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0
10		Big_Numbers1
25		CRC32_poly_Constant
25		CRC32_table
5		BASE64_table

Score total: 1089

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FZSHVu3Cz2t68jMcxb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777921
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.95 MB
Data read: 0.89 MB (ratio 1.06:1)
Time: 44.061 sec (0 m 44 s)
Start Date: 2022:02:07 11:44:35
End Date:   2022:02:07 11:45:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ad4229879180e267f431ac6666b6a0a2                                                   |
| sha1                   | c191c35ac423b381efc84edce74d7a96dbd9ac7d                                           |
| sha256                 | aa52dcaf6df43c6aa872fe0f73725f61e082d32c33fc976741d4eca17679533d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FZSHVu3Cz2t68jMcxb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Screen Capture:: \[T1113]\                                                          |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COLLECTION                  | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence:: [C0021]                                     |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Adler [C0032.005]                                                   |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings (2 matches)              | anti-analysis/obfuscation/string/stackstring         |
| capture screenshot                                       | collection/screenshot                                |
| receive data                                             | communication                                        |
| send data (2 matches)                                    | communication                                        |
| reference Google Public DNS server                       | communication/dns                                    |
| get socket status                                        | communication/socket                                 |
| initialize Winsock library (2 matches)                   | communication/socket                                 |
| compute adler32 checksum                                 | data-manipulation/checksum/adler32                   |
| encode data using Base64                                 | data-manipulation/encoding/base64                    |
| reference Base64 string                                  | data-manipulation/encoding/base64                    |
| encode data using XOR (10 matches)                       | data-manipulation/encoding/xor                       |
| hash data using fnv (6 matches)                          | data-manipulation/hashing/fnv                        |
| authenticate HMAC                                        | data-manipulation/hmac                               |
| generate random numbers using the Delphi LCG (5 matches) | data-manipulation/prng/lcg                           |
| contains PDB path                                        | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                       | executable/pe/section/rsrc                           |
| get common file path (4 matches)                         | host-interaction/file-system                         |
| copy file                                                | host-interaction/file-system/copy                    |
| create directory (2 matches)                             | host-interaction/file-system/create                  |
| delete file                                              | host-interaction/file-system/delete                  |
| check if file exists (3 matches)                         | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions                   | host-interaction/file-system/files/list              |
| get file attributes (4 matches)                          | host-interaction/file-system/meta                    |
| get file size                                            | host-interaction/file-system/meta                    |
| move file                                                | host-interaction/file-system/move                    |
| read file on Windows (5 matches)                         | host-interaction/file-system/read                    |
| write file on Windows (6 matches)                        | host-interaction/file-system/write                   |
| print debug messages                                     | host-interaction/log/debug/write-event               |
| allocate thread local storage                            | host-interaction/process                             |
| get thread local storage value (7 matches)               | host-interaction/process                             |
| set thread local storage value (4 matches)               | host-interaction/process                             |
| create process on Windows                                | host-interaction/process/create                      |
| terminate process (2 matches)                            | host-interaction/process/terminate                   |
| create thread (11 matches)                               | host-interaction/thread/create                       |
| linked against XZip                                      | linking/static/xzip                                  |
| enumerate PE sections (2 matches)                        | load-code/pe                                         |
| parse PE header (5 matches)                              | load-code/pe                                         |
| get startup folder                                       | persistence/startup-folder                           |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
6		- Collection::Screen Capture [T1113;6]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]

Score total: 34.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Collection::Screen Capture [T1113;6]', '6'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100'), ('network_tcp_socket', '50'), ('screenshot', '65'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('win_ismdoor_auto', '45'), ('ConventionEngine_Keyword_Bot', '50'), ('ConventionEngine_Term_Documents', '50'), ('ConventionEngine_Term_Users', '50'), ('ConventionEngine_Term_VisualStudio', '50'), ('Greenbug_Malware_4', '70'), ('Greenbug_Malware_5', '70'), ('Recon_Commands_Windows_Gen1', '60'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers0', '10'), ('Big_Numbers1', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['1089']
-------------- CAPA_Score ------------
['34.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
17947.852364565788
============================================


==================================================================
Fichier HTTP-FZSHVu3Cz2t68jMcxb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FjbwBcuw3LMe25Xvi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 480f710806b68dfe478ca1ec7d7e79cc                                                   |
| sha1                   | b4fc97fed2dbff9c4874cb65ede7b50699db37cd                                           |
| sha256                 | 2416cd4aa577dbb2f8790a61e36fbab2b30bff81a4e1f67a5151c2fec29585bc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FjbwBcuw3LMe25Xvi.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (3 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| print debug messages (5 matches)                     | host-interaction/log/debug/write-event               |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::Query Registry [T1012;1]

Score total: 10.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FjbwBcuw3LMe25Xvi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 43.403 sec (0 m 43 s)
Start Date: 2022:02:07 11:47:34
End Date:   2022:02:07 11:48:17

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:47:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FjbwBcuw3LMe25Xvi.exe SCORE: 394 TYPE: EXE SIZE: 87312 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3c0dec7fa0> 
MD5: 480f710806b68dfe478ca1ec7d7e79cc 
SHA1: b4fc97fed2dbff9c4874cb65ede7b50699db37cd 
SHA256: 2416cd4aa577dbb2f8790a61e36fbab2b30bff81a4e1f67a5151c2fec29585bc CREATED: Mon Feb  7 11:47:34 2022 MODIFIED: Mon Feb  7 11:47:34 2022 ACCESSED: Mon Feb  7 11:48:26 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:48:26Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 394

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['394']
-------------- CAPA_Score ------------
['10.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6453.981721368518
============================================


==================================================================
Fichier HTTP-FjbwBcuw3LMe25Xvi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FBGujc4eDVM1Vc0Jg1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:48:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FBGujc4eDVM1Vc0Jg1.exe SCORE: 489 TYPE: EXE SIZE: 95232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2245fcffa0> 
MD5: 138c71e94961fe9e31cec5dfba62a639 
SHA1: 7cc00da91f83d9e2f06172275f680501a09edd7c 
SHA256: f81c70bc3d908f8152e3bfcdabf6538291d6a649fb6957d646fbde54d1ca1caf CREATED: Mon Feb  7 11:48:26 2022 MODIFIED: Mon Feb  7 11:48:26 2022 ACCESSED: Mon Feb  7 11:49:06 2022 
REASON_1: Yara Rule MATCH: network_udp_sock SUBSCORE: 45 
DESCRIPTION: Communications over UDP network REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.DLL Str2: WSOCK32.dll Str3: WSASendTo Str4: WSARecvFrom
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.DLL Str2: WSOCK32.dll Str3: WSASocket Str4: WSASend Str5: WSAConnect
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: RegQueryValueExA Str4: RegOpenKeyExA Str5: RegCloseKey Str6: RegSetValueExA
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: OpenProcessToken
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: ws2_32.DLL Str2: WSOCK32.dll
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_9: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_10: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645e780c645e85fc645e948c645 Str2: c645e85fc645e948c645eaa1c645 Str3: c645f780c645f85fc645f948c645 Str4: c645f85fc645f948c645faa1c645
REASON_13: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_14: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_18: Yara Rule MATCH: IsBeyondImageSize SUBSCORE: 10 
DESCRIPTION: Data Beyond ImageSize Check REF: - AUTHOR: _pusher_
REASON_19: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_20: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_22: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_23: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000
REASON_24: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_25: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:49:07Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_udp_sock
45		network_http
50		network_tcp_socket
20		win_registry
65		win_token
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
5		winsocks
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		IsBeyondImageSize
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 489

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FBGujc4eDVM1Vc0Jg1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 43.967 sec (0 m 43 s)
Start Date: 2022:02:07 11:48:26
End Date:   2022:02:07 11:49:10

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 138c71e94961fe9e31cec5dfba62a639                                                   |
| sha1                   | 7cc00da91f83d9e2f06172275f680501a09edd7c                                           |
| sha256                 | f81c70bc3d908f8152e3bfcdabf6538291d6a649fb6957d646fbde54d1ca1caf                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FBGujc4eDVM1Vc0Jg1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                             | anti-analysis/anti-vm/vm-detection                   |
| query remote server for available data                | communication                                        |
| receive data (2 matches)                              | communication                                        |
| parse URL (4 matches)                                 | communication/http                                   |
| check HTTP status code                                | communication/http/client                            |
| connect to HTTP server                                | communication/http/client                            |
| create HTTP request                                   | communication/http/client                            |
| obtain TransmitPackets callback function via WSAIoctl | communication/socket/tcp/send                        |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions               | executable/resource                                  |
| accept command line arguments                         | host-interaction/cli                                 |
| get local IPv4 addresses (2 matches)                  | host-interaction/network/address                     |
| get hostname                                          | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)         | host-interaction/os/info                             |
| check OS version                                      | host-interaction/os/version                          |
| query or enumerate registry key (3 matches)           | host-interaction/registry                            |
| query or enumerate registry value (10 matches)        | host-interaction/registry                            |
| set registry value (8 matches)                        | host-interaction/registry/create                     |
| delete registry key                                   | host-interaction/registry/delete                     |
| delete registry value                                 | host-interaction/registry/delete                     |
| compare security identifiers                          | host-interaction/sid                                 |
| create thread (2 matches)                             | host-interaction/thread/create                       |
| link many functions at runtime                        | linking/runtime-linking                              |
| parse PE header                                       | load-code/pe                                         |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 33.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_udp_sock', '45'), ('network_http', '45'), ('network_tcp_socket', '50'), ('win_registry', '20'), ('win_token', '65'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('winsocks', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('IsBeyondImageSize', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['489']
-------------- CAPA_Score ------------
['33.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8408.564275074574
============================================


==================================================================
Fichier HTTP-FBGujc4eDVM1Vc0Jg1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FyaFEPZJCvxMH7OU8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FyaFEPZJCvxMH7OU8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.71 MB
Data read: 0.67 MB (ratio 1.06:1)
Time: 49.076 sec (0 m 49 s)
Start Date: 2022:02:07 11:49:11
End Date:   2022:02:07 11:50:00

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfb in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfb in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 26: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 21: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 26: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 21: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:49:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FyaFEPZJCvxMH7OU8.exe SCORE: 584 TYPE: EXE SIZE: 707072 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f701d985fa0> 
MD5: 477743976643213d96b66ed5041a3b12 
SHA1: c1cd5adff4e3e03bd736c1896019c33764b06ff6 
SHA256: da5acdec87c3b5e3dcdbde1d82650d5c1e1f1ce420bdbc99347b662c1a71dda3 CREATED: Mon Feb  7 11:49:11 2022 MODIFIED: Mon Feb  7 11:49:11 2022 ACCESSED: Mon Feb  7 11:50:04 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.DLL Str2: GDI32.dll Str3: user32.dll Str4: USER32.DLL Str5: USER32.dll Str6: BitBlt Str7: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: GetKeyState
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA Str6: RegCreateKeyA
REASON_4: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: GetPrivateProfileIntA Str4: GetPrivateProfileStringA Str5: WritePrivateProfileStringA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: FindFir ... (truncated)
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e819130000e910fdffff Str2: e8cddaffffe958ffffff Str3: e8802e0100e95dfdffff Str4: e8662e0100e96dfeffff Str5: e84fb5fdffe931ffffff Str6 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3:  Str4:  Str5:  Str6: 000000000000c0000000000000461801000000000000c0000000000000461201000000000000c0000000000000461501 ... (truncated)
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_18: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: UnhookWindowsHookEx Str5: SetWindowsHookExA Str6: CallNextHookEx
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:50:06Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
10		win_private_profile
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_hook
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
35		Win_Hook_v12
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 584

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 477743976643213d96b66ed5041a3b12                                                   |
| sha1                   | c1cd5adff4e3e03bd736c1896019c33764b06ff6                                           |
| sha256                 | da5acdec87c3b5e3dcdbde1d82650d5c1e1f1ce420bdbc99347b662c1a71dda3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FyaFEPZJCvxMH7OU8.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | System Shutdown/Reboot:: \[T1529]\                                                 |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| get common file path                                 | host-interaction/file-system                         |
| delete file (2 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read .ini file                                       | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| set application hook                                 | host-interaction/gui                                 |
| get graphical window text (3 matches)                | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| shutdown system                                      | host-interaction/os                                  |
| allocate thread local storage                        | host-interaction/process                             |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process                                    | host-interaction/process/terminate                   |
| create or open registry key (2 matches)              | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| get session user name                                | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::Account Discovery [T1087;3]
4		- Discovery::Process Discovery [T1057;4]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
9		- Impact::System Shutdown/Reboot [T1529;9]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
1		- Discovery::Query Registry [T1012;1]

Score total: 55.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::System Shutdown/Reboot [T1529;9]', '9'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('dll_injection_hook', '15'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Win_Hook_v12', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['584']
-------------- CAPA_Score ------------
['55.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
10363.14682878063
============================================


==================================================================
Fichier HTTP-FyaFEPZJCvxMH7OU8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FLgGpJ25AKslkBlyxk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FLgGpJ25AKslkBlyxk.exe: Win.Exploit.CVE_2017_0213-6306933-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.564 sec (0 m 43 s)
Start Date: 2022:02:07 11:51:05
End Date:   2022:02:07 11:51:48

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2017_0213-6306933-0

Score total: 25.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd1 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x99 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfa in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:51:05Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FLgGpJ25AKslkBlyxk.exe SCORE: 534 TYPE: EXE SIZE: 48640 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f0a22952fa0> 
MD5: 3ca359f5085bb96a7950d4735b089ffe 
SHA1: 60747604d54a18c4e4dc1a2c209e77a793e64dde 
SHA256: 7af61ce420051640c50b0e73e718dd8c55dddfcb58917a3bead9d3ece2f3e929 CREATED: Mon Feb  7 11:51:05 2022 MODIFIED: Mon Feb  7 11:51:05 2022 ACCESSED: Mon Feb  7 11:51:56 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: OpenProcessToken
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_ragnarlocker_auto SUBSCORE: 45 
DESCRIPTION: Detects win.ragnarlocker. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8bec518b450c5356578d1c80 Str2: 8bfac1ef070fa4ca190bf2c1e11931750c0bf9 Str3: 8d4d10518d8d4cf5ffff51680401000050 Str4: 0f47d152ffd68d45 ... (truncated)
REASON_6: Yara Rule MATCH: MAL_RANSOM_Ragna_Locker_Apr20_1 SUBSCORE: 70 
DESCRIPTION: Detects Ragna Locker Ransomware REF: https://otx.alienvault.com/indicator/file/c2bd70495630ed8279de0713a010e5e55f3da29323b59ef71401b12942ba52f6 AUTHOR: Florian Roth 
MATCHES: Str1: ---RAGNAR SECRET--- Str2: 
%s

%s
%s
%s

%s
.ragnar_ Str3: -forceWinSta0\Default
otepad.exe Str4: bootfont.bin Str5: Windows ... (truncated)
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: ragnarlocker_ransomware SUBSCORE: 60 
DESCRIPTION: Rule to detect RagnarLocker samples REF: https://www.bleepingcomputer.com/news/security/ragnar-locker-ransomware-targets-msp-enterprise-support-tools/ AUTHOR: McAfee ATR Team 
MATCHES: Str1: ---RAGNAR SECRET--- Str2: 668b858af7ffff663b45d2b8010000000f44 Str3: 558bec53578b7d088bd985ff0f84 Str4: ff15448140003dea0000000f85 St ... (truncated)
REASON_16: Yara Rule MATCH: Ran_Mem_RagnarLocker_Nov_2020_1 SUBSCORE: 75 
DESCRIPTION: Detect memory artefacts of the Ragnarlocker ransomware (Nov 2020) REF: Internal Research AUTHOR: Arkbird_SOLG 
MATCHES: Str1: \.\PHYSICALDRIVE%d Str2: bootfont.bin Str3: bootsect.bak Str4: bootmgr.efi Str5: ---RAGNAR SECRET--- Str6: Internet Explorer Str7:   ... (truncated)
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_20: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_21: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:51:56Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
65		win_token
10		win_files_operation
10		ft_exe
45		win_ragnarlocker_auto
70		MAL_RANSOM_Ragna_Locker_Apr20_1
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		ragnarlocker_ransomware
75		Ran_Mem_RagnarLocker_Nov_2020_1
20		isExecutable
10		Contains_PE_File
25		Crypt32_CryptBinaryToString_API
20		SHA512_Constants
20		SHA2_BLAKE2_IVs

Score total: 534

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Exploit.CVE_2017_0213-6306933-0', '25')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('win_ragnarlocker_auto', '45'), ('MAL_RANSOM_Ragna_Locker_Apr20_1', '70'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('ragnarlocker_ransomware', '60'), ('Ran_Mem_RagnarLocker_Nov_2020_1', '75'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Crypt32_CryptBinaryToString_API', '25'), ('SHA512_Constants', '20'), ('SHA2_BLAKE2_IVs', '20')]
-------------- LOKI_Score ------------
['534']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['25.0']
-------------- SCORE FINAL ------------
8778.061000690886
============================================


==================================================================
Fichier HTTP-FLgGpJ25AKslkBlyxk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fiv3S02aoDsPJ2pWib.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fiv3S02aoDsPJ2pWib.exe: Win.Malware.Phobos-6981135-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 44.861 sec (0 m 44 s)
Start Date: 2022:02:07 11:51:56
End Date:   2022:02:07 11:52:41

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Phobos-6981135-1

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xce in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 62: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 46: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 30: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:51:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fiv3S02aoDsPJ2pWib.exe SCORE: 559 TYPE: EXE SIZE: 72704 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f63d709bfa0> 
MD5: e59ffeaf7acb0c326e452fa30bb71a36 
SHA1: c88fad293256bfead6962124394de4f8b97765aa 
SHA256: a91491f45b851a07f91ba5a200967921bf796d38677786de51a4a8fe5ddeafd2 CREATED: Mon Feb  7 11:51:56 2022 MODIFIED: Mon Feb  7 11:51:56 2022 ACCESSED: Mon Feb  7 11:52:48 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: DuplicateTokenEx Str4: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8e8250000e989feffff Str2: e8d7fbffffe9b4feffff Str3: e8f1180000e919ffffff
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 0000000000000000000000000000400000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_22: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:52:49Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table

Score total: 559

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Phobos-6981135-1', '50')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25')]
-------------- LOKI_Score ------------
['559']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
9489.015651754708
============================================


==================================================================
Fichier HTTP-Fiv3S02aoDsPJ2pWib.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXfhwl2TEBe7XATrr7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b2ad4409323147b63e370745e5209996                                                   |
| sha1                   | 15e8fac9c9d5e541940a3c2782df6196ec1e9326                                           |
| sha256                 | 867991ade335186baa19a227e3a044c8321a6cef96c23c98eef21fe6b87edf6a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXfhwl2TEBe7XATrr7.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| write file on Windows                                | host-interaction/file-system/write                   |
| check mutex                                          | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| inject thread                                        | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
| identify ATM dispenser service provider              | targeting/automated-teller-machine                   |
| reference Diebold ATM routines                       | targeting/automated-teller-machine/diebold-nixdorf   |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
| reference NCR ATM library routines (2 matches)       | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Execution::Shared Modules [T1129;2]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4		- Discovery::Software Discovery [T1518;4]

Score total: 25.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXfhwl2TEBe7XATrr7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.864 sec (0 m 42 s)
Start Date: 2022:02:07 11:52:49
End Date:   2022:02:07 11:53:32

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:52:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXfhwl2TEBe7XATrr7.exe SCORE: 679 TYPE: EXE SIZE: 26112 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f729c9b1fa0> 
MD5: b2ad4409323147b63e370745e5209996 
SHA1: 15e8fac9c9d5e541940a3c2782df6196ec1e9326 
SHA256: 867991ade335186baa19a227e3a044c8321a6cef96c23c98eef21fe6b87edf6a CREATED: Mon Feb  7 11:52:49 2022 MODIFIED: Mon Feb  7 11:52:49 2022 ACCESSED: Mon Feb  7 11:53:41 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: win_dispenserxfs_auto SUBSCORE: 45 
DESCRIPTION: Detects win.dispenserxfs. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 6689854affffff33c066898574ffffff8d45cc6a06898578ffffff Str2: e9b20000006a0057893d508c4000b80000008033ff57 Str3: 0fb74106500fb74102500 ... (truncated)
REASON_5: Yara Rule MATCH: ATM_Malware_DispenserXFS SUBSCORE: 80 
DESCRIPTION: Detects ATM Malware DispenserXFS REF: https://twitter.com/r3c0nst/status/1100775857306652673 AUTHOR: @Xylit0l @r3c0nst / Modified by Florian Roth 
MATCHES: Str1: 68ffff00006860ea00006a10 Str2: \dispenserXFS.pdb Str3: C:\xfsasdf.txt Str4: Injected mxsfs killer into %d. Str5: Waiting for freeze m ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c6459047c6459165c6459274c645 Str2: c6459165c6459274c6459350c645 Str3: c6459274c6459350c6459472c645 Str4: c6459350c6459472c645956fc645 ... (truncated)
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_10: Yara Rule MATCH: Visual_Cpp_2005_Release_Microsoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e836040000e957fdffff
REASON_11: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e85ffeffffe926ffffff Str2: e836040000e957fdffff
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2: @B Str3:  Str4:  Str5: e836040000e957fdffff
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_16: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_22: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:53:42Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
60		win_mutex
10		ft_exe
45		win_dispenserxfs_auto
80		ATM_Malware_DispenserXFS
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_thread
70		Visual_Cpp_2005_Release_Microsoft
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
45		Inject_Thread
40		SEH_Save
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 679

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]', '6'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_mutex', '60'), ('ft_exe', '10'), ('win_dispenserxfs_auto', '45'), ('ATM_Malware_DispenserXFS', '80'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('dll_injection_thread', '15'), ('Visual_Cpp_2005_Release_Microsoft', '70'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Inject_Thread', '45'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['679']
-------------- CAPA_Score ------------
['25.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
11270.216667128025
============================================


==================================================================
Fichier HTTP-FXfhwl2TEBe7XATrr7.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FpQVgK3WCpZK7nn9Yi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c8403fb05244e23a7931c766409b5e22                                                   |
| sha1                   | c10a1d36b136c1df20c4135ea67bfb4c3934a4d8                                           |
| sha256                 | 42b610e7f4f0a0275ec3ede3895287e673c7cdad11fc352f86b1f2f7ed050fa0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FpQVgK3WCpZK7nn9Yi.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| initialize Winsock library                           | communication/socket                                 |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]

Score total: 14.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FpQVgK3WCpZK7nn9Yi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 33.502 sec (0 m 33 s)
Start Date: 2022:02:07 11:53:42
End Date:   2022:02:07 11:54:16

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:53:42Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FpQVgK3WCpZK7nn9Yi.exe SCORE: 169 TYPE: EXE SIZE: 38400 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4bb2c39fa0> 
MD5: c8403fb05244e23a7931c766409b5e22 
SHA1: c10a1d36b136c1df20c4135ea67bfb4c3934a4d8 
SHA256: 42b610e7f4f0a0275ec3ede3895287e673c7cdad11fc352f86b1f2f7ed050fa0 CREATED: Mon Feb  7 11:53:42 2022 MODIFIED: Mon Feb  7 11:53:42 2022 ACCESSED: Mon Feb  7 11:54:35 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:54:35Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasRichSignature
2		PE_File
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 169

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['169']
-------------- CAPA_Score ------------
['14.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2967.7825309297687
============================================


==================================================================
Fichier HTTP-FpQVgK3WCpZK7nn9Yi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIFgl63pKJ7uZUJzaj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 09cee5d093127aa9c9ff4b90f6a90581                                                   |
| sha1                   | b67e776551f3a451f0d5ffbcb6c3a9f096920386                                           |
| sha256                 | 4fa837762a3a76bcee46f7d34f8d2e3e4ea59a0d8f9094a8ca96144e137370f9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FIFgl63pKJ7uZUJzaj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIFgl63pKJ7uZUJzaj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 41.666 sec (0 m 41 s)
Start Date: 2022:02:07 11:54:35
End Date:   2022:02:07 11:55:17

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:54:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FIFgl63pKJ7uZUJzaj.exe SCORE: 229 TYPE: EXE SIZE: 24064 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fdc5cfc9fa0> 
MD5: 09cee5d093127aa9c9ff4b90f6a90581 
SHA1: b67e776551f3a451f0d5ffbcb6c3a9f096920386 
SHA256: 4fa837762a3a76bcee46f7d34f8d2e3e4ea59a0d8f9094a8ca96144e137370f9 CREATED: Mon Feb  7 11:54:35 2022 MODIFIED: Mon Feb  7 11:54:35 2022 ACCESSED: Mon Feb  7 11:55:23 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:55:24Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3828.9316422328375
============================================


==================================================================
Fichier HTTP-FIFgl63pKJ7uZUJzaj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F14Nn91mqPMEF2Q0R5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7faafc7e4a5c736ebfee6abbbc812d80                                                   |
| sha1                   | 625628d4c91d4193474735da011903642b2c916e                                           |
| sha256                 | 309217d8088871e09a7a03ee68ee46f60583a73945006f95021ec85fc1ec959e                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F14Nn91mqPMEF2Q0R5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]        |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DEFENSE EVASION             | Self Deletion::COMSPEC Environment Variable [F0007.001]                       |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag (24 matches)        | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB NtGlobalFlag flag (24 matches)         | anti-analysis/anti-debugging/debugger-detection      |
| self delete                                          | anti-analysis/anti-forensic/self-deletion            |
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| read and send data from client to server             | c2/file-transfer                                     |
| receive and write data from server to client         | c2/file-transfer                                     |
| creates tcp or udp socket                            | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| act as TCP client                                    | communication/tcp/client                             |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| modify service                                       | host-interaction/service/modify                      |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::Query Registry [T1012;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]

Score total: 60.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F14Nn91mqPMEF2Q0R5.exe: Win.Dropper.Ulise-9937584-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-F14Nn91mqPMEF2Q0R5.exe: Win.Trojan.Downloader-15920 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 44.509 sec (0 m 44 s)
Start Date: 2022:02:07 11:55:24
End Date:   2022:02:07 11:56:08

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.Ulise-9937584-0
45		Win.Trojan.Downloader-15920

Score total: 75.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5')]
---------------- ClamAV_Rules --------------
[('Win.Dropper.Ulise-9937584-0', '30'), ('Win.Trojan.Downloader-15920', '45')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('VC6_Random', '15')]
-------------- LOKI_Score ------------
['669']
-------------- CAPA_Score ------------
['60.0']
-------------- CLAMAV_Score ------------
['75.0']
-------------- SCORE FINAL ------------
12744.286905391802
============================================


==================================================================
Fichier HTTP-F14Nn91mqPMEF2Q0R5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FLHIfk3gHqhAdNAXi9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ba4cfe6461afa1004c52f19c8f2169dc                                                   |
| sha1                   | ab8539ef6b2a93ff9589dec4b34a0257b6296c92                                           |
| sha256                 | e86870769ee6c797e09457bd99c58d9bf2303cf0193a24ef9b1222c2c3daf628                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FLHIfk3gHqhAdNAXi9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FLHIfk3gHqhAdNAXi9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 44.080 sec (0 m 44 s)
Start Date: 2022:02:07 11:56:09
End Date:   2022:02:07 11:56:53

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:56:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FLHIfk3gHqhAdNAXi9.exe SCORE: 364 TYPE: EXE SIZE: 103288 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fafef09cfa0> 
MD5: ba4cfe6461afa1004c52f19c8f2169dc 
SHA1: ab8539ef6b2a93ff9589dec4b34a0257b6296c92 
SHA256: e86870769ee6c797e09457bd99c58d9bf2303cf0193a24ef9b1222c2c3daf628 CREATED: Mon Feb  7 11:56:09 2022 MODIFIED: Mon Feb  7 11:56:09 2022 ACCESSED: Mon Feb  7 11:57:01 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8f30400004883c428e96efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:57:01Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 364

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['364']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5828.869090007519
============================================


==================================================================
Fichier HTTP-FLHIfk3gHqhAdNAXi9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FxeLmu1iPph9UM1oqg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FxeLmu1iPph9UM1oqg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.33 MB
Data read: 0.31 MB (ratio 1.05:1)
Time: 46.050 sec (0 m 46 s)
Start Date: 2022:02:07 11:57:01
End Date:   2022:02:07 11:57:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa8 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa8 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:57:02Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FxeLmu1iPph9UM1oqg.exe SCORE: 594 TYPE: EXE SIZE: 328192 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4f9f95cfa0> 
MD5: 6be0ae5cb7c3155f70d608fc7670d2d9 
SHA1: a3d3d6c2adc7cb7d747c279810036bc104e80376 
SHA256: 223afed3106fb9cdde89eac273894e2fbe392f66b87ab8b9408cd6ef1bce8fa4 CREATED: Mon Feb  7 11:57:01 2022 MODIFIED: Mon Feb  7 11:57:01 2022 ACCESSED: Mon Feb  7 11:57:53 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: MoveF ... (truncated)
REASON_2: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_3: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: Gamaredon_GetImportByHash SUBSCORE: 70 
DESCRIPTION: Detects Gamaredon APIHashing REF: - AUTHOR: Frank Boldewin (@r3c0nst) 
MATCHES: Str1: 8b503c03d08b527803d08b4a1c03c8 Str2: 8b7508ba051500008bc2c1e20503d033db8a1e03d34633db8a1e85db75
REASON_6: Yara Rule MATCH: MAL_SUSP_Gamaredon_GetImportByHash SUBSCORE: 70 
DESCRIPTION: Detects Gamaredon APIHashing REF: https://twitter.com/r3c0nst/status/1392405576131436546?s=20 AUTHOR: Frank Boldewin (@r3c0nst) 
MATCHES: Str1: 8b503c03d08b527803d08b4a1c03c8 Str2: 8b7508ba051500008bc2c1e20503d033db8a1e03d34633db8a1e85db75
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e871fdffffe96affffff Str2: e845e8ffffe99afbffff Str3: e866890c02e931ffffff Str4: e80e050000e974feffff Str5: e80efaffffe93dfaffff
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 00000000000000000000000000000000000064e0440000000000000000003ca143000000000000000000000000000001000000000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_18: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:57:54Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
70		Gamaredon_GetImportByHash
70		MAL_SUSP_Gamaredon_GetImportByHash
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 594

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6be0ae5cb7c3155f70d608fc7670d2d9                                                   |
| sha1                   | a3d3d6c2adc7cb7d747c279810036bc104e80376                                           |
| sha256                 | 223afed3106fb9cdde89eac273894e2fbe392f66b87ab8b9408cd6ef1bce8fa4                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FxeLmu1iPph9UM1oqg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Non-Cryptographic Hash:: [C0030]                                              |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check HTTP status code                               | communication/http/client                            |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| hash data using djb2                                 | data-manipulation/hashing/djb2                       |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get number of processors                             | host-interaction/hardware/cpu                        |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 12.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('Gamaredon_GetImportByHash', '70'), ('MAL_SUSP_Gamaredon_GetImportByHash', '70'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['594']
-------------- CAPA_Score ------------
['12.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
9663.673352590122
============================================


==================================================================
Fichier HTTP-FxeLmu1iPph9UM1oqg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FblMIX2fZtdJsVTaRh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3d760b6fc84571c928bed835863fc302                                                   |
| sha1                   | adcf9ade7a4dc14b7bf656e86ea15766b843e3b6                                           |
| sha256                 | 8ac21275d0db7f3e990551f343e16ac105d6a513810ff71934de4855999cc9c5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FblMIX2fZtdJsVTaRh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+------------------------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                                   |
|-----------------------------+------------------------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                                            |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                                     |
|                             | Virtual Machine Detection::Unique Hardware/Firmware Check - I/O Communication Port [B0009.025] |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                                     |
|                             | C2 Communication::Send Data [B0030.001]                                                        |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                                         |
|                             | HTTP Communication::Connect to Server [C0002.009]                                              |
|                             | HTTP Communication::Create Request [C0002.012]                                                 |
|                             | HTTP Communication::Get Response [C0002.017]                                                   |
|                             | HTTP Communication::Read Header [C0002.014]                                                    |
|                             | HTTP Communication::Send Data [C0002.005]                                                      |
|                             | HTTP Communication::Send Request [C0002.003]                                                   |
| FILE SYSTEM                 | Read File:: [C0051]                                                                            |
|                             | Writes File:: [C0052]                                                                          |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                                      |
|                             | Registry::Open Registry Key [C0036.003]                                                        |
|                             | Registry::Query Registry Value [C0036.006]                                                     |
|                             | Registry::Set Registry Key [C0036.001]                                                         |
+-----------------------------+------------------------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions                         | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| reference the VMWare IO port                         | anti-analysis/anti-vm/vm-detection                   |
| receive and write data from server to client         | c2/file-transfer                                     |
| get geographical location                            | collection                                           |
| send data (3 matches)                                | communication                                        |
| parse URL (2 matches)                                | communication/http                                   |
| check HTTP status code                               | communication/http/client                            |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| get CPU information                                  | host-interaction/hardware/cpu                        |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| set registry value                                   | host-interaction/registry/create                     |
| compare security identifiers                         | host-interaction/sid                                 |
| access PEB ldr_data (3 matches)                      | linking/runtime-linking                              |
| parse PE exports (2 matches)                         | load-code/pe                                         |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 32.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FblMIX2fZtdJsVTaRh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 42.589 sec (0 m 42 s)
Start Date: 2022:02:07 11:58:19
End Date:   2022:02:07 11:59:01

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:58:19Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FblMIX2fZtdJsVTaRh.exe SCORE: 2284 TYPE: EXE SIZE: 57856 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7efd601d4fa0> 
MD5: 3d760b6fc84571c928bed835863fc302 
SHA1: adcf9ade7a4dc14b7bf656e86ea15766b843e3b6 
SHA256: 8ac21275d0db7f3e990551f343e16ac105d6a513810ff71934de4855999cc9c5 CREATED: Mon Feb  7 11:58:19 2022 MODIFIED: Mon Feb  7 11:58:19 2022 ACCESSED: Mon Feb  7 11:59:11 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: InternetWriteFile Str6: HttpOpenRequest Str7: HttpS ... (truncated)
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: CreateFileA Str6: FindFirstFileA
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_8: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff6820c5400068c0a6400064a100000000506489250000000083ec0c535657 Str3: 558bec6aff68e0c6400068c0a6400064a100000000506489 ... (truncated)
REASON_13: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6820c5400068c0a6400064a10000000050 Str2: 558bec6aff68e0c6400068c0a6400064a10000000050
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6820c5400068c0a6400064a10000000050 Str2: 558bec6aff68e0c6400068c0a6400064a10000000050
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec6aff6820c5400068c0a6400064a10000000050 Str3: 558bec6aff68e0c6400068c0a6400064a10000000050
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6820c5400068c0a6400064a1000000005064892500000000 Str2: 558bec6aff68e0c6400068c0a6400064a1000000005064892500000000
REASON_17: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_20: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_34: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_35: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_36: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_37: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_38: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_39: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_40: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System
REASON_41: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: vmware Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_42: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_43: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_44: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_45: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_46: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_47: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_48: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_49: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T10:59:12Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Qemu_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		antivm_vmware
60		vmdetect_2
40		SEH_Init
60		vmdetect
20		isExecutable
10		Contains_PE_File
20		MD5_Constants

Score total: 2284

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Qemu_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('antivm_vmware', '60'), ('vmdetect_2', '60'), ('SEH_Init', '40'), ('vmdetect', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('MD5_Constants', '20')]
-------------- LOKI_Score ------------
['2284']
-------------- CAPA_Score ------------
['32.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
36847.420768176715
============================================


==================================================================
Fichier HTTP-FblMIX2fZtdJsVTaRh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FJBsmW2pNKMPYGGbFl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a6933d1262da26403faf968672a1baf0                                                   |
| sha1                   | 3047bada98818c4b4699eb6bd5ffb19d9e9868a8                                           |
| sha256                 | ce8d7590182db2e51372a4a04d6a0927a65b2640739f9ec01cfd6c143b1110da                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FJBsmW2pNKMPYGGbFl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Portable Executable Injection \[T1055.002]\                     |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set environment variable                             | host-interaction/environment-variable                |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| inject pe                                            | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| access PE header                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
4		- Defense Evasion::Process Injection::Portable Executable Injection [T1055.002;4]
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]

Score total: 19.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FJBsmW2pNKMPYGGbFl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 41.707 sec (0 m 41 s)
Start Date: 2022:02:07 11:59:12
End Date:   2022:02:07 11:59:54

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe2 in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T10:59:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FJBsmW2pNKMPYGGbFl.exe SCORE: 539 TYPE: EXE SIZE: 104448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb7f4ed8fa0> 
MD5: a6933d1262da26403faf968672a1baf0 
SHA1: 3047bada98818c4b4699eb6bd5ffb19d9e9868a8 
SHA256: ce8d7590182db2e51372a4a04d6a0927a65b2640739f9ec01cfd6c143b1110da CREATED: Mon Feb  7 11:59:12 2022 MODIFIED: Mon Feb  7 11:59:12 2022 ACCESSED: Mon Feb  7 12:00:04 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445336f6360ba646a14aaeb3260c022cd49002000000433a5c55736572735c656e6467616d655c4465736b746f705c504557696e646f775c52656c656173655c5 ... (truncated)
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445336f6360ba646a14aaeb3260c022cd49002000000433a5c55736572735c656e6467616d655c4465736b746f705c504557696e646f775c52656c656173655c5 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e894030000e97afeffff Str2: e80f060000e977ffffff Str3: e821f1ffffe96cffffff
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_17: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_19: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:00:04Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
10		win_files_operation
10		ft_exe
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
2		math_entropy_6
5		executable_pe
15		dll_injection_thread
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
45		Inject_Thread
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 539

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]', '6'), ('- Defense Evasion::Process Injection::Portable Executable Injection [T1055.002;4]', '4'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_files_operation', '10'), ('ft_exe', '10'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('dll_injection_thread', '15'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Inject_Thread', '45'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['539']
-------------- CAPA_Score ------------
['19.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8921.67414720949
============================================


==================================================================
Fichier HTTP-FJBsmW2pNKMPYGGbFl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F8gNKv37lTTo7aVSU5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:00:05Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:00:42Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F8gNKv37lTTo7aVSU5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 42.989 sec (0 m 42 s)
Start Date: 2022:02:07 12:00:05
End Date:   2022:02:07 12:00:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
0.0
============================================


==================================================================
Fichier HTTP-F8gNKv37lTTo7aVSU5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1XfOc4xABIB3sxFsg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1XfOc4xABIB3sxFsg.exe: Win.Malware.Agent-6350563-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-F1XfOc4xABIB3sxFsg.exe: Win.Trojan.Agent-709658 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 0.00:1)
Time: 41.667 sec (0 m 41 s)
Start Date: 2022:02:07 12:00:48
End Date:   2022:02:07 12:01:30

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Agent-6350563-0
70		Win.Trojan.Agent-709658
75		Win.Trojan.Agent-709658
45		Win.Trojan.Agent-709658

Score total: 240.0
sh: 183: Syntax error: EOF in backquote substitution

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Agent-6350563-0', '50'), ('Win.Trojan.Agent-709658', '70'), ('Win.Trojan.Agent-709658', '75'), ('Win.Trojan.Agent-709658', '45')]
-------------- LOKI_Rules ------------
[('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '10'), ('misc_upx_packed_binary', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('upx_sections', '2'), ('PackerUPX_CompresorGratuito_wwwupxsourceforgenet', '70'), ('UPX_wwwupxsourceforgenet_additional', '70'), ('yodas_Protector_v1033_dllocx_Ashkbiz_Danehkar_h', '70'), ('UPX_v0896_v102_v105_v124_Markus_Laszlo_overlay', '70'), ('UPX_v0896_v102_v105_v124_Markus_Laszlo_overlay_additional', '70'), ('UPX_wwwupxsourceforgenet', '70'), ('UPXv20MarkusLaszloReiser', '30'), ('UPXV200V290MarkusOberhumerLaszloMolnarJohnReiser', '70'), ('UPX20030XMarkusOberhumerLaszloMolnarJohnReiser', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('upx', '15'), ('suspicious_packer_section', '60'), ('UPX', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['836']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['240.0']
-------------- SCORE FINAL ------------
16271.128077280908
============================================


==================================================================
Fichier HTTP-F1XfOc4xABIB3sxFsg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FJe5iLVzAo8OuKgf3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FJe5iLVzAo8OuKgf3.exe: Win.Dropper.Necurs-7617964-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FJe5iLVzAo8OuKgf3.exe: Win.Malware.Necurs-7618009-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.18 MB
Data read: 0.18 MB (ratio 1.02:1)
Time: 44.040 sec (0 m 44 s)
Start Date: 2022:02:07 12:01:41
End Date:   2022:02:07 12:02:25

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.Necurs-7617964-0
50		Win.Malware.Necurs-7618009-0

Score total: 80.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 8: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xda in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:01:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FJe5iLVzAo8OuKgf3.exe SCORE: 1284 TYPE: EXE SIZE: 188418 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff361985fa0> 
MD5: 0596c4ea5aa8def47f22c85d75aaca95 
SHA1: f63ad8e1c86666a0d3a51f039e44f7cb17232933 
SHA256: 377fdff7fd24bf9257447480a8061e0380902f795ac5f8aac3738663b6503a3d CREATED: Mon Feb  7 12:01:41 2022 MODIFIED: Mon Feb  7 12:01:41 2022 ACCESSED: Mon Feb  7 12:02:33 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: DNSAPI.dll Str3: getaddrinfo Str4: DnsQuery
REASON_4: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_5: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_6: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: AdjustTokenPrivileges Str4: OpenProcessToken
REASON_7: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: ReadFile Str5: CopyFile
REASON_8: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_9: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_10: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_11: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_12: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: win_necurs_auto SUBSCORE: 45 
DESCRIPTION: Detects win.necurs. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 13f2a314000801893510000801890d0c000801 Str2: 397508760433c0eb12 Str3: 33d246f7f68bc20345085e5d Str4: 0f318bc8a118000801568bf2 Str5: 0 ... (truncated)
REASON_14: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_16: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_17: Yara Rule MATCH: Microsoft_Visual_Basic_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: h
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_21: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_22: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_25: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_26: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_27: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: ?
REASON_28: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_29: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_30: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ?
REASON_31: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_32: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_33: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_34: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_35: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ?
REASON_36: Yara Rule MATCH: TrojanWin32NecursSample SUBSCORE: 50 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: some stupid error %u Str2: loading Str3: unloading Str4: exception %08x %swhen %s at %p Str5: microsoft.com Str6: facebook.com Str7:  ... (truncated)
REASON_37: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_38: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_39: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
REASON_40: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:02:34Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		network_http
50		network_dns
70		escalate_priv
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
45		win_necurs_auto
2		math_entropy_5
5		executable_pe
15		dll_injection_thread
70		Microsoft_Visual_Basic_v50
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasRichSignature
35		Embedded_PE
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
35		Anti_Automated_Sandbox
60		antivm_vmware
60		vmdetect_2
45		Inject_Thread
60		Debugger_Check__QueryInfo
60		ThreadControl__Context_v1
40		SEH_Init
60		vmdetect
50		TrojanWin32NecursSample
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API
25		CRC32_poly_Constant

Score total: 1284

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Dropper.Necurs-7617964-0', '30'), ('Win.Malware.Necurs-7618009-0', '50')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('network_http', '45'), ('network_dns', '50'), ('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('win_necurs_auto', '45'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('dll_injection_thread', '15'), ('Microsoft_Visual_Basic_v50', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasRichSignature', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '35'), ('antivm_vmware', '60'), ('vmdetect_2', '60'), ('Inject_Thread', '45'), ('Debugger_Check__QueryInfo', '60'), ('ThreadControl__Context_v1', '60'), ('SEH_Init', '40'), ('vmdetect', '60'), ('TrojanWin32NecursSample', '50'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Advapi_Hash_API', '20'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['1284']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['80.0']
-------------- SCORE FINAL ------------
21357.168920636028
============================================


==================================================================
Fichier HTTP-FJe5iLVzAo8OuKgf3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FL0ryg2ODjjylKF9Y5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9dc209f66da77858e362e624d0be86b3                                                   |
| sha1                   | 60a542f76b1228b1725c51bd6e19d9763ce5cd03                                           |
| sha256                 | db36fbc490ffb8662d13388cf4a1d5daba1527ac0440fc2eff99ddedc51f4a82                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FL0ryg2ODjjylKF9Y5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::3DES [C0027.004]                                                |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt data using DES                               | data-manipulation/encryption/des                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| allocate thread local storage                        | host-interaction/process                             |
| terminate process                                    | host-interaction/process/terminate                   |
| set registry value (3 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| modify service (2 matches)                           | host-interaction/service/modify                      |
| start service                                        | host-interaction/service/start                       |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]

Score total: 27.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FL0ryg2ODjjylKF9Y5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.57 MB
Data read: 0.54 MB (ratio 1.06:1)
Time: 44.957 sec (0 m 44 s)
Start Date: 2022:02:07 12:02:35
End Date:   2022:02:07 12:03:20

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 61: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 45: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 29: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:02:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FL0ryg2ODjjylKF9Y5.exe SCORE: 379 TYPE: EXE SIZE: 572244 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fbb9d386fa0> 
MD5: 9dc209f66da77858e362e624d0be86b3 
SHA1: 60a542f76b1228b1725c51bd6e19d9763ce5cd03 
SHA256: db36fbc490ffb8662d13388cf4a1d5daba1527ac0440fc2eff99ddedc51f4a82 CREATED: Mon Feb  7 12:02:35 2022 MODIFIED: Mon Feb  7 12:02:35 2022 ACCESSED: Mon Feb  7 12:03:28 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8d54b0000e995feffff Str2: e8d7fbffffe9b4feffff Str3: e8810a0000e919ffffff Str4: e85fc9ffffe9fffeffff
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3:  Str4:  Str5:  Str6:  Str7:  Str8:  Str9:  Str10:  Str11:  Str12:  Str13:  Str14:  Str15:  Str16:  Str17: 00000000000 ... (truncated)
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_15: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: DES_sbox SUBSCORE: 15 
DESCRIPTION: DES [sbox] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 
REASON_20: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:03:29Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
15		DES_sbox
5		BASE64_table

Score total: 379

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('DES_sbox', '15'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['379']
-------------- CAPA_Score ------------
['27.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6545.466024469218
============================================


==================================================================
Fichier HTTP-FL0ryg2ODjjylKF9Y5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FYZgJw3iGXShwBHDoj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1f009de6a013a282d07436241512c056                                                   |
| sha1                   | f0d37e1e76a199135e00c0a36b154b191a0950a9                                           |
| sha256                 | c897c345c3bcf3e96589a0feeea8b6d26cf33c091ac3ee2162dd27f8a79c3ff5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FYZgJw3iGXShwBHDoj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:03:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FYZgJw3iGXShwBHDoj.exe SCORE: 169 TYPE: EXE SIZE: 73728 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3cfc4e0fa0> 
MD5: 1f009de6a013a282d07436241512c056 
SHA1: f0d37e1e76a199135e00c0a36b154b191a0950a9 
SHA256: c897c345c3bcf3e96589a0feeea8b6d26cf33c091ac3ee2162dd27f8a79c3ff5 CREATED: Mon Feb  7 12:03:30 2022 MODIFIED: Mon Feb  7 12:03:30 2022 ACCESSED: Mon Feb  7 12:04:08 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 5577fe6a71dbb9240a528a19d7a185c9
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:04:08Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 169

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FYZgJw3iGXShwBHDoj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 43.702 sec (0 m 43 s)
Start Date: 2022:02:07 12:03:30
End Date:   2022:02:07 12:04:14

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['169']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2738.327364708348
============================================


==================================================================
Fichier HTTP-FYZgJw3iGXShwBHDoj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDQicK33HVH2m4Fz19.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a7a7ef007355f853e8fc56a483c25a10                                                   |
| sha1                   | d7fcd0e6eadabd235fb969b6ee163c83fd07c991                                           |
| sha256                 | 1daad9a09bc5bc51f41a34cb604106eebe1559d35e8464785601e3e6d98c3f17                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FDQicK33HVH2m4Fz19.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (7 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDQicK33HVH2m4Fz19.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.13 MB
Data read: 0.12 MB (ratio 1.03:1)
Time: 42.472 sec (0 m 42 s)
Start Date: 2022:02:07 12:04:14
End Date:   2022:02:07 12:04:56

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:04:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FDQicK33HVH2m4Fz19.exe SCORE: 364 TYPE: EXE SIZE: 131152 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa56acedfa0> 
MD5: a7a7ef007355f853e8fc56a483c25a10 
SHA1: d7fcd0e6eadabd235fb969b6ee163c83fd07c991 
SHA256: 1daad9a09bc5bc51f41a34cb604106eebe1559d35e8464785601e3e6d98c3f17 CREATED: Mon Feb  7 12:04:14 2022 MODIFIED: Mon Feb  7 12:04:14 2022 ACCESSED: Mon Feb  7 12:05:05 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:05:06Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 364

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['364']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5828.869090007519
============================================


==================================================================
Fichier HTTP-FDQicK33HVH2m4Fz19.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDfY0j1CamSTWuAHp.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 51cd52d8eaaeba1dbfedf2d2c4e3f796                                                   |
| sha1                   | 39eb573d623463e4e359f94b5bb605a7d89cabfe                                           |
| sha256                 | 5e3cacdc9963ee8189ee6619b205c235ec44c38faa430f176da7ed5cfb8a3343                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FDfY0j1CamSTWuAHp.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions (28 matches)            | anti-analysis/anti-vm/vm-detection                   |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 10.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDfY0j1CamSTWuAHp.exe: Win.Trojan.MSShellcode-6360728-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FDfY0j1CamSTWuAHp.exe: Win.Trojan.MSShellcode-6360730-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FDfY0j1CamSTWuAHp.exe: Win.Trojan.Swrort-5710536-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FDfY0j1CamSTWuAHp.exe: Win.Trojan.MSShellcode-6360729-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FDfY0j1CamSTWuAHp.exe: BC.Win.Trojan.Swrort-17210 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 46.123 sec (0 m 46 s)
Start Date: 2022:02:07 12:05:06
End Date:   2022:02:07 12:05:52

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.MSShellcode-6360728-0
45		Win.Trojan.MSShellcode-6360730-0
45		Win.Trojan.Swrort-5710536-0
45		Win.Trojan.MSShellcode-6360729-0
45		BC.Win.Trojan.Swrort-17210

Score total: 225.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:05:06Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FDfY0j1CamSTWuAHp.exe SCORE: 334 TYPE: EXE SIZE: 73802 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f620bdfcfa0> 
MD5: 51cd52d8eaaeba1dbfedf2d2c4e3f796 
SHA1: 39eb573d623463e4e359f94b5bb605a7d89cabfe 
SHA256: 5e3cacdc9963ee8189ee6619b205c235ec44c38faa430f176da7ed5cfb8a3343 CREATED: Mon Feb  7 12:05:06 2022 MODIFIED: Mon Feb  7 12:05:06 2022 ACCESSED: Mon Feb  7 12:05:58 2022 
REASON_1: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSOCK32.dll Str3: socket Str4: send Str5: WSASend Str6: connect Str7: WSAStartup
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA
REASON_4: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll Str2: WSOCK32.dll
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: Hunting_Rule_ShikataGaNai SUBSCORE: 70 
DESCRIPTION: not set REF: https://www.fireeye.com/blog/threat-research/2019/10/shikata-ga-nai-encoder-still-going-strong.html AUTHOR: Steven Miller 
MATCHES: Str1: baba96367cdac9d97424f45e29c9b184315613 Str2: ba96367cdac9d97424f45e29c9b184315613
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: metasploit_payload_msfpayload SUBSCORE: 25 
DESCRIPTION: This rule detects generic metasploit callback payloads generated with msfpayload REF: - AUTHOR: - 
MATCHES: Str1: asf Str2: release Str3: build Str4: support Str5: ab.pdb Str6: WS2_32.dll Str7: mswsock Str8: ntdll.dll Str9: KERNEL32.dll Str10: she ... (truncated)
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:05:58Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_tcp_socket
60		win_mutex
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
70		Hunting_Rule_ShikataGaNai
2		math_entropy_6
5		executable_pe
5		winsocks
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
25		metasploit_payload_msfpayload
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 334

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.MSShellcode-6360728-0', '45'), ('Win.Trojan.MSShellcode-6360730-0', '45'), ('Win.Trojan.Swrort-5710536-0', '45'), ('Win.Trojan.MSShellcode-6360729-0', '45'), ('BC.Win.Trojan.Swrort-17210', '45')]
-------------- LOKI_Rules ------------
[('network_tcp_socket', '50'), ('win_mutex', '60'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('Hunting_Rule_ShikataGaNai', '70'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('winsocks', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('metasploit_payload_msfpayload', '25'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['334']
-------------- CAPA_Score ------------
['10.5']
-------------- CLAMAV_Score ------------
['225.0']
-------------- SCORE FINAL ------------
8335.627982428729
============================================


==================================================================
Fichier HTTP-FDfY0j1CamSTWuAHp.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FReH5h4xhIw9BCjCc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FReH5h4xhIw9BCjCc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.45 MB
Data read: 0.42 MB (ratio 1.06:1)
Time: 43.992 sec (0 m 43 s)
Start Date: 2022:02:07 12:05:58
End Date:   2022:02:07 12:06:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:05:59Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FReH5h4xhIw9BCjCc.exe SCORE: 194 TYPE: EXE SIZE: 443392 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8b82107fa0> 
MD5: 761d7dcd4b60059b522fad83400d8418 
SHA1: 6954ba79dabf8aa903dd376cfc5f7d409dbe47d1 
SHA256: b0b994aeb9187bbf9d819bdef803bb3de63b73720de890d151ffa8ec346ee2bd CREATED: Mon Feb  7 12:05:58 2022 MODIFIED: Mon Feb  7 12:05:58 2022 ACCESSED: Mon Feb  7 12:06:50 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:06:51Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 194

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 761d7dcd4b60059b522fad83400d8418                                                   |
| sha1                   | 6954ba79dabf8aa903dd376cfc5f7d409dbe47d1                                           |
| sha256                 | b0b994aeb9187bbf9d819bdef803bb3de63b73720de890d151ffa8ec346ee2bd                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FReH5h4xhIw9BCjCc.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (8 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1.5		- Discovery::System Location Discovery [T1614;1.5]
2		- Execution::Shared Modules [T1129;2]

Score total: 7.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['194']
-------------- CAPA_Score ------------
['7.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3224.3374669972254
============================================


==================================================================
Fichier HTTP-FReH5h4xhIw9BCjCc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FJVvSh488E0rn02jOk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FJVvSh488E0rn02jOk.exe: Win.Exploit.CVE_2019_1219-7151042-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.45 MB
Data read: 0.43 MB (ratio 1.06:1)
Time: 43.581 sec (0 m 43 s)
Start Date: 2022:02:07 12:08:15
End Date:   2022:02:07 12:08:58

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2019_1219-7151042-2

Score total: 25.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | db648cd247281954344f1d810c6fd590                                                   |
| sha1                   | a457931874ba395917da2ab060c02159f2c418ec                                           |
| sha256                 | faf351db4072395ca1e2855a379b120cdbccdb09131c48463e30dccf4245f4bb                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FJVvSh488E0rn02jOk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Data from Information Repositories:: \[T1213]\                                     |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Asynchronous Procedure Call \[T1055.004]\                       |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
|                        | Virtualization/Sandbox Evasion::User Activity Based Checks \[T1497.002]\           |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection:: [B0001]                                                  |
|                             | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
|                             | Debugger Detection::CheckRemoteDebuggerPresent [B0001.002]                    |
|                             | Debugger Detection::Hardware Breakpoints [B0001.005]                          |
|                             | Debugger Detection::Memory Write Watching [B0001.010]                         |
|                             | Debugger Detection::OutputDebugString [B0001.016]                             |
|                             | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]        |
|                             | Debugger Detection::SetHandleInformation [B0001.024]                          |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Debugger Detection::WudfIsAnyDebuggerPresent [B0001.031]                      |
|                             | Emulator Detection:: [B0004]                                                  |
|                             | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Human User Check [B0009.012]                       |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
| COMMUNICATION               | ICMP Communication::Echo Request [C0014.002]                                  |
| DISCOVERY                   | Analysis Tool Discovery::Process Detection [B0013.001]                        |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| reference analysis tools strings                         | anti-analysis                                        |
| check for OutputDebugString error                        | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB BeingDebugged flag                         | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB NtGlobalFlag flag                          | anti-analysis/anti-debugging/debugger-detection      |
| check for debugger via API                               | anti-analysis/anti-debugging/debugger-detection      |
| check for hardware breakpoints                           | anti-analysis/anti-debugging/debugger-detection      |
| check for kernel debugger via shared user data structure | anti-analysis/anti-debugging/debugger-detection      |
| check for protected handle exception                     | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints (2 matches)               | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount                    | anti-analysis/anti-debugging/debugger-detection      |
| check for trap flag exception                            | anti-analysis/anti-debugging/debugger-detection      |
| check for unexpected memory writes (5 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| check process job object                                 | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-debugging instructions (2 matches)          | anti-analysis/anti-debugging/debugger-detection      |
| check if process is running under wine (2 matches)       | anti-analysis/anti-emulation/wine                    |
| check for unmoving mouse cursor                          | anti-analysis/anti-vm/vm-detection                   |
| execute anti-VM instructions (7 matches)                 | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings                                | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Parallels            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Qemu                 | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare               | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualBox           | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualPC            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Xen                  | anti-analysis/anti-vm/vm-detection                   |
| reference WMI statements (31 matches)                    | collection/database/wmi                              |
| log keystrokes via application hook                      | collection/keylog                                    |
| send ICMP echo request                                   | communication/icmp                                   |
| contains PDB path                                        | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                       | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section            | executable/pe/section/tls                            |
| interact with driver via control codes                   | host-interaction/driver                              |
| query environment variable (4 matches)                   | host-interaction/environment-variable                |
| get Program Files directory (2 matches)                  | host-interaction/file-system                         |
| get common file path (5 matches)                         | host-interaction/file-system                         |
| read raw disk data                                       | host-interaction/file-system                         |
| check if file exists (2 matches)                         | host-interaction/file-system/exists                  |
| get file attributes (2 matches)                          | host-interaction/file-system/meta                    |
| get file size                                            | host-interaction/file-system/meta                    |
| read file on Windows                                     | host-interaction/file-system/read                    |
| set console window title                                 | host-interaction/gui/console                         |
| find graphical window                                    | host-interaction/gui/window/find                     |
| get number of processor cores                            | host-interaction/hardware/cpu                        |
| get number of processors                                 | host-interaction/hardware/cpu                        |
| get memory capacity                                      | host-interaction/hardware/memory                     |
| enumerate disk properties                                | host-interaction/hardware/storage                    |
| get disk information (2 matches)                         | host-interaction/hardware/storage                    |
| get disk size (2 matches)                                | host-interaction/hardware/storage                    |
| print debug messages (6 matches)                         | host-interaction/log/debug/write-event               |
| create mutex                                             | host-interaction/mutex                               |
| get system information on Windows (5 matches)            | host-interaction/os/info                             |
| check OS version                                         | host-interaction/os/version                          |
| get process heap flags (2 matches)                       | host-interaction/process                             |
| get process heap force flags (2 matches)                 | host-interaction/process                             |
| read process memory (3 matches)                          | host-interaction/process                             |
| create process on Windows                                | host-interaction/process/create                      |
| allocate RWX memory (3 matches)                          | host-interaction/process/inject                      |
| inject APC                                               | host-interaction/process/inject                      |
| inject dll                                               | host-interaction/process/inject                      |
| inject thread                                            | host-interaction/process/inject                      |
| use process replacement                                  | host-interaction/process/inject                      |
| enumerate processes                                      | host-interaction/process/list                        |
| get Explorer PID                                         | host-interaction/process/list                        |
| acquire debug privileges                                 | host-interaction/process/modify                      |
| modify access privileges (2 matches)                     | host-interaction/process/modify                      |
| enumerate process modules (5 matches)                    | host-interaction/process/modules/list                |
| terminate process                                        | host-interaction/process/terminate                   |
| terminate process via fastfail (3 matches)               | host-interaction/process/terminate                   |
| query or enumerate registry value                        | host-interaction/registry                            |
| enumerate services                                       | host-interaction/service/list                        |
| enumerate threads (2 matches)                            | host-interaction/thread/list                         |
| get ntdll base address                                   | linking/runtime-linking                              |
| link function at runtime on Windows (8 matches)          | linking/runtime-linking                              |
| enumerate PE sections                                    | load-code/pe                                         |
| parse PE header (3 matches)                              | load-code/pe                                         |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Discovery::File and Directory Discovery [T1083;2]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
3		- Execution::System Services::Service Execution [T1569.002;3]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
5		- Collection::Data from Information Repositories [T1213;5]
2		- Execution::Shared Modules [T1129;2]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
7.5		- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 88.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]', '5'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]', '6'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]', '5'), ('- Collection::Data from Information Repositories [T1213;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]', '7.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('Win.Exploit.CVE_2019_1219-7151042-2', '25')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('escalate_priv', '70'), ('screenshot', '65'), ('keylogger', '80'), ('migrate_apc', '45'), ('win_mutex', '60'), ('win_registry', '20'), ('win_token', '65'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '10'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_5', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('self_inject', '15'), ('dll_injection_thread', '15'), ('dll_injection_hook', '15'), ('possible_includes_base64_packed_functions', '25'), ('Microsoft_Visual_Cpp_V80_Debug', '70'), ('Microsoft_Visual_Cpp_80_Debug_', '70'), ('Microsoft_Visual_Cpp_80_Debug', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('virtualbox_detection', '10'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '35'), ('Check_Dlls', '30'), ('Check_VBox_DeviceMap', '60'), ('Check_VBox_VideoDrivers', '60'), ('Check_VmTools', '60'), ('vmdetect_2', '60'), ('WMI_VM_Detect_v1', '50'), ('AtomTable_Inject', '35'), ('DLL_inject', '40'), ('Inject_Thread', '45'), ('Win_Hook_v12', '35'), ('Process_Doppelganging', '35'), ('Atom_Bombing', '40'), ('APC_Inject', '40'), ('Debugger_Check__GlobalFlags', '60'), ('Debugger_Check__QueryInfo', '60'), ('Debugger_Check__RemoteAPI', '60'), ('Debugger_Hiding__Thread', '60'), ('DebuggerHiding__Active_v1', '60'), ('DebuggerException__ConsoleCtrl_v1', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('ThreadControl__Context_v1', '60'), ('SEH__vectored_v1', '60'), ('Check_Debugger_v1', '60'), ('SEH_Init', '40'), ('Check_Qemu_Description', '40'), ('Check_Qemu_DeviceMap', '40'), ('vmdetect', '60'), ('WMI_VM_Detect', '50'), ('anti_dbg', '10'), ('vmdetect_misc', '50'), ('VMdetectMisc', '25'), ('SandboxDetectMisc', '70'), ('avdetect_procs', '70'), ('dbgdetect_procs', '70'), ('TrojanDownloaderCbeplaySample', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('MD5_API', '25')]
-------------- LOKI_Score ------------
['2959']
-------------- CAPA_Score ------------
['88.5']
-------------- CLAMAV_Score ------------
['25.0']
-------------- SCORE FINAL ------------
48977.52806662034
============================================


==================================================================
Fichier HTTP-FJVvSh488E0rn02jOk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F4bhdD1wCaRDoa5lMj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F4bhdD1wCaRDoa5lMj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.43 MB
Data read: 0.41 MB (ratio 1.06:1)
Time: 33.683 sec (0 m 33 s)
Start Date: 2022:02:07 12:09:55
End Date:   2022:02:07 12:10:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:09:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F4bhdD1wCaRDoa5lMj.exe SCORE: 334 TYPE: EXE SIZE: 429056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fec74ca4fa0> 
MD5: b28148e4dc7bd3e63dc0162ebc33685c 
SHA1: fde2ab2cfba3d62c79b74d214c4ac9bb31bcd2b6 
SHA256: 2ece870892bb1c19ae933a5411560d1fe4eb51dd6b6b510f82b05f2b1ba49851 CREATED: Mon Feb  7 12:09:55 2022 MODIFIED: Mon Feb  7 12:09:55 2022 ACCESSED: Mon Feb  7 12:10:46 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue Str2: dbghelp.dll
REASON_13: Yara Rule MATCH: antisb_threatExpert SUBSCORE: 60 
DESCRIPTION: Anti-Sandbox checks for ThreatExpert REF: - AUTHOR: x0r 
MATCHES: Str1: dbghelp.dll
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:10:48Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		antisb_threatExpert
20		isExecutable
10		Contains_PE_File

Score total: 334

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b28148e4dc7bd3e63dc0162ebc33685c                                                   |
| sha1                   | fde2ab2cfba3d62c79b74d214c4ac9bb31bcd2b6                                           |
| sha256                 | 2ece870892bb1c19ae933a5411560d1fe4eb51dd6b6b510f82b05f2b1ba49851                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F4bhdD1wCaRDoa5lMj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| DATA                        | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| check HTTP status code                               | communication/http/client                            |
| initialize Winsock library                           | communication/socket                                 |
| hash data using murmur3 (3 matches)                  | data-manipulation/hashing/murmur                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| terminate process via fastfail (74 matches)          | host-interaction/process/terminate                   |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (13 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 19.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('antisb_threatExpert', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['334']
-------------- CAPA_Score ------------
['19.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5682.6194142390505
============================================


==================================================================
Fichier HTTP-F4bhdD1wCaRDoa5lMj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCL82L5xBwz7umQRg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f716498e51219f64bfb4afabab44a796                                                   |
| sha1                   | 5a9f9a54524497784c31064bdb14e25a9d7f185e                                           |
| sha256                 | 62054b4aebc9da850fe32c6a056ceaa2039c5bd3f51e3f1471116792e8778ed9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FCL82L5xBwz7umQRg.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCL82L5xBwz7umQRg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 42.968 sec (0 m 42 s)
Start Date: 2022:02:07 12:11:24
End Date:   2022:02:07 12:12:07

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:11:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FCL82L5xBwz7umQRg.exe SCORE: 364 TYPE: EXE SIZE: 85840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc750f5efa0> 
MD5: f716498e51219f64bfb4afabab44a796 
SHA1: 5a9f9a54524497784c31064bdb14e25a9d7f185e 
SHA256: 62054b4aebc9da850fe32c6a056ceaa2039c5bd3f51e3f1471116792e8778ed9 CREATED: Mon Feb  7 12:11:24 2022 MODIFIED: Mon Feb  7 12:11:24 2022 ACCESSED: Mon Feb  7 12:12:14 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8df0800004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:12:14Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 364

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['364']
-------------- CAPA_Score ------------
['7.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5908.679582606274
============================================


==================================================================
Fichier HTTP-FCL82L5xBwz7umQRg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FetZ6JMLCRi5VYpoh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FetZ6JMLCRi5VYpoh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.68 MB
Data read: 0.64 MB (ratio 1.06:1)
Time: 44.065 sec (0 m 44 s)
Start Date: 2022:02:07 12:12:15
End Date:   2022:02:07 12:12:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:12:15Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FetZ6JMLCRi5VYpoh.exe SCORE: 174 TYPE: EXE SIZE: 673792 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fbcd3992fa0> 
MD5: 91a4b42dbe45d072db748b2a121f4982 
SHA1: 0c04f8d26b21b592cade665c29bc271a6ea9a136 
SHA256: 1a22fead39232589cae5bd5d4dee39b557af707f2d9d441d54c630b004139027 CREATED: Mon Feb  7 12:12:15 2022 MODIFIED: Mon Feb  7 12:12:15 2022 ACCESSED: Mon Feb  7 12:13:04 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 8db0ce862824541f40dfb767113f1e28
REASON_14: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:13:05Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
5		BASE64_table

Score total: 174

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 91a4b42dbe45d072db748b2a121f4982                                                   |
| sha1                   | 0c04f8d26b21b592cade665c29bc271a6ea9a136                                           |
| sha256                 | 1a22fead39232589cae5bd5d4dee39b557af707f2d9d441d54c630b004139027                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FetZ6JMLCRi5VYpoh.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Delete Directory:: [C0048]                                                    |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| encode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (12 matches)                   | data-manipulation/encoding/xor                       |
| encrypt data using DPAPI (2 matches)                 | data-manipulation/encryption/dpapi                   |
| hash data via BCrypt (3 matches)                     | data-manipulation/hashing                            |
| hash data using fnv (10 matches)                     | data-manipulation/hashing/fnv                        |
| generate random numbers via WinAPI (3 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| delete directory                                     | host-interaction/file-system/delete                  |
| get system information on Windows                    | host-interaction/os/info                             |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header (71 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 15.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['174']
-------------- CAPA_Score ------------
['15.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3057.003502127669
============================================


==================================================================
Fichier HTTP-FetZ6JMLCRi5VYpoh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fnm5D4LMs7kEqBCNh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fnm5D4LMs7kEqBCNh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.98 MB
Data read: 0.93 MB (ratio 1.05:1)
Time: 43.637 sec (0 m 43 s)
Start Date: 2022:02:07 12:14:29
End Date:   2022:02:07 12:15:12

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 464ef2ca59782ce697bc329713698ccc                                                   |
| sha1                   | 91e3e135a587bcf6b782dce6c548ed08cd71a677                                           |
| sha256                 | 178c7da3356a689d104bcddde9d3fb74a715b18fe27c55f43b207e9829825313                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fnm5D4LMs7kEqBCNh.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (2 matches)                | collection                                           |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| set environment variable (3 matches)                 | host-interaction/environment-variable                |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| print debug messages (3 matches)                     | host-interaction/log/debug/write-event               |
| allocate thread local storage (2 matches)            | host-interaction/process                             |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process (2 matches)                        | host-interaction/process/terminate                   |
| terminate process via fastfail (7 matches)           | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 19.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_V80_Debug', '70'), ('Microsoft_Visual_Cpp_80_Debug_', '70'), ('Microsoft_Visual_Cpp_80_Debug', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['649']
-------------- CAPA_Score ------------
['19.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
10675.032970491557
============================================


==================================================================
Fichier HTTP-Fnm5D4LMs7kEqBCNh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFlkIZ2XnAh13Nz1q1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2393d4f762fb671d92a59388109c24d4                                                   |
| sha1                   | 2e27346b7cff97619923c3e3199e68e7b91d142b                                           |
| sha256                 | 8d9373ebd69f42153b0b47dbda2174811599db91630651ca01627ac1795f8d56                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFlkIZ2XnAh13Nz1q1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFlkIZ2XnAh13Nz1q1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 43.006 sec (0 m 43 s)
Start Date: 2022:02:07 12:17:12
End Date:   2022:02:07 12:17:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:17:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFlkIZ2XnAh13Nz1q1.exe SCORE: 229 TYPE: EXE SIZE: 25088 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe53ddc8fa0> 
MD5: 2393d4f762fb671d92a59388109c24d4 
SHA1: 2e27346b7cff97619923c3e3199e68e7b91d142b 
SHA256: 8d9373ebd69f42153b0b47dbda2174811599db91630651ca01627ac1795f8d56 CREATED: Mon Feb  7 12:17:12 2022 MODIFIED: Mon Feb  7 12:17:12 2022 ACCESSED: Mon Feb  7 12:18:02 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:18:02Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3828.9316422328375
============================================


==================================================================
Fichier HTTP-FFlkIZ2XnAh13Nz1q1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FZMMKy2Tg3TPDz4m5j.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FZMMKy2Tg3TPDz4m5j.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.01 MB (ratio 3.67:1)
Time: 43.873 sec (0 m 43 s)
Start Date: 2022:02:07 12:18:03
End Date:   2022:02:07 12:18:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0
sh: 167: Syntax error: EOF in backquote substitution

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('ft_exe', '10'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('PackerUPX_CompresorGratuito_wwwupxsourceforgenet', '70'), ('UPX_wwwupxsourceforgenet_additional', '70'), ('yodas_Protector_v1033_dllocx_Ashkbiz_Danehkar_h', '70'), ('UPX_v0896_v102_v105_v124_Markus_Laszlo_overlay', '70'), ('UPX_v0896_v102_v105_v124_Markus_Laszlo_overlay_additional', '70'), ('UPX_wwwupxsourceforgenet', '70'), ('UPXv20MarkusLaszloReiser', '30'), ('UPXV200V290MarkusOberhumerLaszloMolnarJohnReiser', '70'), ('UPX20030XMarkusOberhumerLaszloMolnarJohnReiser', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('IsPacked', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('suspicious_packer_section', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['804']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
12742.54126738735
============================================


==================================================================
Fichier HTTP-FZMMKy2Tg3TPDz4m5j.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FVXIqb1gKiuOpxYCh3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FVXIqb1gKiuOpxYCh3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.24 MB
Data read: 1.18 MB (ratio 1.06:1)
Time: 43.349 sec (0 m 43 s)
Start Date: 2022:02:07 12:18:53
End Date:   2022:02:07 12:19:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:18:54Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FVXIqb1gKiuOpxYCh3.exe SCORE: 139 TYPE: EXE SIZE: 1233600 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2c498cbfa0> 
MD5: 8c0407e6173a8292b45d14d6ee1d9ecc 
SHA1: 8c4d5ef94403a5e95aca03b062f86d17fe554b93 
SHA256: ad7e97ad48a818bd078e4f691515e05a24d8a8d865d8b3f93e1febe32efad8c1 CREATED: Mon Feb  7 12:18:53 2022 MODIFIED: Mon Feb  7 12:18:53 2022 ACCESSED: Mon Feb  7 12:19:42 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:19:45Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 139

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 8c0407e6173a8292b45d14d6ee1d9ecc                                                   |
| sha1                   | 8c4d5ef94403a5e95aca03b062f86d17fe554b93                                           |
| sha256                 | ad7e97ad48a818bd078e4f691515e05a24d8a8d865d8b3f93e1febe32efad8c1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FVXIqb1gKiuOpxYCh3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints (4 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| encode data using XOR (152 matches)                  | data-manipulation/encoding/xor                       |
| encrypt data using RC4 KSA (5 matches)               | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 PRGA (5 matches)              | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate PE sections (7 matches)                    | load-code/pe                                         |
| parse PE exports (6 matches)                         | load-code/pe                                         |
| parse PE header (22 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
2		- Execution::Shared Modules [T1129;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 12.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['139']
-------------- CAPA_Score ------------
['12.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2452.4093268920574
============================================


==================================================================
Fichier HTTP-FVXIqb1gKiuOpxYCh3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FzNgpA3FZdAAVWkAF5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 81d41e225b8b55748ffb0d8747fe8bac                                                   |
| sha1                   | b8359399f1751ff1affc4a3a9f90f890cb17c9ed                                           |
| sha256                 | ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FzNgpA3FZdAAVWkAF5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FzNgpA3FZdAAVWkAF5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 42.609 sec (0 m 42 s)
Start Date: 2022:02:07 12:21:36
End Date:   2022:02:07 12:22:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:21:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FzNgpA3FZdAAVWkAF5.exe SCORE: 159 TYPE: EXE SIZE: 13824 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6d0e85bfa0> 
MD5: 81d41e225b8b55748ffb0d8747fe8bac 
SHA1: b8359399f1751ff1affc4a3a9f90f890cb17c9ed 
SHA256: ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d CREATED: Mon Feb  7 12:21:36 2022 MODIFIED: Mon Feb  7 12:21:36 2022 ACCESSED: Mon Feb  7 12:22:23 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:22:23Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_4
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['159']
-------------- CAPA_Score ------------
['7.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2659.6485380609915
============================================


==================================================================
Fichier HTTP-FzNgpA3FZdAAVWkAF5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F8cupZa4TYJdvDtih.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F8cupZa4TYJdvDtih.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.76 MB
Data read: 0.72 MB (ratio 1.06:1)
Time: 43.207 sec (0 m 43 s)
Start Date: 2022:02:07 12:22:24
End Date:   2022:02:07 12:23:07

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:22:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F8cupZa4TYJdvDtih.exe SCORE: 589 TYPE: EXE SIZE: 754688 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f911d7ddfa0> 
MD5: c7f3ef97d20486e2b80583909df8ee12 
SHA1: 322414f78b35fa2d285334de26a8236a6addba01 
SHA256: 64066d51263176642765cf54943c92a2a73fdc52e23418c4819750a7934db708 CREATED: Mon Feb  7 12:22:24 2022 MODIFIED: Mon Feb  7 12:22:24 2022 ACCESSED: Mon Feb  7 12:23:14 2022 
REASON_1: Yara Rule MATCH: create_com_service SUBSCORE: 45 
DESCRIPTION: Create a COM server REF: - AUTHOR: x0r 
MATCHES: Str1: DllCanUnloadNow Str2: DllGetClassObject Str3: DllInstall Str4: DllRegisterServer Str5: DllUnregisterServer
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: 45c70001
REASON_17: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_18: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_20: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: f777dd4ec435cf534e5ac769899e2edc Str2: 160a746f73309ce8669c4d223c272932 Str3: 7909abc2ae44f82297bc7fd4cf7bf159 Str4: bef5238a41524bf5 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:23:16Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_com_service
60		win_mutex
20		win_registry
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
60		vmdetect_2
30		Check_OutputDebugStringA_iat_v1
60		vmdetect
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 589

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c7f3ef97d20486e2b80583909df8ee12                                                   |
| sha1                   | 322414f78b35fa2d285334de26a8236a6addba01                                           |
| sha256                 | 64066d51263176642765cf54943c92a2a73fdc52e23418c4819750a7934db708                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F8cupZa4TYJdvDtih.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| encode data using XOR (7 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| hash data using fnv (7 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable                           | host-interaction/environment-variable                |
| check if file exists (3 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| print debug messages (3 matches)                     | host-interaction/log/debug/write-event               |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| allocate thread local storage                        | host-interaction/process                             |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key (2 matches)          | host-interaction/registry                            |
| query or enumerate registry value (7 matches)        | host-interaction/registry                            |
| set registry value (7 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| delete registry value (3 matches)                    | host-interaction/registry/delete                     |
| link function at runtime on Windows (7 matches)      | linking/runtime-linking                              |
| parse PE header (12 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
1.5		- Discovery::System Location Discovery [T1614;1.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 17.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('create_com_service', '45'), ('win_mutex', '60'), ('win_registry', '20'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('vmdetect_2', '60'), ('Check_OutputDebugStringA_iat_v1', '30'), ('vmdetect', '60'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['589']
-------------- CAPA_Score ------------
['17.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
9674.215497140667
============================================


==================================================================
Fichier HTTP-F8cupZa4TYJdvDtih.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXQa4H28LACSsIRu1h.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2ea4a7b914044f15c56acf932a1569ba                                                   |
| sha1                   | 1b40046766db3713f434d61abff529f8293f8454                                           |
| sha256                 | 989f652848f7267aaf5b22f6d1ec1453377412f1fe21a78d05bf6617f6bb8872                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXQa4H28LACSsIRu1h.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXQa4H28LACSsIRu1h.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 41.985 sec (0 m 41 s)
Start Date: 2022:02:07 12:24:55
End Date:   2022:02:07 12:25:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:24:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXQa4H28LACSsIRu1h.exe SCORE: 374 TYPE: EXE SIZE: 98120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc50b36afa0> 
MD5: 2ea4a7b914044f15c56acf932a1569ba 
SHA1: 1b40046766db3713f434d61abff529f8293f8454 
SHA256: 989f652848f7267aaf5b22f6d1ec1453377412f1fe21a78d05bf6617f6bb8872 CREATED: Mon Feb  7 12:24:55 2022 MODIFIED: Mon Feb  7 12:24:55 2022 ACCESSED: Mon Feb  7 12:25:45 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8f70600004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 8db0ce862824541f40dfb767113f1e28
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:25:46Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 374

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['374']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5987.35840925363
============================================


==================================================================
Fichier HTTP-FXQa4H28LACSsIRu1h.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSx28N3vgPoPXY6yT5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 53cba9af8d65fadbd0f7e5f9ff15cad3                                                   |
| sha1                   | c0c1b0c563bb9eeca89e2fd6b712aba6a119ae57                                           |
| sha256                 | 6767fd66f28a1d39cb84f59e8a86b3ea99e22d204d2aac821e0d01ac232fba56                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSx28N3vgPoPXY6yT5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Download URL [C0002.006]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data                                         | communication                                        |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| create process on Windows                            | host-interaction/process/create                      |
| get session user name                                | host-interaction/session                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::Account Discovery [T1087;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]

Score total: 21.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSx28N3vgPoPXY6yT5.exe: Win.Trojan.Downloader-47085 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 36.029 sec (0 m 36 s)
Start Date: 2022:02:07 12:25:46
End Date:   2022:02:07 12:26:22

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Downloader-47085

Score total: 45.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Downloader-47085', '45')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['659']
-------------- CAPA_Score ------------
['21.0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
11429.967659769578
============================================


==================================================================
Fichier HTTP-FSx28N3vgPoPXY6yT5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1MmT72l8B0CHf7Tq.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1MmT72l8B0CHf7Tq.exe: Win.Trojan.Hupigon-10307 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.27 MB
Data read: 0.25 MB (ratio 1.06:1)
Time: 39.720 sec (0 m 39 s)
Start Date: 2022:02:07 12:26:37
End Date:   2022:02:07 12:27:16

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Hupigon-10307

Score total: 45.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:26:37Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:27:28Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Hupigon-10307', '45')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
566.5164353073753
============================================


==================================================================
Fichier HTTP-F1MmT72l8B0CHf7Tq.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FbNqhd3y6auzRN5tQ8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FbNqhd3y6auzRN5tQ8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.74 MB
Data read: 0.70 MB (ratio 1.06:1)
Time: 37.964 sec (0 m 37 s)
Start Date: 2022:02:07 12:27:28
End Date:   2022:02:07 12:28:06

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:27:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FbNqhd3y6auzRN5tQ8.exe SCORE: 409 TYPE: EXE SIZE: 739840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2886749fa0> 
MD5: c3db7abc637f7c820f605b91fa6e1717 
SHA1: 5a494165a180868545c68e3c78b5c85ba39adecf 
SHA256: d10944c16053504739af3f1f2620fa652b2191622e826199aa69f19467aa494d CREATED: Mon Feb  7 12:27:28 2022 MODIFIED: Mon Feb  7 12:27:28 2022 ACCESSED: Mon Feb  7 12:28:19 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: ConventionEngine_Anomaly_Short_TripleChar SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453924b942710d8af5fe50dd84f5cbd77dd010000007664732e70646200
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER Str4: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER Str4: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER Str4: Identifier
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:28:21Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
50		ConventionEngine_Anomaly_Short_TripleChar
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 409

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c3db7abc637f7c820f605b91fa6e1717                                                   |
| sha1                   | 5a494165a180868545c68e3c78b5c85ba39adecf                                           |
| sha256                 | d10944c16053504739af3f1f2620fa652b2191622e826199aa69f19467aa494d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FbNqhd3y6auzRN5tQ8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Execution Guardrails::Runs as Service [E1480.m07]                             |
| FILE SYSTEM                 | Delete Directory:: [C0048]                                                    |
| OPERATING SYSTEM            | Registry::Delete Registry Key [C0036.002]                                     |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints (4 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| delete directory                                     | host-interaction/file-system/delete                  |
| get storage device properties                        | host-interaction/hardware/storage                    |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| run as service                                       | host-interaction/service                             |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
3		- Execution::System Services::Service Execution [T1569.002;3]

Score total: 27.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('ConventionEngine_Anomaly_Short_TripleChar', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['409']
-------------- CAPA_Score ------------
['27.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
7020.933982207551
============================================


==================================================================
Fichier HTTP-FbNqhd3y6auzRN5tQ8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FvOLYj2VaowYvrCfUg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3e552dc653d5a927e4dd977e726340dd                                                   |
| sha1                   | 45fa65130321f800fd88fa9119245e5a5ef81183                                           |
| sha256                 | 5f24efa8e9df2a97a19f402f2461b2ad9bd12c1d92c4fbc6f4ccd163f689dea7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FvOLYj2VaowYvrCfUg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FvOLYj2VaowYvrCfUg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 43.920 sec (0 m 43 s)
Start Date: 2022:02:07 12:28:59
End Date:   2022:02:07 12:29:43

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:29:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FvOLYj2VaowYvrCfUg.exe SCORE: 324 TYPE: EXE SIZE: 52736 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe674ff3fa0> 
MD5: 3e552dc653d5a927e4dd977e726340dd 
SHA1: 45fa65130321f800fd88fa9119245e5a5ef81183 
SHA256: 5f24efa8e9df2a97a19f402f2461b2ad9bd12c1d92c4fbc6f4ccd163f689dea7 CREATED: Mon Feb  7 12:28:59 2022 MODIFIED: Mon Feb  7 12:28:59 2022 ACCESSED: Mon Feb  7 12:29:51 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:29:52Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 324

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['324']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5194.911813023074
============================================


==================================================================
Fichier HTTP-FvOLYj2VaowYvrCfUg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F56xm528cyS5x8AeGe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be a .NET module.
WARNING:capa: 
WARNING:capa: .NET is a cross-platform framework for running managed applications.
WARNING:capa: capa cannot handle non-native files. This means that the results may be misleading or incomplete.
WARNING:capa: You may have to analyze the file manually, using a tool like the .NET decompiler dnSpy.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) dotnet file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:29:52Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F56xm528cyS5x8AeGe.exe SCORE: 174 TYPE: EXE SIZE: 19456 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8e6552efa0> 
MD5: 2d76a5b22e9a23cd978f9e983e5b445e 
SHA1: 67d13b4441118c841b7fc663d2eb1daa84fa87a2 
SHA256: 1fc1c966618f3de21f51f5e4bc5c658cec61532af64379e6701fb5d73899e137 CREATED: Mon Feb  7 12:29:52 2022 MODIFIED: Mon Feb  7 12:29:52 2022 ACCESSED: Mon Feb  7 12:30:28 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: dotnet_libraries SUBSCORE: 5 
DESCRIPTION: .Net runtime mscoree.dll mscorwks.dll REF: - AUTHOR: - 
MATCHES: Str1: mscoree.dll Str2: _CorDllMain
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_C_Basic_NET SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500200010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_6: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsNET_DLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:30:28Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_4
5		dotnet_libraries
5		executable_pe
70		Microsoft_Visual_C_Basic_NET
10		IsPE32
10		IsNET_DLL
10		IsDLL
10		IsConsole
10		HasDebugData
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 174

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F56xm528cyS5x8AeGe.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 41.716 sec (0 m 41 s)
Start Date: 2022:02:07 12:29:52
End Date:   2022:02:07 12:30:34

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_4', '2'), ('dotnet_libraries', '5'), ('executable_pe', '5'), ('Microsoft_Visual_C_Basic_NET', '70'), ('IsPE32', '10'), ('IsNET_DLL', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['174']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2757.714154882337
============================================


==================================================================
Fichier HTTP-F56xm528cyS5x8AeGe.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FGWMEo3acRbRv4rZ4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c277798eb447730580ad21ea647b9d36                                                   |
| sha1                   | a38373fde7a13bfa784003fa8efed0dc784debab                                           |
| sha256                 | 49d5cc85b8f66cdb238ed1d4bb46709b975f1627acfc934385271ed3be6f77d1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FGWMEo3acRbRv4rZ4.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::File Transfer Protocol \[T1071.002]\                   |
|                        | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | FTP Communication::Send File [C0004.001]                                      |
|                             | FTP Communication::WinINet [C0004.002]                                        |
|                             | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send file using FTP via wininet (2 matches)          | communication/ftp/send                               |
| connect to HTTP server (2 matches)                   | communication/http/client                            |
| initialize Winsock library                           | communication/socket                                 |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| write file on Windows                                | host-interaction/file-system/write                   |
| get hostname                                         | host-interaction/os/hostname                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
6		- Command and Control::Application Layer Protocol::File Transfer Protocol [T1071.002;6]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 21.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FGWMEo3acRbRv4rZ4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 38.059 sec (0 m 38 s)
Start Date: 2022:02:07 12:30:34
End Date:   2022:02:07 12:31:12

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Command and Control::Application Layer Protocol::File Transfer Protocol [T1071.002;6]', '6'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Installer_VISE_Custom_additional', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Installer_VISE_Custom', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['759']
-------------- CAPA_Score ------------
['21.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
12448.344416923315
============================================


==================================================================
Fichier HTTP-FGWMEo3acRbRv4rZ4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Ff1Hyo3XdAFlMGg7d3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 58e8cbd053e64539fcd87bd08ab89d1b                                                   |
| sha1                   | 70fa7d97a39cc1610a2d66d8aa227e33f5dc1a36                                           |
| sha256                 | 6e71d0bb7fa0f02071460c55433209794f95f81058186142155de0330915b3c7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Ff1Hyo3XdAFlMGg7d3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:31:26Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Ff1Hyo3XdAFlMGg7d3.exe SCORE: 109 TYPE: EXE SIZE: 6144 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f358af5efa0> 
MD5: 58e8cbd053e64539fcd87bd08ab89d1b 
SHA1: 70fa7d97a39cc1610a2d66d8aa227e33f5dc1a36 
SHA256: 6e71d0bb7fa0f02071460c55433209794f95f81058186142155de0330915b3c7 CREATED: Mon Feb  7 12:31:26 2022 MODIFIED: Mon Feb  7 12:31:26 2022 ACCESSED: Mon Feb  7 12:31:58 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_3 SUBSCORE: 2 
DESCRIPTION: Low entropy - very sparse data or repeating plaintext REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:31:58Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_3
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Ff1Hyo3XdAFlMGg7d3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 1.00:1)
Time: 42.840 sec (0 m 42 s)
Start Date: 2022:02:07 12:31:26
End Date:   2022:02:07 12:32:09

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_3', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('ImportTableIsBad', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['109']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1747.4862029323024
============================================


==================================================================
Fichier HTTP-Ff1Hyo3XdAFlMGg7d3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F5aEtzLYpkAGTeSg3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 14d4bdcc5f0fe917abde4b01e39a350e                                                   |
| sha1                   | a2a7352960517502487fb46253a057f51872625e                                           |
| sha256                 | 435be1c6e904836ad65f97f3eac4cbe19ee7ba0da48178fc7f00206270469165                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F5aEtzLYpkAGTeSg3.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter::Windows Command Shell \[T1059.003]\             |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
|                             | Interprocess Communication::Read Pipe [C0003.003]                             |
| DATA                        | Encode Data::Base64 [C0026.001]                                               |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Self Deletion::COMSPEC Environment Variable [F0007.001]                       |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| self delete                                          | anti-analysis/anti-forensic/self-deletion            |
| execute shell command and capture output             | c2/shell                                             |
| receive data                                         | communication                                        |
| create two anonymous pipes                           | communication/named-pipe/create                      |
| read pipe                                            | communication/named-pipe/read                        |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| create process on Windows (2 matches)                | host-interaction/process/create                      |
| terminate process                                    | host-interaction/process/terminate                   |
| terminate thread (5 matches)                         | host-interaction/thread/terminate                    |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
5		- Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003;5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 32.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F5aEtzLYpkAGTeSg3.exe: Win.Trojan.Agent-648031 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 1.00:1)
Time: 35.188 sec (0 m 35 s)
Start Date: 2022:02:07 12:32:09
End Date:   2022:02:07 12:32:44

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-648031
75		Win.Trojan.Agent-648031
45		Win.Trojan.Agent-648031

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:32:10Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F5aEtzLYpkAGTeSg3.exe SCORE: 499 TYPE: EXE SIZE: 6656 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f26bc41ffa0> 
MD5: 14d4bdcc5f0fe917abde4b01e39a350e 
SHA1: a2a7352960517502487fb46253a057f51872625e 
SHA256: 435be1c6e904836ad65f97f3eac4cbe19ee7ba0da48178fc7f00206270469165 CREATED: Mon Feb  7 12:32:09 2022 MODIFIED: Mon Feb  7 12:32:09 2022 ACCESSED: Mon Feb  7 12:32:59 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile
REASON_2: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_3: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetOpen
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68e820400068801b400064a100000000506489250000000083ec68535657
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68e820400068801b400064a10000000050
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68e820400068801b400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec6aff68e820400068801b400064a10000000050
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68e820400068801b400064a1000000005064892500000000
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:32:59Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 499

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003;5]', '5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-648031', '70'), ('Win.Trojan.Agent-648031', '75'), ('Win.Trojan.Agent-648031', '45')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['499']
-------------- CAPA_Score ------------
['32.5']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
10949.03556515476
============================================


==================================================================
Fichier HTTP-F5aEtzLYpkAGTeSg3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FrRvgG2GXk7MNfIRUf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9b0bf8d01b0fe7132f7bc6eb031eb46d                                                   |
| sha1                   | 200e768832b3d1bf345d930d1328f0528399c0c4                                           |
| sha256                 | 3ef4edafe8d587a91ef023b470e84b2b05c0327d4ca6701a34d5e0ab0ad0bbfc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FrRvgG2GXk7MNfIRUf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:33:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FrRvgG2GXk7MNfIRUf.exe SCORE: 109 TYPE: EXE SIZE: 35840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f41b2dacfa0> 
MD5: 9b0bf8d01b0fe7132f7bc6eb031eb46d 
SHA1: 200e768832b3d1bf345d930d1328f0528399c0c4 
SHA256: 3ef4edafe8d587a91ef023b470e84b2b05c0327d4ca6701a34d5e0ab0ad0bbfc CREATED: Mon Feb  7 12:33:00 2022 MODIFIED: Mon Feb  7 12:33:00 2022 ACCESSED: Mon Feb  7 12:33:27 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_3 SUBSCORE: 2 
DESCRIPTION: Low entropy - very sparse data or repeating plaintext REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:33:27Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_3
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FrRvgG2GXk7MNfIRUf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 42.266 sec (0 m 42 s)
Start Date: 2022:02:07 12:33:00
End Date:   2022:02:07 12:33:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_3', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('ImportTableIsBad', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['109']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1747.4862029323024
============================================


==================================================================
Fichier HTTP-FrRvgG2GXk7MNfIRUf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmZeIL1r5Xm7NKofBj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e5d1458bc7802b7647ee4bf7eafa0e20                                                   |
| sha1                   | e942f73990453954f8852a6d4128e929a7c236f0                                           |
| sha256                 | 21406ebfb9f68e56b75045a0b9c78a6b5c5a843f3ca22ee56cacd561f721913a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmZeIL1r5Xm7NKofBj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes               | host-interaction/driver                              |
| modify access privileges                             | host-interaction/process/modify                      |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 9.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmZeIL1r5Xm7NKofBj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 39.869 sec (0 m 39 s)
Start Date: 2022:02:07 12:33:42
End Date:   2022:02:07 12:34:22

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:33:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmZeIL1r5Xm7NKofBj.exe SCORE: 294 TYPE: EXE SIZE: 27448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fddac700fa0> 
MD5: e5d1458bc7802b7647ee4bf7eafa0e20 
SHA1: e942f73990453954f8852a6d4128e929a7c236f0 
SHA256: 21406ebfb9f68e56b75045a0b9c78a6b5c5a843f3ca22ee56cacd561f721913a CREATED: Mon Feb  7 12:33:42 2022 MODIFIED: Mon Feb  7 12:33:42 2022 ACCESSED: Mon Feb  7 12:34:32 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: AdjustTokenPrivileges Str4: OpenProcessToken
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:34:32Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 294

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '65'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['294']
-------------- CAPA_Score ------------
['9.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4839.159594182873
============================================


==================================================================
Fichier HTTP-FmZeIL1r5Xm7NKofBj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FNcpiU3bsHQuAO3Pfh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | fedbac964787ad4898109a744fb6ec02                                                   |
| sha1                   | 1daea40e923ee1fd8c5832274cdd478a45685e46                                           |
| sha256                 | 743f8e8a91b2d1e0db9323109034de91a1e065242a33a90bb787a63edb860b35                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FNcpiU3bsHQuAO3Pfh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | ICMP Communication::Echo Request [C0014.002]                                  |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send ICMP echo request                               | communication/icmp                                   |
| initialize Winsock library                           | communication/socket                                 |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| resolve DNS (2 matches)                              | host-interaction/network/dns/resolve                 |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]

Score total: 11.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FNcpiU3bsHQuAO3Pfh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 43.180 sec (0 m 43 s)
Start Date: 2022:02:07 12:34:33
End Date:   2022:02:07 12:35:16

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:34:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FNcpiU3bsHQuAO3Pfh.exe SCORE: 239 TYPE: EXE SIZE: 18432 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff17312ffa0> 
MD5: fedbac964787ad4898109a744fb6ec02 
SHA1: 1daea40e923ee1fd8c5832274cdd478a45685e46 
SHA256: 743f8e8a91b2d1e0db9323109034de91a1e065242a33a90bb787a63edb860b35 CREATED: Mon Feb  7 12:34:33 2022 MODIFIED: Mon Feb  7 12:34:33 2022 ACCESSED: Mon Feb  7 12:35:24 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:35:24Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 239

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['239']
-------------- CAPA_Score ------------
['11.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4017.349896203482
============================================


==================================================================
Fichier HTTP-FNcpiU3bsHQuAO3Pfh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FN1d7bLEV9tnTFaCk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dc61643cd353aa826f2b8df06422b266                                                   |
| sha1                   | 7ec8f511717a71f692a79a27e348c6654d0d6f40                                           |
| sha256                 | 27858972c18afccd944453b72feeeba66b1587f2075087780aa4fc54202d8221                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FN1d7bLEV9tnTFaCk.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions (9 matches)             | anti-analysis/anti-vm/vm-detection                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail                       | host-interaction/process/terminate                   |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| enumerate PE sections (9 matches)                    | load-code/pe                                         |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::Query Registry [T1012;1]

Score total: 13.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FN1d7bLEV9tnTFaCk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 37.567 sec (0 m 37 s)
Start Date: 2022:02:07 12:35:24
End Date:   2022:02:07 12:36:02

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:35:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FN1d7bLEV9tnTFaCk.exe SCORE: 234 TYPE: EXE SIZE: 76600 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2b3708afa0> 
MD5: dc61643cd353aa826f2b8df06422b266 
SHA1: 7ec8f511717a71f692a79a27e348c6654d0d6f40 
SHA256: 27858972c18afccd944453b72feeeba66b1587f2075087780aa4fc54202d8221 CREATED: Mon Feb  7 12:35:24 2022 MODIFIED: Mon Feb  7 12:35:24 2022 ACCESSED: Mon Feb  7 12:36:14 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:36:14Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 234

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['234']
-------------- CAPA_Score ------------
['13.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3968.0341713049593
============================================


==================================================================
Fichier HTTP-FN1d7bLEV9tnTFaCk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3RlQ23qZwEumLLrR2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dafbea2a91f86bf5e52efa3bac3f1b16                                                   |
| sha1                   | 6a41735369934a212fc90dbd8c847c26270b3fba                                           |
| sha256                 | 1fb3c4a9109ef171fa67bdf90e67f09ef25b5a1d401dc20dc45cfccf1e4fbd99                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F3RlQ23qZwEumLLrR2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get common file path                                 | host-interaction/file-system                         |
| inject dll                                           | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| link function at runtime on Windows                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]

Score total: 15.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3RlQ23qZwEumLLrR2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.077 sec (0 m 43 s)
Start Date: 2022:02:07 12:36:15
End Date:   2022:02:07 12:36:58

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]', '6'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('ft_exe', '10'), ('math_entropy_3', '2'), ('executable_pe', '5'), ('dll_injection_thread', '15'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Inject_Thread', '45'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['689']
-------------- CAPA_Score ------------
['15.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
11219.203443302404
============================================


==================================================================
Fichier HTTP-F3RlQ23qZwEumLLrR2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F2jcGU3KuQwQNwhE6e.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c9d776b6a4bc22b5b9a0985ab9cd6101                                                   |
| sha1                   | fc72d96df9d0e61a0458280290b27165258d735c                                           |
| sha256                 | 81765113b2df32f13ef09fc96645c183f6064b27fcf4f3a3575088f016bbb5a5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F2jcGU3KuQwQNwhE6e.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| write file on Windows                                | host-interaction/file-system/write                   |
| get token membership                                 | host-interaction/session                             |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]

Score total: 6.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F2jcGU3KuQwQNwhE6e.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 43.266 sec (0 m 43 s)
Start Date: 2022:02:07 12:37:04
End Date:   2022:02:07 12:37:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:37:05Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F2jcGU3KuQwQNwhE6e.exe SCORE: 229 TYPE: EXE SIZE: 18944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fbeea07dfa0> 
MD5: c9d776b6a4bc22b5b9a0985ab9cd6101 
SHA1: fc72d96df9d0e61a0458280290b27165258d735c 
SHA256: 81765113b2df32f13ef09fc96645c183f6064b27fcf4f3a3575088f016bbb5a5 CREATED: Mon Feb  7 12:37:04 2022 MODIFIED: Mon Feb  7 12:37:04 2022 ACCESSED: Mon Feb  7 12:37:48 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:37:48Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['6.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3749.121149634082
============================================


==================================================================
Fichier HTTP-F2jcGU3KuQwQNwhE6e.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FMM0d53Q84d28xURvf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9a77a7b2a0857916a97ffaac7695314b                                                   |
| sha1                   | 3d0de37b9c6b70a3c92dadcb4d4dcfda96da9527                                           |
| sha256                 | 2a9934712bcd65573605a90cd362c8c237f75d395b053df0c0d02d532b5bc405                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FMM0d53Q84d28xURvf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR (7 matches)                    | data-manipulation/encoding/xor                       |
| hash data using fnv (7 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
2		- Execution::Shared Modules [T1129;2]

Score total: 6.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:37:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FMM0d53Q84d28xURvf.exe SCORE: 109 TYPE: EXE SIZE: 93696 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff5a8eeafa0> 
MD5: 9a77a7b2a0857916a97ffaac7695314b 
SHA1: 3d0de37b9c6b70a3c92dadcb4d4dcfda96da9527 
SHA256: 2a9934712bcd65573605a90cd362c8c237f75d395b053df0c0d02d532b5bc405 CREATED: Mon Feb  7 12:37:48 2022 MODIFIED: Mon Feb  7 12:37:48 2022 ACCESSED: Mon Feb  7 12:38:26 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: c3181255b064f97f09581282d90d484a Str2: 76c43bbe81a798c7cbe5d5cf5684e32d
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:38:26Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 109

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FMM0d53Q84d28xURvf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 43.883 sec (0 m 43 s)
Start Date: 2022:02:07 12:37:48
End Date:   2022:02:07 12:38:32

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['109']
-------------- CAPA_Score ------------
['6.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1847.2493186807462
============================================


==================================================================
Fichier HTTP-FMM0d53Q84d28xURvf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FZdEqJELPYx0uI949.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FZdEqJELPYx0uI949.exe: Win.Dropper.ClipBanker-9778171-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FZdEqJELPYx0uI949.exe: Win.Tool.Mimikatz-9862700-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FZdEqJELPYx0uI949.exe: Win.Trojan.Mimikatz-6466236-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.82 MB
Data read: 0.77 MB (ratio 1.06:1)
Time: 45.022 sec (0 m 45 s)
Start Date: 2022:02:07 12:38:32
End Date:   2022:02:07 12:39:17

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.ClipBanker-9778171-0
10		Win.Tool.Mimikatz-9862700-0
45		Win.Trojan.Mimikatz-6466236-0

Score total: 85.0
sh: 1: gentilkiwi: not found

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:38:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FZdEqJELPYx0uI949.exe SCORE: 1869 TYPE: EXE SIZE: 808600 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fef70e76fa0> 
MD5: 5f66b82558ca92e54e77f216ef4c066c 
SHA1: e4f82e4d7f22938dc0a0ff8a4a7ad2a763643d38 
SHA256: 131314a6f6d1d263c75b9909586b3e1bd837036329ace5e69241749e861ac01d CREATED: Mon Feb  7 12:38:32 2022 MODIFIED: Mon Feb  7 12:38:32 2022 ACCESSED: Mon Feb  7 12:39:24 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: CreateService Str4: ControlService Str5: StartService Str6: QueryServiceStatus
REASON_3: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: DNSAPI.dll Str2: DnsQuery
REASON_4: Yara Rule MATCH: cred_local SUBSCORE: 80 
DESCRIPTION: Steal credential REF: - AUTHOR: x0r 
MATCHES: Str1: SamIConnect Str2: SamQueryInformationUse Str3: CredEnumerateW
REASON_5: Yara Rule MATCH: spreading_share SUBSCORE: 70 
DESCRIPTION: Malware can spread east-west using share drive REF: - AUTHOR: x0r 
MATCHES: Str1: NETAPI32.dll Str2: netapi32.dll Str3: NetShareEnum
REASON_6: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_7: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: RegCloseKey
REASON_8: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: DuplicateTokenEx Str4: OpenProcessToken
REASON_9: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindClose
REASON_10: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_11: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: hacktool_windows_mimikatz_copywrite SUBSCORE: 50 
DESCRIPTION: Mimikatz credential dump tool: Author copywrite REF: https://github.com/gentilkiwi/mimikatz AUTHOR: @fusionrace 
MATCHES: Str1: Benjamin DELPY  Str2: http://blog.gentilkiwi.com/mimikatz Str3: http://blog.gentilkiwi.com/mimikatz Str4: Build with love ... (truncated)
REASON_13: Yara Rule MATCH: hacktool_windows_mimikatz_modules SUBSCORE: 50 
DESCRIPTION: Mimikatz credential dump tool: Modules REF: https://github.com/gentilkiwi/mimikatz AUTHOR: @fusionrace 
MATCHES: Str1: mimidrv
REASON_14: Yara Rule MATCH: Powerkatz_DLL_Generic SUBSCORE: 80 
DESCRIPTION: Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible) REF: PowerKatz Analysis AUTHOR: Florian Roth 
MATCHES: Str1: kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x) Str2: kuhl_m_lsadump_getComputerAndSyskey ; kuh ... (truncated)
REASON_15: Yara Rule MATCH: HackTool_Producers SUBSCORE: 50 
DESCRIPTION: Hacktool Producers String REF: - AUTHOR: - 
MATCHES: Str1: gentilkiwi.com
REASON_16: Yara Rule MATCH: mimikatz SUBSCORE: 70 
DESCRIPTION: mimikatz REF: - AUTHOR: Benjamin DELPY (gentilkiwi) 
MATCHES: Str1: 89710489308d04bd Str2: 8b4de48b45f48975e8890185ff74 Str3: 8b4de88b45f48975ec890185ff74
REASON_17: Yara Rule MATCH: Mimikatz_Strings SUBSCORE: 65 
DESCRIPTION: Detects Mimikatz strings REF: not set AUTHOR: Florian Roth 
MATCHES: Str1: List tickets in MIT/Heimdall ccache Str2: kuhl_m_kerberos_ptt_file ; LsaCallKerberosPackage %08x Str3: * Injecting ticket : Str4: mim ... (truncated)
REASON_18: Yara Rule MATCH: Mimikatz_Gen_Strings SUBSCORE: 70 
DESCRIPTION: Detects Mimikatz by using some special strings REF: Internal Research AUTHOR: Florian Roth 
MATCHES: Str1: [*] '%s' service already started Str2: ** Security Callback! ** Str3: Try to export a software CA to a crypto (virtual)hardware Str4: ... (truncated)
REASON_19: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645ea00c645eb00c645ec00c645 Str2: c645eb00c645ec00c645ed00c645 Str3: c645f819c645f917c645fa16c645 Str4: c645a060c645a1bac645a24fc645 ... (truncated)
REASON_21: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_22: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_23: Yara Rule MATCH: Visual_Cpp_2005_Release_Microsoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8ce98ffffe9a1fdffff Str2: e84640ffffe92cfdffff Str3: e81f65feffe965fdffff Str4: e85dcafeffe958fdffff Str5: e8f3c8feffe956fdffff Str6 ... (truncated)
REASON_24: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e803e4ffffe9bffeffff Str2: e80a000000e971ffffff Str3: e804894508e954ffffff Str4: e872e1ffffe900ffffff Str5: e81b930200e90cffffff Str6 ... (truncated)
REASON_25: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_26: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_27: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_28: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_29: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 982c00000002020030822c8906092a864886f70d010702a0822c7a30822c76020101310b300906052b0e03021a0500304c060a2b060104018237020104a03e303c301 ... (truncated)
REASON_30: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_31: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_32: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: IDENTIFIER Str2: Identifier
REASON_33: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: IDENTIFIER Str2: Identifier
REASON_34: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: IDENTIFIER Str2: Identifier
REASON_35: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_36: Yara Rule MATCH: DLL_inject SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: LoadLibraryA Str4: CreateFileA Str5: WriteProcessMemory Str6: HeapAlloc Str7: GetProcAddress S ... (truncated)
REASON_37: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_38: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_39: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_40: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_41: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_42: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_43: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_44: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_45: Yara Rule MATCH: with_sqlite SUBSCORE: 60 
DESCRIPTION: Rule to detect the presence of SQLite data in raw image REF: http://www.st2labs.com AUTHOR: Julian J. Gonzalez <info@seguridadparatodos.es> 
MATCHES: Str1: SQLite format 3
REASON_46: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_47: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_48: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00112233445566778899
REASON_49: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 0123456789ABCDEF0123456789abcdef
REASON_50: Yara Rule MATCH: Big_Numbers3 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 64:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: bd49a8271d650fa89e446b42e513b595a717b9212c91dd384aab871fc1d0f6d7
REASON_51: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext Str6: CryptAcquireContext
REASON_52: Yara Rule MATCH: MD5_API SUBSCORE: 25 
DESCRIPTION: Looks for MD5 API REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: cryptdll.dll Str4: cryptdll.dll Str5: MD5Init Str6: MD5Update Str7: MD5Final
REASON_53: Yara Rule MATCH: DES_Long SUBSCORE: 15 
DESCRIPTION: DES [long] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 10801040000000000080100000001040100000401080000000800040008010000080000010001040100000000080004010001000008010400000104010000000
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:39:27Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		create_service
50		network_dns
80		cred_local
70		spreading_share
60		win_mutex
20		win_registry
65		win_token
10		win_files_operation
10		misc_pe_signature
10		ft_exe
50		hacktool_windows_mimikatz_copywrite
50		hacktool_windows_mimikatz_modules
80		Powerkatz_DLL_Generic
50		HackTool_Producers
70		mimikatz
65		Mimikatz_Strings
70		Mimikatz_Gen_Strings
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_thread
70		Visual_Cpp_2005_Release_Microsoft
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasOverlay
10		HasDigitalSignature
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
40		DLL_inject
45		Inject_Thread
60		Debugger_Check__QueryInfo
60		DebuggerException__SetConsoleCtrl_v1
30		Check_OutputDebugStringA_iat_v1
40		SEH_Save
40		SEH_Init
30		Check_OutputDebugStringA_iat
10		anti_dbg
60		with_sqlite
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0
10		Big_Numbers1
10		Big_Numbers3
20		Advapi_Hash_API
25		MD5_API
15		DES_Long

Score total: 1869

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5f66b82558ca92e54e77f216ef4c066c                                                   |
| sha1                   | e4f82e4d7f22938dc0a0ff8a4a7ad2a763643d38                                           |
| sha256                 | 131314a6f6d1d263c75b9909586b3e1bd837036329ace5e69241749e861ac01d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FZdEqJELPYx0uI949.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Archive Collected Data::Archive via Library \[T1560.002]\                          |
|                        | Clipboard Data:: \[T1115]\                                                         |
|                        | Data from Information Repositories:: \[T1213]\                                     |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| CREDENTIAL ACCESS      | Credentials from Password Stores::Windows Credential Manager \[T1555.004]\         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Indicator Removal on Host::Clear Windows Event Logs \[T1070.001]\                  |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Domain Trust Discovery:: \[T1482]\                                                 |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Network Share Discovery:: \[T1135]\                                                |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
|                        | System Network Configuration Discovery :: \[T1016]\                                |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Execution Guardrails::Runs as Service [E1480.m07]                             |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::3DES [C0027.004]                                                |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Compress Data:: [C0024]                                                       |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Console:: [C0033]                                                             |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| clear the Windows event log                          | anti-analysis/anti-forensic/clear-logs               |
| contain obfuscated stackstrings (4 matches)          | anti-analysis/obfuscation/string/stackstring         |
| acquire credentials from Windows Credential Manager  | collection                                           |
| reference SQL statements (2 matches)                 | collection/database/sql                              |
| get domain trust relationships                       | collection/network                                   |
| check HTTP status code                               | communication/http/client                            |
| create pipe                                          | communication/named-pipe/create                      |
| listen for remote procedure calls (2 matches)        | communication/rpc/server                             |
| compress data via WinAPI                             | data-manipulation/compression                        |
| decode data using Base64 via WinAPI (2 matches)      | data-manipulation/encoding/base64                    |
| encode data using Base64 via WinAPI (2 matches)      | data-manipulation/encoding/base64                    |
| encode data using XOR (14 matches)                   | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext (20 matches)  | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt (13 matches)         | data-manipulation/encryption                         |
| get outbound credentials handle via CredSSP          | data-manipulation/encryption                         |
| encrypt data using DES via WinAPI (2 matches)        | data-manipulation/encryption/des                     |
| encrypt data using DPAPI (2 matches)                 | data-manipulation/encryption/dpapi                   |
| encrypt data using RC4 PRGA (5 matches)              | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 via WinAPI                    | data-manipulation/encryption/rc4                     |
| hash data via WinCrypt (4 matches)                   | data-manipulation/hashing                            |
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                    | data-manipulation/hashing/sha1                       |
| authenticate HMAC (2 matches)                        | data-manipulation/hmac                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments (2 matches)            | host-interaction/cli                                 |
| read clipboard data                                  | host-interaction/clipboard                           |
| manipulate console                                   | host-interaction/console                             |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path (4 matches)                     | host-interaction/file-system                         |
| delete file (2 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get file size                                        | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| read file on Windows (8 matches)                     | host-interaction/file-system/read                    |
| read file via mapping                                | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                    | host-interaction/file-system/write                   |
| set console window title                             | host-interaction/gui/console                         |
| get keyboard layout                                  | host-interaction/hardware/keyboard/layout            |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| enumerate network shares                             | host-interaction/network                             |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| get domain controller name                           | host-interaction/network/domain                      |
| get hostname (2 matches)                             | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| read process memory                                  | host-interaction/process                             |
| create process on Windows (5 matches)                | host-interaction/process/create                      |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (3 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| query service status                                 | host-interaction/service                             |
| run as service                                       | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| start service (2 matches)                            | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| get token membership                                 | host-interaction/session                             |
| get user security identifier (2 matches)             | host-interaction/session                             |
| create thread (5 matches)                            | host-interaction/thread/create                       |
| terminate thread (3 matches)                         | host-interaction/thread/terminate                    |
| link many functions at runtime                       | linking/runtime-linking                              |
| enumerate PE sections (6 matches)                    | load-code/pe                                         |
| parse PE exports (10 matches)                        | load-code/pe                                         |
| parse PE header (48 matches)                         | load-code/pe                                         |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Discovery::File and Directory Discovery [T1083;2]
8.5		- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
8		- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]
3		- Execution::System Services::Service Execution [T1569.002;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
9		- Impact::Service Stop [T1489;9]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5		- Collection::Data from Information Repositories [T1213;5]
6		- Collection::Clipboard Data [T1115;6]
3		- Discovery::System Network Configuration Discovery [T1016;3]
3		- Discovery::Account Discovery [T1087;3]
2		- Execution::Shared Modules [T1129;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
4		- Discovery::Domain Trust Discovery [T1482;4]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 97.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]', '8.5'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]', '8'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Collection::Data from Information Repositories [T1213;5]', '5'), ('- Collection::Clipboard Data [T1115;6]', '6'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Discovery::Domain Trust Discovery [T1482;4]', '4'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Dropper.ClipBanker-9778171-0', '30'), ('Win.Tool.Mimikatz-9862700-0', '10'), ('Win.Trojan.Mimikatz-6466236-0', '45')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('create_service', '45'), ('network_dns', '50'), ('cred_local', '80'), ('spreading_share', '70'), ('win_mutex', '60'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('hacktool_windows_mimikatz_copywrite', '50'), ('hacktool_windows_mimikatz_modules', '50'), ('Powerkatz_DLL_Generic', '80'), ('HackTool_Producers', '50'), ('mimikatz', '70'), ('Mimikatz_Strings', '65'), ('Mimikatz_Gen_Strings', '70'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('dll_injection_thread', '15'), ('Visual_Cpp_2005_Release_Microsoft', '70'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDigitalSignature', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('DLL_inject', '40'), ('Inject_Thread', '45'), ('Debugger_Check__QueryInfo', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('Check_OutputDebugStringA_iat_v1', '30'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('with_sqlite', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers0', '10'), ('Big_Numbers1', '10'), ('Big_Numbers3', '10'), ('Advapi_Hash_API', '20'), ('MD5_API', '25'), ('DES_Long', '15')]
-------------- LOKI_Score ------------
['1869']
-------------- CAPA_Score ------------
['100.0']
-------------- CLAMAV_Score ------------
['85.0']
-------------- SCORE FINAL ------------
32687.00268209213
============================================


==================================================================
Fichier HTTP-FZdEqJELPYx0uI949.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3ogMc1AISRAkTRZpa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 912400a90ca88e80abc6cb8f30c1bb41                                                   |
| sha1                   | bf32f1dd03d9dfea828109824928c7f13b23ca99                                           |
| sha256                 | a174de17639a2c544d8124895f878abaaa634fdc63bf49979b407fd7a20c28bf                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F3ogMc1AISRAkTRZpa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3ogMc1AISRAkTRZpa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 43.189 sec (0 m 43 s)
Start Date: 2022:02:07 12:42:27
End Date:   2022:02:07 12:43:10

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:42:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3ogMc1AISRAkTRZpa.exe SCORE: 269 TYPE: EXE SIZE: 21144 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb61e6a1fa0> 
MD5: 912400a90ca88e80abc6cb8f30c1bb41 
SHA1: bf32f1dd03d9dfea828109824928c7f13b23ca99 
SHA256: a174de17639a2c544d8124895f878abaaa634fdc63bf49979b407fd7a20c28bf CREATED: Mon Feb  7 12:42:27 2022 MODIFIED: Mon Feb  7 12:42:27 2022 ACCESSED: Mon Feb  7 12:43:17 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e80b0300004883c428e96efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:43:18Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 269

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['269']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4283.3153108700835
============================================


==================================================================
Fichier HTTP-F3ogMc1AISRAkTRZpa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fq8GG32X4uqVmck3f9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fq8GG32X4uqVmck3f9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 32.801 sec (0 m 32 s)
Start Date: 2022:02:07 12:43:18
End Date:   2022:02:07 12:43:51

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 57f0394e0c4082e04c9d635ea5e8fc98                                                   |
| sha1                   | df9779aaf47019ee0cb8b8fcbe6510a3d6b29bf5                                           |
| sha256                 | 8ef6e578c77caa6c47c512ba733b6532ac21d34f396632d8ff5ee7deca47846a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fq8GG32X4uqVmck3f9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
| CRYPTOGRAPHY                | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| OPERATING SYSTEM            | Registry::Query Registry Key [C0036.005]                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| encrypt data using DPAPI (4 matches)                 | data-manipulation/encryption/dpapi                   |
| generate random numbers via WinAPI (2 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query or enumerate registry key (4 matches)          | host-interaction/registry                            |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Discovery::Query Registry [T1012;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 11.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:43:18Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fq8GG32X4uqVmck3f9.exe SCORE: 134 TYPE: EXE SIZE: 76800 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5f9e00ffa0> 
MD5: 57f0394e0c4082e04c9d635ea5e8fc98 
SHA1: df9779aaf47019ee0cb8b8fcbe6510a3d6b29bf5 
SHA256: 8ef6e578c77caa6c47c512ba733b6532ac21d34f396632d8ff5ee7deca47846a CREATED: Mon Feb  7 12:43:18 2022 MODIFIED: Mon Feb  7 12:43:18 2022 ACCESSED: Mon Feb  7 12:44:00 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:44:01Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 134

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['134']
-------------- CAPA_Score ------------
['11.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2353.212044119313
============================================


==================================================================
Fichier HTTP-Fq8GG32X4uqVmck3f9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FBaTq02OdbL1fUpX78.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 61c85b1b2d5fe567546192ce83c0450b                                                   |
| sha1                   | 87e511c2ad9128e64e482b4a50473fcc1d464e4e                                           |
| sha256                 | e31535d614bcc97a14512386278f87c426ef4bf582abcf41ade75bf1acd0b437                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FBaTq02OdbL1fUpX78.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FBaTq02OdbL1fUpX78.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 38.367 sec (0 m 38 s)
Start Date: 2022:02:07 12:44:01
End Date:   2022:02:07 12:44:40

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:44:01Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FBaTq02OdbL1fUpX78.exe SCORE: 139 TYPE: EXE SIZE: 98640 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb5c61a5fa0> 
MD5: 61c85b1b2d5fe567546192ce83c0450b 
SHA1: 87e511c2ad9128e64e482b4a50473fcc1d464e4e 
SHA256: e31535d614bcc97a14512386278f87c426ef4bf582abcf41ade75bf1acd0b437 CREATED: Mon Feb  7 12:44:01 2022 MODIFIED: Mon Feb  7 12:44:01 2022 ACCESSED: Mon Feb  7 12:44:54 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:44:55Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 139

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['139']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2222.954160670636
============================================


==================================================================
Fichier HTTP-FBaTq02OdbL1fUpX78.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FRhClw37EyE4eIYXZ4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:44:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FRhClw37EyE4eIYXZ4.exe SCORE: 764 TYPE: EXE SIZE: 226808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f23e09effa0> 
MD5: a74ee8200aace7d19dee79871bbf2ed3 
SHA1: 7929ddb899baf5f1bfda9092c8edc0ef7cc4f647 
SHA256: 807424fa3c4e03471d4acc5d35fdd8923a3689f44599f23999879abf5a74dd85 CREATED: Mon Feb  7 12:44:55 2022 MODIFIED: Mon Feb  7 12:44:55 2022 ACCESSED: Mon Feb  7 12:45:35 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: CreateService Str3: ControlService Str4: StartService Str5: QueryServiceStatus
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 000000518b15b8c442008b45088b0d94c5420053565733f63bd08965f08975fc73473bc173458b0d00c542002bc23bc10f8fef0000003bc60f8ee70000008 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685000420068b6bc410064a10000000050 Str2: 558bec6aff686000420068b6bc410064a10000000050 Str3: 558bec6aff684801420068b6bc41006 ... (truncated)
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685000420068b6bc410064a10000000050 Str2: 558bec6aff686000420068b6bc410064a10000000050 Str3: 558bec6aff684801420068b6bc41006 ... (truncated)
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec51 Str3: 558bec8d Str4: 558bec83 Str5: 558bec6aff685000420068b6bc410064a10000000050 Str6: 558bec6aff686000420068 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685000420068b6bc410064a1000000005064892500000000 Str2: 558bec6aff686000420068b6bc410064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_16: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 88350000000202003082357806092a864886f70d010702a082356930823565020101310b300906052b0e03021a0500304c060a2b060104018237020104a03e303c301 ... (truncated)
REASON_17: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_18: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_19: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_21: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_22: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_23: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_24: Yara Rule MATCH: GenerateTLSClientHelloPacket_Test SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: Novetta Threat Research & Interdiction Group - trig@novetta.com 
MATCHES: Str1: 250700008079054883c8f840
REASON_25: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_26: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_27: Yara Rule MATCH: DES_sbox SUBSCORE: 15 
DESCRIPTION: DES [sbox] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:45:36Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_service
20		win_registry
10		Str_Win32_Winsock2_Library
10		misc_pe_signature
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDigitalSignature
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
40		SEH_Init
10		anti_dbg
60		GenerateTLSClientHelloPacket_Test
20		isExecutable
10		Contains_PE_File
15		DES_sbox

Score total: 764

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FRhClw37EyE4eIYXZ4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.22 MB
Data read: 0.21 MB (ratio 1.04:1)
Time: 45.779 sec (0 m 45 s)
Start Date: 2022:02:07 12:44:55
End Date:   2022:02:07 12:45:41

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a74ee8200aace7d19dee79871bbf2ed3                                                   |
| sha1                   | 7929ddb899baf5f1bfda9092c8edc0ef7cc4f647                                           |
| sha256                 | 807424fa3c4e03471d4acc5d35fdd8923a3689f44599f23999879abf5a74dd85                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FRhClw37EyE4eIYXZ4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Execution Guardrails::Runs as Service [E1480.m07]                             |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                 | anti-analysis/anti-debugging/debugger-detection      |
| contain obfuscated stackstrings (5 matches)           | anti-analysis/obfuscation/string/stackstring         |
| parse credit card information                         | collection/credit-card                               |
| check HTTP status code (4 matches)                    | communication/http/client                            |
| encode data using XOR                                 | data-manipulation/encoding/xor                       |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| accept command line arguments                         | host-interaction/cli                                 |
| get common file path (2 matches)                      | host-interaction/file-system                         |
| copy file                                             | host-interaction/file-system/copy                    |
| create directory                                      | host-interaction/file-system/create                  |
| get file size                                         | host-interaction/file-system/meta                    |
| read file on Windows                                  | host-interaction/file-system/read                    |
| enumerate gui resources (2 matches)                   | host-interaction/gui                                 |
| get number of processors                              | host-interaction/hardware/cpu                        |
| print debug messages                                  | host-interaction/log/debug/write-event               |
| get hostname                                          | host-interaction/os/hostname                         |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows                             | host-interaction/process/create                      |
| enumerate processes                                   | host-interaction/process/list                        |
| terminate process                                     | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)         | host-interaction/registry                            |
| query service status (2 matches)                      | host-interaction/service                             |
| run as service                                        | host-interaction/service                             |
| create service                                        | host-interaction/service/create                      |
| delete service                                        | host-interaction/service/delete                      |
| stop service (2 matches)                              | host-interaction/service/stop                        |
| create thread (4 matches)                             | host-interaction/thread/create                       |
| resume thread (2 matches)                             | host-interaction/thread/resume                       |
| terminate thread (7 matches)                          | host-interaction/thread/terminate                    |
| access PEB ldr_data (3 matches)                       | linking/runtime-linking                              |
| link function at runtime on Windows (7 matches)       | linking/runtime-linking                              |
| parse PE exports (2 matches)                          | load-code/pe                                         |
| parse PE header (4 matches)                           | load-code/pe                                         |
| persist via Windows service                           | persistence/service                                  |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
6		- Collection::Automated Collection [T1119;6]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
9		- Impact::Service Stop [T1489;9]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 73.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Collection::Automated Collection [T1119;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('create_service', '45'), ('win_registry', '20'), ('Str_Win32_Winsock2_Library', '10'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDigitalSignature', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('GenerateTLSClientHelloPacket_Test', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('DES_sbox', '15')]
-------------- LOKI_Score ------------
['764']
-------------- CAPA_Score ------------
['73.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
13575.101791905032
============================================


==================================================================
Fichier HTTP-FRhClw37EyE4eIYXZ4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCqX4W2xpeCJar5ZG9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 348059b0a770e1f95d3417107968a954                                                   |
| sha1                   | d6e48a1409e6d0b4d7fefe31028851a6e0e215ff                                           |
| sha256                 | 321a9e388a0e437325411998beaaecb9213823be935f1b37fab9d7cef8984c99                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FCqX4W2xpeCJar5ZG9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCqX4W2xpeCJar5ZG9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 45.361 sec (0 m 45 s)
Start Date: 2022:02:07 12:46:13
End Date:   2022:02:07 12:46:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:46:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FCqX4W2xpeCJar5ZG9.exe SCORE: 109 TYPE: EXE SIZE: 8192 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7231f92fa0> 
MD5: 348059b0a770e1f95d3417107968a954 
SHA1: d6e48a1409e6d0b4d7fefe31028851a6e0e215ff 
SHA256: 321a9e388a0e437325411998beaaecb9213823be935f1b37fab9d7cef8984c99 CREATED: Mon Feb  7 12:46:13 2022 MODIFIED: Mon Feb  7 12:46:13 2022 ACCESSED: Mon Feb  7 12:47:07 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_3 SUBSCORE: 2 
DESCRIPTION: Low entropy - very sparse data or repeating plaintext REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:47:07Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_3
5		executable_pe
10		IsPE32
10		IsDLL
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_3', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('ImportTableIsBad', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['109']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1747.4862029323024
============================================


==================================================================
Fichier HTTP-FCqX4W2xpeCJar5ZG9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FqhcITonuP2zfJlG5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 73e4bcfce5e484f9e4ddb7f9c0e471f9                                                   |
| sha1                   | 4265c4744a852fc42fe4798d38e9dad9c239f383                                           |
| sha256                 | bb104769a2845ee2c5cac9cc89cdc0e853ee00dde202f14330954baef4cf5dee                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FqhcITonuP2zfJlG5.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| create thread                                        | host-interaction/thread/create                       |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FqhcITonuP2zfJlG5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 45.071 sec (0 m 45 s)
Start Date: 2022:02:07 12:47:07
End Date:   2022:02:07 12:47:52

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:47:07Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FqhcITonuP2zfJlG5.exe SCORE: 229 TYPE: EXE SIZE: 27136 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f692b794fa0> 
MD5: 73e4bcfce5e484f9e4ddb7f9c0e471f9 
SHA1: 4265c4744a852fc42fe4798d38e9dad9c239f383 
SHA256: bb104769a2845ee2c5cac9cc89cdc0e853ee00dde202f14330954baef4cf5dee CREATED: Mon Feb  7 12:47:07 2022 MODIFIED: Mon Feb  7 12:47:07 2022 ACCESSED: Mon Feb  7 12:47:54 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e89b0200004883c428e97efdffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:47:54Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['7.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3769.073772783771
============================================


==================================================================
Fichier HTTP-FqhcITonuP2zfJlG5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fqmtta2I8bOOOPAYUl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b766cc43d649d30e9f27aff8f7ee7de0                                                   |
| sha1                   | c1e170856c4887c056dee663bfda189fe7a094c9                                           |
| sha256                 | e15d509ae7b77989f885edb22b6c9cccec3f6a4c4805936756af7a01f2388b03                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fqmtta2I8bOOOPAYUl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::Clear Windows Event Logs \[T1070.001]\                  |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | System Shutdown/Reboot:: \[T1529]\                                                 |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection:: [B0009]                                           |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| HARDWARE                    | Simulate Hardware::Ctrl-Alt-Del [C0057.001]                                   |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| clear the Windows event log                          | anti-analysis/anti-forensic/clear-logs               |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings (3 matches)          | anti-analysis/obfuscation/string/stackstring         |
| receive and write data from server to client         | c2/file-transfer                                     |
| send data (2 matches)                                | communication                                        |
| creates tcp or udp socket                            | communication/socket                                 |
| get socket information                               | communication/socket                                 |
| get socket status                                    | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration (2 matches)                 | communication/socket                                 |
| act as TCP client                                    | communication/tcp/client                             |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| get common file path (5 matches)                     | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| get file size                                        | host-interaction/file-system/meta                    |
| move file (2 matches)                                | host-interaction/file-system/move                    |
| read .ini file                                       | host-interaction/file-system/read                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| get CPU information                                  | host-interaction/hardware/cpu                        |
| simulate CTRL ALT DEL                                | host-interaction/hardware/keyboard                   |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| get local IPv4 addresses                             | host-interaction/network/address                     |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| shutdown system                                      | host-interaction/os                                  |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| create process on Windows (4 matches)                | host-interaction/process/create                      |
| enumerate processes (3 matches)                      | host-interaction/process/list                        |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| get session information                              | host-interaction/session                             |
| get session user name                                | host-interaction/session                             |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| link function at runtime on Windows (6 matches)      | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Discovery::File and Directory Discovery [T1083;2]
8.5		- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
3		- Discovery::System Owner/User Discovery [T1033;3]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::System Network Configuration Discovery [T1016;3]
3		- Discovery::Account Discovery [T1087;3]
2		- Execution::Shared Modules [T1129;2]
9		- Impact::System Shutdown/Reboot [T1529;9]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 90.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:47:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fqmtta2I8bOOOPAYUl.exe SCORE: 754 TYPE: EXE SIZE: 40960 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd5839a1fa0> 
MD5: b766cc43d649d30e9f27aff8f7ee7de0 
SHA1: c1e170856c4887c056dee663bfda189fe7a094c9 
SHA256: e15d509ae7b77989f885edb22b6c9cccec3f6a4c4805936756af7a01f2388b03 CREATED: Mon Feb  7 12:47:55 2022 MODIFIED: Mon Feb  7 12:47:55 2022 ACCESSED: Mon Feb  7 12:48:31 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: kernel32.dll Str3: GetPrivateProfileStringA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: kernel32.dll Str3: WriteFile Str4: ReadFile Str5: CreateFileA Str6: MoveFileExA
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetOpen
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645e048c645e165c645e261c645 Str2: c645e165c645e261c645e370c645 Str3: c645e261c645e370c645e446c645 Str4: c645e370c645e446c645e572c645 ... (truncated)
REASON_12: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_13: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68e0724000682064400064a100000000506489250000000083ec68535657
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68a8724000682064400064a10000000050 Str2: 558bec6aff68b8724000682064400064a10000000050 Str3: 558bec6aff68c872400068206440006 ... (truncated)
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68a8724000682064400064a10000000050 Str2: 558bec6aff68b8724000682064400064a10000000050 Str3: 558bec6aff68c872400068206440006 ... (truncated)
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83 Str2: 558bec51 Str3: 558bec81 Str4: 558bece8 Str5: 558bec68 Str6: 558bec6a Str7: 558becb8 Str8: 558bec6aff68a872400068206440 ... (truncated)
REASON_17: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68a8724000682064400064a1000000005064892500000000 Str2: 558bec6aff68b8724000682064400064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_21: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System
REASON_23: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_24: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_25: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_26: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_27: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:48:31Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		win_private_profile
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_4
5		obfuscation_singlebyte_mov
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		Anti_Automated_Sandbox
40		SEH_Init
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 754

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fqmtta2I8bOOOPAYUl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 44.426 sec (0 m 44 s)
Start Date: 2022:02:07 12:47:55
End Date:   2022:02:07 12:48:39

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]', '8.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::System Shutdown/Reboot [T1529;9]', '9'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '65'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['754']
-------------- CAPA_Score ------------
['90.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
13745.830754628785
============================================


==================================================================
Fichier HTTP-Fqmtta2I8bOOOPAYUl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FuIGEK2xNqqp8yZXy.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be an installer.
WARNING:capa: 
WARNING:capa: capa cannot handle installers well. This means the results may be misleading or incomplete.
WARNING:capa: You should try to understand the install mechanism and analyze created files with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) installer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:48:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FuIGEK2xNqqp8yZXy.exe SCORE: 1799 TYPE: EXE SIZE: 782044 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f75f39effa0> 
MD5: 4f11bdb380dafa2518053c6d20147a05 
SHA1: 0de61c550a355e78874703f6f0aaf5d6f79f5eb6 
SHA256: 9a9012840295bc2c62fd9cbe3d3dda692f43536861a40464f4e073d22bff179f CREATED: Mon Feb  7 12:48:39 2022 MODIFIED: Mon Feb  7 12:48:39 2022 ACCESSED: Mon Feb  7 12:49:32 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_5: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: GetPrivateProfileStringA Str3: WritePrivateProfileStringA
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: MoveF ... (truncated)
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: Nullsoft_PiMP_Stub_SFX SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 81ec80010000535556
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_34: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_35: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_36: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_37: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_38: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_39: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:49:33Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
65		screenshot
20		win_registry
65		win_token
10		win_private_profile
10		win_files_operation
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		Nullsoft_PiMP_Stub_SFX
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant

Score total: 1799

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FuIGEK2xNqqp8yZXy.exe: Win.Trojan.Agent-1879100 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FuIGEK2xNqqp8yZXy.exe: Win.Trojan.Agent-1879100 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 5.69 MB
Data read: 0.74 MB (ratio 7.66:1)
Time: 86.777 sec (1 m 26 s)
Start Date: 2022:02:07 12:48:39
End Date:   2022:02:07 12:50:06

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('screenshot', '65'), ('win_registry', '20'), ('win_token', '65'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('Nullsoft_PiMP_Stub_SFX', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['1799']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
28512.22853237543
============================================


==================================================================
Fichier HTTP-FuIGEK2xNqqp8yZXy.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FpB5YF40BNoVmcOMFa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | d922a26d46a2e2194be6c3af1548d0e9                                                   |
| sha1                   | d0afd35a719dc0efc018f2609144297473d711d3                                           |
| sha256                 | 4363b665cb1b4b724716d7e287fe770d8c38c76aa78fa0d1cbcd1c9bc1c2b02c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FpB5YF40BNoVmcOMFa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encrypt or decrypt data via BCrypt                   | data-manipulation/encryption                         |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check if file exists                                 | host-interaction/file-system/exists                  |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| link function at runtime on Windows (4 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]

Score total: 8.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:50:06Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FpB5YF40BNoVmcOMFa.exe SCORE: 309 TYPE: EXE SIZE: 102400 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6b3e42dfa0> 
MD5: d922a26d46a2e2194be6c3af1548d0e9 
SHA1: d0afd35a719dc0efc018f2609144297473d711d3 
SHA256: 4363b665cb1b4b724716d7e287fe770d8c38c76aa78fa0d1cbcd1c9bc1c2b02c CREATED: Mon Feb  7 12:50:06 2022 MODIFIED: Mon Feb  7 12:50:06 2022 ACCESSED: Mon Feb  7 12:50:44 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8cf0800004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Big_Numbers2 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 48:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 010203040506070801020304050607080102030405060708
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:50:45Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers2

Score total: 309

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FpB5YF40BNoVmcOMFa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 40.672 sec (0 m 40 s)
Start Date: 2022:02:07 12:50:06
End Date:   2022:02:07 12:50:47

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers2', '10')]
-------------- LOKI_Score ------------
['309']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5056.94094990235
============================================


==================================================================
Fichier HTTP-FpB5YF40BNoVmcOMFa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F463wp3yh0bVNXzVZ2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F463wp3yh0bVNXzVZ2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.47 MB
Data read: 0.45 MB (ratio 1.05:1)
Time: 40.734 sec (0 m 40 s)
Start Date: 2022:02:07 12:50:47
End Date:   2022:02:07 12:51:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:50:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F463wp3yh0bVNXzVZ2.exe SCORE: 434 TYPE: EXE SIZE: 468992 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f392c799fa0> 
MD5: 866989aa656cf67780143376c12df510 
SHA1: 3bacae009425ab65c13b236469caf11e8d30f2dd 
SHA256: 47a44a548c462510301785b3d849e7fa731b911fa0b174574876a1367c88cbd2 CREATED: Mon Feb  7 12:50:47 2022 MODIFIED: Mon Feb  7 12:50:47 2022 ACCESSED: Mon Feb  7 12:51:38 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_3: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_4: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetOpen
REASON_5: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_11: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_17: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: CallNextHookEx
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:51:39Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_5
5		executable_pe
15		dll_injection_hook
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
35		Win_Hook_v12
10		anti_dbg
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 434

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 866989aa656cf67780143376c12df510                                                   |
| sha1                   | 3bacae009425ab65c13b236469caf11e8d30f2dd                                           |
| sha256                 | 47a44a548c462510301785b3d849e7fa731b911fa0b174574876a1367c88cbd2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F463wp3yh0bVNXzVZ2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via polling                           | collection/keylog                                    |
| initialize WinHTTP library                           | communication/http                                   |
| read HTTP header                                     | communication/http                                   |
| set HTTP header                                      | communication/http                                   |
| create HTTP request                                  | communication/http/client                            |
| prepare HTTP request                                 | communication/http/client                            |
| receive HTTP response (2 matches)                    | communication/http/client                            |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (4 matches)                    | data-manipulation/encoding/xor                       |
| hash data via BCrypt                                 | data-manipulation/hashing                            |
| hash data using fnv (4 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set application hook (4 matches)                     | host-interaction/gui                                 |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| get session user name                                | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| parse PE header (7 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::Account Discovery [T1087;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 30.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Account Discovery [T1087;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('dll_injection_hook', '15'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Win_Hook_v12', '35'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['434']
-------------- CAPA_Score ------------
['30.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
7486.99146134674
============================================


==================================================================
Fichier HTTP-F463wp3yh0bVNXzVZ2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FozP1w2R5F24HNJAvd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 013710ab6de262c6e342571f1798d8c2                                                   |
| sha1                   | a798ad46810e0799d36e20a84ae2564200fcb32d                                           |
| sha256                 | ca68eff48f1e5b6158cd0f45571805717a8364a3d34ed469f4c9e76cfe88fada                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FozP1w2R5F24HNJAvd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FozP1w2R5F24HNJAvd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 0.00:1)
Time: 43.365 sec (0 m 43 s)
Start Date: 2022:02:07 12:52:15
End Date:   2022:02:07 12:52:58

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:52:15Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FozP1w2R5F24HNJAvd.exe SCORE: 109 TYPE: EXE SIZE: 2560 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5903c66fa0> 
MD5: 013710ab6de262c6e342571f1798d8c2 
SHA1: a798ad46810e0799d36e20a84ae2564200fcb32d 
SHA256: ca68eff48f1e5b6158cd0f45571805717a8364a3d34ed469f4c9e76cfe88fada CREATED: Mon Feb  7 12:52:15 2022 MODIFIED: Mon Feb  7 12:52:15 2022 ACCESSED: Mon Feb  7 12:53:01 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_2 SUBSCORE: 2 
DESCRIPTION: Very low entropy - repeating sequence of couple of bytes REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:53:01Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_2
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_2', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('ImportTableIsBad', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['109']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1747.4862029323024
============================================


==================================================================
Fichier HTTP-FozP1w2R5F24HNJAvd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXrKIZ1edEUtxC5Cp8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXrKIZ1edEUtxC5Cp8.exe: Win.Malware.Facido-9768987-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.81 MB
Data read: 0.77 MB (ratio 1.06:1)
Time: 45.573 sec (0 m 45 s)
Start Date: 2022:02:07 12:53:02
End Date:   2022:02:07 12:53:47

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Facido-9768987-0

Score total: 50.0

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 29: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 26: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 25: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 24: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 64: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 33: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 32: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 26: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 25: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 24: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 25: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfa in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfa in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfa in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 55: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 47: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:53:02Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXrKIZ1edEUtxC5Cp8.exe SCORE: 894 TYPE: EXE SIZE: 805888 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff41fc6dfa0> 
MD5: c3d495bb065e8f3690efc50c70fc8c67 
SHA1: aebe79d986bedaa5ba4e2f5c7402fd759dff50cf 
SHA256: bc452cc1128ccf7fa9f76d83cda79132740414973600fed14509749fe946816e CREATED: Mon Feb  7 12:53:02 2022 MODIFIED: Mon Feb  7 12:53:02 2022 ACCESSED: Mon Feb  7 12:53:54 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: Typical_Malware_String_Transforms SUBSCORE: 60 
DESCRIPTION: Detects typical strings in a reversed or otherwise modified form REF: Internal Research AUTHOR: Florian Roth 
MATCHES: Str1: exe.23lldnur Str2: paeHssecorPteG Str3: sserddAcorPteG
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e817060000e976ffffff Str2: e814f1ffffe960ffffff Str3: e8c07d0000e97ffeffff Str4: e83267ffffe9f3feffff Str5: e80241ffffe971ffffff Str6 ... (truncated)
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_17: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: ? Str2: 45c70001
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_20: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ? Str2: 45c70001
REASON_21: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: avgui.exe Str2: AvastSvc.exe
REASON_22: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_23: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_24: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ? Str2: 45c70001
REASON_25: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_26: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_27: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_28: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 5f96de8e69f003326a5e73ab7da5f5c1 Str2: F5AACA05FCFBBAFDAACDDBDABDBBFCCD
REASON_29: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:53:56Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		ft_exe
60		Typical_Malware_String_Transforms
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
35		Anti_Automated_Sandbox
60		antivm_vmware
60		vmdetect_2
50		Antivirus_strings
40		SEH_Save
40		SEH_Init
60		vmdetect
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
20		MD5_Constants

Score total: 894

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Facido-9768987-0', '50')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '10'), ('Typical_Malware_String_Transforms', '60'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '35'), ('antivm_vmware', '60'), ('vmdetect_2', '60'), ('Antivirus_strings', '50'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('vmdetect', '60'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10'), ('MD5_Constants', '20')]
-------------- LOKI_Score ------------
['894']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
14798.407846499436
============================================


==================================================================
Fichier HTTP-FXrKIZ1edEUtxC5Cp8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FhBqXBNW3pZiIkpIj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2666097ee8cb3d4fd7b02eb8901246a5                                                   |
| sha1                   | bfdd9101a1941b7eee511681e1793541ef80008f                                           |
| sha256                 | ddc1193d3545b1d93500c48b063dfd133273dea82a175207fb761360c1fe290f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FhBqXBNW3pZiIkpIj.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
2		- Execution::Shared Modules [T1129;2]

Score total: 6.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FhBqXBNW3pZiIkpIj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.19 MB
Data read: 0.18 MB (ratio 1.04:1)
Time: 43.370 sec (0 m 43 s)
Start Date: 2022:02:07 12:53:57
End Date:   2022:02:07 12:54:40

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:53:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FhBqXBNW3pZiIkpIj.exe SCORE: 159 TYPE: EXE SIZE: 189440 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2750291fa0> 
MD5: 2666097ee8cb3d4fd7b02eb8901246a5 
SHA1: bfdd9101a1941b7eee511681e1793541ef80008f 
SHA256: ddc1193d3545b1d93500c48b063dfd133273dea82a175207fb761360c1fe290f CREATED: Mon Feb  7 12:53:57 2022 MODIFIED: Mon Feb  7 12:53:57 2022 ACCESSED: Mon Feb  7 12:54:48 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:54:49Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['159']
-------------- CAPA_Score ------------
['6.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2639.6959149113027
============================================


==================================================================
Fichier HTTP-FhBqXBNW3pZiIkpIj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fm1eWC4I0JGFK5hVAg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4bdd67ff852c221112337fecd0681eac                                                   |
| sha1                   | 4610093687b0f2c42fe80adca217988c8947a546                                           |
| sha256                 | d33d69b454efba519bffd3ba63c99ffce058e3105745f8a7ae699f72db1e70eb                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fm1eWC4I0JGFK5hVAg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| compiled with Borland Delphi                         | compiler/delphi                                      |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| accept command line arguments                        | host-interaction/cli                                 |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory (2 matches)                      | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]

Score total: 12.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fm1eWC4I0JGFK5hVAg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 42.262 sec (0 m 42 s)
Start Date: 2022:02:07 12:54:49
End Date:   2022:02:07 12:55:31

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:54:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fm1eWC4I0JGFK5hVAg.exe SCORE: 100 TYPE: EXE SIZE: 93184 
FIRST_BYTES: 4d5a50000200000004000f00ffff0000b8000000 / <filter object at 0x7f9aa3863fa0> 
MD5: 4bdd67ff852c221112337fecd0681eac 
SHA1: 4610093687b0f2c42fe80adca217988c8947a546 
SHA256: d33d69b454efba519bffd3ba63c99ffce058e3105745f8a7ae699f72db1e70eb CREATED: Mon Feb  7 12:54:49 2022 MODIFIED: Mon Feb  7 12:54:49 2022 ACCESSED: Mon Feb  7 12:55:42 2022 
REASON_1: Malware Hash TYPE: MD5 HASH: 4bdd67ff852c221112337fecd0681eac SUBSCORE: 100 DESC: SUCEFUL: Next Generation ATM Malware https://www.fireeye.com/blog/threat-research/2015/09/suceful_next_genera.html
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:55:42Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash

Score total: 100

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]', '5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100')]
-------------- LOKI_Score ------------
['100']
-------------- CAPA_Score ------------
['12.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1824.324670257379
============================================


==================================================================
Fichier HTTP-Fm1eWC4I0JGFK5hVAg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FxQ7ZF3iWKdAm5GBN3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 70f7d4806f949550ba5ac0afec9c042f                                                   |
| sha1                   | b7a53f5f90a5b78e8663e7372dfa61517d57d72d                                           |
| sha256                 | 6e118b779673183850a0acb474efa30bc4e91d47925aee5311364112d660e4ee                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FxQ7ZF3iWKdAm5GBN3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create thread                                        | host-interaction/thread/create                       |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::Query Registry [T1012;1]

Score total: 10.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FxQ7ZF3iWKdAm5GBN3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 45.089 sec (0 m 45 s)
Start Date: 2022:02:07 12:55:43
End Date:   2022:02:07 12:56:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:55:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FxQ7ZF3iWKdAm5GBN3.exe SCORE: 354 TYPE: EXE SIZE: 78336 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd58212efa0> 
MD5: 70f7d4806f949550ba5ac0afec9c042f 
SHA1: b7a53f5f90a5b78e8663e7372dfa61517d57d72d 
SHA256: 6e118b779673183850a0acb474efa30bc4e91d47925aee5311364112d660e4ee CREATED: Mon Feb  7 12:55:43 2022 MODIFIED: Mon Feb  7 12:55:43 2022 ACCESSED: Mon Feb  7 12:56:35 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: Advapi32.dll Str2: ADVAPI32.dll Str3: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:56:35Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 354

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['354']
-------------- CAPA_Score ------------
['10.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5820.024444384074
============================================


==================================================================
Fichier HTTP-FxQ7ZF3iWKdAm5GBN3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDgCey4LA6lv1kI0D6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a0dea5c1f4ad089439054c8c0ae8c8ea                                                   |
| sha1                   | 5f7f1fb7dc8822573ba9130fc5395ea8d94d0258                                           |
| sha256                 | 192e53a11e563333ea528dd2682bf97690f7d9b4b15dfb8fd111a39980a513ec                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FDgCey4LA6lv1kI0D6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDgCey4LA6lv1kI0D6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 43.008 sec (0 m 43 s)
Start Date: 2022:02:07 12:56:36
End Date:   2022:02:07 12:57:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:56:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FDgCey4LA6lv1kI0D6.exe SCORE: 99 TYPE: EXE SIZE: 67584 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8cde152fa0> 
MD5: a0dea5c1f4ad089439054c8c0ae8c8ea 
SHA1: 5f7f1fb7dc8822573ba9130fc5395ea8d94d0258 
SHA256: 192e53a11e563333ea528dd2682bf97690f7d9b4b15dfb8fd111a39980a513ec CREATED: Mon Feb  7 12:56:36 2022 MODIFIED: Mon Feb  7 12:56:36 2022 ACCESSED: Mon Feb  7 12:57:26 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:57:26Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 99

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['99']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1628.9021299855685
============================================


==================================================================
Fichier HTTP-FDgCey4LA6lv1kI0D6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FVDU0p1Rp2gOGkzca.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FVDU0p1Rp2gOGkzca.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.33 MB
Data read: 0.31 MB (ratio 1.05:1)
Time: 45.557 sec (0 m 45 s)
Start Date: 2022:02:07 12:57:27
End Date:   2022:02:07 12:58:12

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:57:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FVDU0p1Rp2gOGkzca.exe SCORE: 379 TYPE: EXE SIZE: 329728 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fee8a1c4fa0> 
MD5: f2aa55885a2c014da99f1355f3f71e4a 
SHA1: f5671266fbf3ffbc32caa2c1effa1768893d0173 
SHA256: 508e5f70c29502d7ba66a35959a327e3d658514496ee7b9155d95e7409eb4fb8 CREATED: Mon Feb  7 12:57:27 2022 MODIFIED: Mon Feb  7 12:57:27 2022 ACCESSED: Mon Feb  7 12:58:15 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: rshell.exe
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:58:16Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
50		Antivirus_strings
20		isExecutable
10		Contains_PE_File

Score total: 379

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f2aa55885a2c014da99f1355f3f71e4a                                                   |
| sha1                   | f5671266fbf3ffbc32caa2c1effa1768893d0173                                           |
| sha256                 | 508e5f70c29502d7ba66a35959a327e3d658514496ee7b9155d95e7409eb4fb8                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FVDU0p1Rp2gOGkzca.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| interact with driver via control codes (3 matches)   | host-interaction/driver                              |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path (4 matches)                     | host-interaction/file-system                         |
| create directory                                     | host-interaction/file-system/create                  |
| delete directory                                     | host-interaction/file-system/delete                  |
| delete file (2 matches)                              | host-interaction/file-system/delete                  |
| check if file exists (3 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (5 matches)                      | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| enumerate disk volumes                               | host-interaction/hardware/storage                    |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| get disk size (2 matches)                            | host-interaction/hardware/storage                    |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| create process on Windows                            | host-interaction/process/create                      |
| create or open registry key (5 matches)              | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| query service status (2 matches)                     | host-interaction/service                             |
| start service                                        | host-interaction/service/start                       |
| get token membership                                 | host-interaction/session                             |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 30.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('Antivirus_strings', '50'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['379']
-------------- CAPA_Score ------------
['30.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6615.3002054931285
============================================


==================================================================
Fichier HTTP-FVDU0p1Rp2gOGkzca.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FPkEFr3nUie3usFTDf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2116190ae866163ed485c4fd3e13d03b                                                   |
| sha1                   | 664654a40696f13dc8e23bd2df32ba55a6e0da20                                           |
| sha256                 | 608af8aef15ba4f75996d46249a428ebbff1551de06f6eb6a053c2c330da6965                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FPkEFr3nUie3usFTDf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| get geographical location                            | collection                                           |
| check HTTP status code                               | communication/http/client                            |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (3 matches)   | host-interaction/driver                              |
| get system information on Windows (3 matches)        | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key (2 matches)          | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry value (3 matches)                    | host-interaction/registry/delete                     |
| get kernel32 base address (6 matches)                | linking/runtime-linking                              |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
1.5		- Discovery::System Location Discovery [T1614;1.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 25.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FPkEFr3nUie3usFTDf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 44.373 sec (0 m 44 s)
Start Date: 2022:02:07 12:58:45
End Date:   2022:02:07 12:59:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:58:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FPkEFr3nUie3usFTDf.exe SCORE: 304 TYPE: EXE SIZE: 177976 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3c12137fa0> 
MD5: 2116190ae866163ed485c4fd3e13d03b 
SHA1: 664654a40696f13dc8e23bd2df32ba55a6e0da20 
SHA256: 608af8aef15ba4f75996d46249a428ebbff1551de06f6eb6a053c2c330da6965 CREATED: Mon Feb  7 12:58:45 2022 MODIFIED: Mon Feb  7 12:58:45 2022 ACCESSED: Mon Feb  7 12:59:38 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e83b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T11:59:39Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 304

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['304']
-------------- CAPA_Score ------------
['25.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5316.890883824005
============================================


==================================================================
Fichier HTTP-FPkEFr3nUie3usFTDf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FRw8hPzO5a1tQoEc4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a7f21e412022554d187d6a876a3c08ac                                                   |
| sha1                   | 70e39bdfcaa4bcf0021311e8298266e527cf7c97                                           |
| sha256                 | 9b683d2fda7ca7adcc043e4412271009a0e115ca55f9a718c385a3f46b57ae6b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FRw8hPzO5a1tQoEc4.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via application hook                  | collection/keylog                                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4		- Discovery::Application Window Discovery [T1010;4]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 16.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FRw8hPzO5a1tQoEc4.exe: Win.Keylogger.Generic-9937589-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 44.808 sec (0 m 44 s)
Start Date: 2022:02:07 12:59:40
End Date:   2022:02:07 13:00:24

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Keylogger.Generic-9937589-0

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 54: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xaa in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 54: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe1 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 8: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbf in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 3-4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 26: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8e in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd7 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfb in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb0 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf4 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdf in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 9: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdc in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8e in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T11:59:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FRw8hPzO5a1tQoEc4.exe SCORE: 704 TYPE: EXE SIZE: 24576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f21d61cffa0> 
MD5: a7f21e412022554d187d6a876a3c08ac 
SHA1: 70e39bdfcaa4bcf0021311e8298266e527cf7c97 
SHA256: 9b683d2fda7ca7adcc043e4412271009a0e115ca55f9a718c385a3f46b57ae6b CREATED: Mon Feb  7 12:59:40 2022 MODIFIED: Mon Feb  7 12:59:40 2022 ACCESSED: Mon Feb  7 13:00:33 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68c8404000681c22400064a100000000506489250000000083ec105356578965e8ff153c40400033d28ad48915745b40008bc881e1ff0000008 ... (truncated)
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c8404000681c22400064a10000000050 Str2: 558bec6aff6808444000681c22400064a10000000050 Str3: 558bec6aff6820444000681c2240006 ... (truncated)
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c8404000681c22400064a10000000050 Str2: 558bec6aff6808444000681c22400064a10000000050 Str3: 558bec6aff6820444000681c2240006 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83 Str2: 558bec6a Str3: 558bec53 Str4: 558bec51 Str5: 558bec8b Str6: 558bec81 Str7: 558bec57 Str8: 558bec6aff68c8404000681c2240 ... (truncated)
REASON_10: Yara Rule MATCH: Armadillo_v4x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000558b Str2: 0000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c8404000681c22400064a1000000005064892500000000 Str2: 558bec6aff6808444000681c22400064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.dll Str3: UnhookWindowsHookEx Str4: SetWindowsHookExA Str5: CallNextHookEx
REASON_17: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: DarkComet_Keylogs_Memory SUBSCORE: 65 
DESCRIPTION: not set REF: http://www.tekdefense.com/news/2013/12/23/analyzing-darkcomet-in-memory.html AUTHOR: - 
MATCHES: Str1: [DEL]
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:00:34Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_4
5		executable_pe
15		dll_injection_hook
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Armadillo_v4x
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsConsole
10		HasRichSignature
2		PE_File
35		Win_Hook_v12
40		SEH_Save
40		SEH_Init
20		isExecutable
65		DarkComet_Keylogs_Memory
10		Contains_PE_File

Score total: 704

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('Win.Keylogger.Generic-9937589-0', '45')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('dll_injection_hook', '15'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Win_Hook_v12', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('DarkComet_Keylogs_Memory', '65'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['704']
-------------- CAPA_Score ------------
['16.0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
12043.406480628633
============================================


==================================================================
Fichier HTTP-FRw8hPzO5a1tQoEc4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FoXSAk4dpBJOm1mIP2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FoXSAk4dpBJOm1mIP2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.66 MB
Data read: 0.62 MB (ratio 1.06:1)
Time: 46.923 sec (0 m 46 s)
Start Date: 2022:02:07 13:00:34
End Date:   2022:02:07 13:01:21

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 26: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 21: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 26: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 21: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 45: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:00:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FoXSAk4dpBJOm1mIP2.exe SCORE: 644 TYPE: EXE SIZE: 650752 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f11eaa4bfa0> 
MD5: a563c50c5fa0fd541248acaf72cc4e7d 
SHA1: 4b8c12b074e20a796071aa50dc82fe2ff755e8f6 
SHA256: 180f82bbedb03dc29328e32e054069870a1e65078b78b2120a84c96aaed7d843 CREATED: Mon Feb  7 13:00:34 2022 MODIFIED: Mon Feb  7 13:00:34 2022 ACCESSED: Mon Feb  7 13:01:28 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: user32.dll Str3: USER32.DLL Str4: USER32.dll Str5: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: GetKeyState
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_4: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WritePrivateProfileStringA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: CreateFileA Str7: FindFirstFileA Str8: Find ... (truncated)
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8efdeffffe958ffffff Str2: e8c6600000e95dfdffff Str3: e8ac600000e96dfeffff Str4: e856740000e978feffff Str5: e881ecffffe9ddffffff Str6 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_18: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: UnhookWindowsHookEx Str5: SetWindowsHookExA Str6: CallNextHookEx
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_22: Yara Rule MATCH: IceID_Bank_trojan SUBSCORE: 60 
DESCRIPTION: Detects IcedID..adjusted several times REF: - AUTHOR: unixfreaxjp 
MATCHES: Str1: MZ Str2: e856740000e978feffff6a0c68586b Str3: CCmdTarget Str4: CUserException Str5: FlsGetValue Str6: AVCShellWrapper@@ Str7: AVCCmdT ... (truncated)
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:01:30Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
10		win_private_profile
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_hook
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
35		Win_Hook_v12
40		SEH_Save
40		SEH_Init
10		anti_dbg
60		IceID_Bank_trojan
20		isExecutable
10		Contains_PE_File

Score total: 644

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('dll_injection_hook', '15'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Win_Hook_v12', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('IceID_Bank_trojan', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['644']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
10206.71215944957
============================================


==================================================================
Fichier HTTP-FoXSAk4dpBJOm1mIP2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCu86A2AElj4KBoFW5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCu86A2AElj4KBoFW5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.68 MB
Data read: 0.64 MB (ratio 1.06:1)
Time: 45.408 sec (0 m 45 s)
Start Date: 2022:02:07 13:01:46
End Date:   2022:02:07 13:02:31

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:01:46Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FCu86A2AElj4KBoFW5.exe SCORE: 259 TYPE: EXE SIZE: 673184 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f535e0d9fa0> 
MD5: f64a684e29e8e117c8b3b1087594a673 
SHA1: b5fabc9d29c542da40b351347a3226cb1e65bb5d 
SHA256: 126ab3b346252be7227fbdc67f9fdc5f66d698df771deb1a1fda6f6b1afe810a CREATED: Mon Feb  7 13:01:46 2022 MODIFIED: Mon Feb  7 13:01:46 2022 ACCESSED: Mon Feb  7 13:02:32 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Debugger_Hiding__Thread SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetInformationThread
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_18: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:02:33Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_close_8
5		executable_pe
10		IsPE64
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		Debugger_Hiding__Thread
20		isExecutable
10		Contains_PE_File
20		SHA2_BLAKE2_IVs
5		BASE64_table

Score total: 259

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f64a684e29e8e117c8b3b1087594a673                                                   |
| sha1                   | b5fabc9d29c542da40b351347a3226cb1e65bb5d                                           |
| sha256                 | 126ab3b346252be7227fbdc67f9fdc5f66d698df771deb1a1fda6f6b1afe810a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FCu86A2AElj4KBoFW5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| CRYPTOGRAPHY                | Cryptographic Hash::SHA256 [C0029.003]                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (161 matches)           | anti-analysis/anti-vm/vm-detection                   |
| encode data using Base64 (2 matches)                 | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (21 matches)                   | data-manipulation/encoding/xor                       |
| hash data using murmur3 (2 matches)                  | data-manipulation/hashing/murmur                     |
| hash data using SHA256                               | data-manipulation/hashing/sha256                     |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes               | host-interaction/driver                              |
| get system information on Windows                    | host-interaction/os/info                             |
| create or open registry key                          | host-interaction/registry                            |
| query or enumerate registry value                    | host-interaction/registry                            |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 20.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Debugger_Hiding__Thread', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('SHA2_BLAKE2_IVs', '20'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['259']
-------------- CAPA_Score ------------
['20.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4503.92583146806
============================================


==================================================================
Fichier HTTP-FCu86A2AElj4KBoFW5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FTeJ145aCCPJ6JdNk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FTeJ145aCCPJ6JdNk.exe: Win.Trojan.Helminth-3 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.30 MB
Data read: 0.29 MB (ratio 1.05:1)
Time: 46.888 sec (0 m 46 s)
Start Date: 2022:02:07 13:02:59
End Date:   2022:02:07 13:03:45

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Helminth-3

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:02:59Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FTeJ145aCCPJ6JdNk.exe SCORE: 524 TYPE: EXE SIZE: 305664 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f047ab12fa0> 
MD5: 2a584dfc657348d164274a12bff9bbd8 
SHA1: bfeeba69f3d0f182e877e8a0efa4587fec821176 
SHA256: ef5f06c2d0518c52be10f97bd567210568611f35a954ff32af04c5bf7180bee1 CREATED: Mon Feb  7 13:02:59 2022 MODIFIED: Mon Feb  7 13:02:59 2022 ACCESSED: Mon Feb  7 13:03:51 2022 
REASON_1: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: socket Str3: connect
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegCloseKey
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA
REASON_4: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_5: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_6: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetReadFile
REASON_7: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpQueryInfo
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_18: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_19: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_20: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_21: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_22: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent Str4: OutputDebugString
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 55554444444141411111 Str2: 55554444222222111111 Str3: 55555555555555554444
REASON_26: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
REASON_27: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_28: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_29: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:03:52Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_tcp_socket
20		win_registry
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0
20		Advapi_Hash_API
25		CRC32_poly_Constant
25		CRC32_table
5		BASE64_table

Score total: 524

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2a584dfc657348d164274a12bff9bbd8                                                   |
| sha1                   | bfeeba69f3d0f182e877e8a0efa4587fec821176                                           |
| sha256                 | ef5f06c2d0518c52be10f97bd567210568611f35a954ff32af04c5bf7180bee1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FTeJ145aCCPJ6JdNk.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Data [C0002.005]                                     |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| receive data (2 matches)                             | communication                                        |
| send data (2 matches)                                | communication                                        |
| reference Google Public DNS server                   | communication/dns                                    |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration                             | communication/socket                                 |
| encode data using Base64 (2 matches)                 | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 via WinAPI                    | data-manipulation/encryption/rc4                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                      | data-manipulation/hashing                            |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments (2 matches)            | host-interaction/cli                                 |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| get thread local storage value                       | host-interaction/process                             |
| terminate process via fastfail                       | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value                    | host-interaction/registry                            |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::Query Registry [T1012;1]

Score total: 44.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Helminth-3', '45')]
-------------- LOKI_Rules ------------
[('network_tcp_socket', '50'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers0', '10'), ('Advapi_Hash_API', '20'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['524']
-------------- CAPA_Score ------------
['44.0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
9749.272182389916
============================================


==================================================================
Fichier HTTP-FTeJ145aCCPJ6JdNk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6DCxB28VnopdWsu61.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6DCxB28VnopdWsu61.exe: Win.Malware.Oski-9882838-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 46.772 sec (0 m 46 s)
Start Date: 2022:02:07 13:03:54
End Date:   2022:02:07 13:04:41

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Oski-9882838-1

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:03:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F6DCxB28VnopdWsu61.exe SCORE: 669 TYPE: EXE SIZE: 183296 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fcadc920fa0> 
MD5: fbbaaf569b63f6398503e4f1979cabef 
SHA1: ff86094702212d76922e2300c8868c9398729c33 
SHA256: 0a5de60f8d242caa0bd01cb811358ce2fc9f2f8530013ab650d8ac1950cff5e1 CREATED: Mon Feb  7 13:03:54 2022 MODIFIED: Mon Feb  7 13:03:54 2022 ACCESSED: Mon Feb  7 13:04:48 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetOpenUrl Str5: InternetReadFile Str6: HttpOpenRequest Str7: HttpSen ... (truncated)
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: FindC ... (truncated)
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_8: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: win_oski_auto SUBSCORE: 45 
DESCRIPTION: Detects win.oski. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 33c0e92bfeffff8bff558bec8b4508668b08 Str2: 83c120516a006a00 Str3: 25ff7f0000c38bff558bec83ec14ff7510 Str4: 50a1f4c44200508d8df0feffff ... (truncated)
REASON_11: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_13: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8d26e0000e989feffff Str2: e8d7fbffffe9b4feffff Str3: e841010000e919ffffff Str4: e831b1ffffe9fffeffff
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: H3B Str4: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_20: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_21: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_22: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_26: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:04:49Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
65		screenshot
60		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
45		win_oski_auto
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table

Score total: 669

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | fbbaaf569b63f6398503e4f1979cabef                                                   |
| sha1                   | ff86094702212d76922e2300c8868c9398729c33                                           |
| sha256                 | 0a5de60f8d242caa0bd01cb811358ce2fc9f2f8530013ab650d8ac1950cff5e1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6DCxB28VnopdWsu61.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Screen Capture:: \[T1113]\                                                         |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| CRYPTOGRAPHY                | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence:: [C0021]                                     |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Compression Library:: [C0060]                                                 |
|                             | Decompress Data::IEncodingFilterFactory [C0025.002]                           |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| capture screenshot                                       | collection/screenshot                                |
| receive data                                             | communication                                        |
| send data (2 matches)                                    | communication                                        |
| connect to HTTP server (2 matches)                       | communication/http/client                            |
| connect to URL                                           | communication/http/client                            |
| decompress HTTP response via IEncodingFilterFactory      | communication/http/client                            |
| decode data using Base64 via WinAPI                      | data-manipulation/encoding/base64                    |
| encode data using XOR (241 matches)                      | data-manipulation/encoding/xor                       |
| encrypt data using DPAPI (3 matches)                     | data-manipulation/encryption/dpapi                   |
| encrypt data using RC4 PRGA                              | data-manipulation/encryption/rc4                     |
| generate random numbers using the Delphi LCG (3 matches) | data-manipulation/prng/lcg                           |
| get common file path (10 matches)                        | host-interaction/file-system                         |
| copy file (5 matches)                                    | host-interaction/file-system/copy                    |
| create directory (2 matches)                             | host-interaction/file-system/create                  |
| delete directory (2 matches)                             | host-interaction/file-system/delete                  |
| delete file (7 matches)                                  | host-interaction/file-system/delete                  |
| check if file exists                                     | host-interaction/file-system/exists                  |
| enumerate files recursively (3 matches)                  | host-interaction/file-system/files/list              |
| get file size (2 matches)                                | host-interaction/file-system/meta                    |
| read .ini file                                           | host-interaction/file-system/read                    |
| read file on Windows (4 matches)                         | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                        | host-interaction/file-system/write                   |
| get memory capacity                                      | host-interaction/hardware/memory                     |
| check mutex and exit                                     | host-interaction/mutex                               |
| get hostname                                             | host-interaction/os/hostname                         |
| get system information on Windows                        | host-interaction/os/info                             |
| check OS version                                         | host-interaction/os/version                          |
| allocate thread local storage                            | host-interaction/process                             |
| create process on Windows (2 matches)                    | host-interaction/process/create                      |
| terminate process (2 matches)                            | host-interaction/process/terminate                   |
| query or enumerate registry key                          | host-interaction/registry                            |
| query or enumerate registry value (4 matches)            | host-interaction/registry                            |
| get session user name                                    | host-interaction/session                             |
| link many functions at runtime (5 matches)               | linking/runtime-linking                              |
| linked against XZip                                      | linking/static/xzip                                  |
| enumerate PE sections (2 matches)                        | load-code/pe                                         |
| parse PE header                                          | load-code/pe                                         |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
3		- Discovery::Account Discovery [T1087;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
6		- Collection::Screen Capture [T1113;6]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 47.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Collection::Screen Capture [T1113;6]', '6'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Oski-9882838-1', '50')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('screenshot', '65'), ('win_mutex', '60'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('win_oski_auto', '45'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25')]
-------------- LOKI_Score ------------
['669']
-------------- CAPA_Score ------------
['47.5']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
12180.14776307215
============================================


==================================================================
Fichier HTTP-F6DCxB28VnopdWsu61.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FEuZQHPO7SsYIJY59.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FEuZQHPO7SsYIJY59.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.23 MB
Data read: 0.22 MB (ratio 1.04:1)
Time: 44.496 sec (0 m 44 s)
Start Date: 2022:02:07 13:04:57
End Date:   2022:02:07 13:05:41

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe1 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:04:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FEuZQHPO7SsYIJY59.exe SCORE: 1089 TYPE: EXE SIZE: 232677 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7faba6248fa0> 
MD5: 2a7429d60040465f9bd27bbae2beef88 
SHA1: e51e65cf9377c74dec0c4fdb1acfb725855ec17d 
SHA256: 943998273af79de9689508f66166c6b33cc2af5c06d9e97fd8db15f0e9b5bdc0 CREATED: Mon Feb  7 13:04:57 2022 MODIFIED: Mon Feb  7 13:04:57 2022 ACCESSED: Mon Feb  7 13:05:50 2022 
REASON_1: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: DNSAPI.dll Str3: DnsQuery
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: PEtite_v22_wwwun4seencompetite SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_8: Yara Rule MATCH: PEtite_v22 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_9: Yara Rule MATCH: PEtite_v22_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_10: Yara Rule MATCH: Petite_v21_1 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_11: Yara Rule MATCH: Petite_22_c1998_99_Ian_Luck SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c605068000040008b3c248b306681c780078d74060889388b5e1050566a026880080000576a206a065 ... (truncated)
REASON_12: Yara Rule MATCH: PEtite_v22_Ian_Luck SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_13: Yara Rule MATCH: Petite_v21_1_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_14: Yara Rule MATCH: Petite_v21_1_Hint_WIN_EP SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_15: Yara Rule MATCH: Petite_13_c1998_Ian_Luck_h SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c605068000040008b3c248b306681c780078d74060889388b5e1050566a026880080000576a206a065 ... (truncated)
REASON_16: Yara Rule MATCH: Petitev211 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_17: Yara Rule MATCH: PEtitev22 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_21: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_22: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_23: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_25: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_26: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: .petite
REASON_27: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_28: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:05:50Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_dns
20		win_registry
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		PEtite_v22_wwwun4seencompetite
70		PEtite_v22
70		PEtite_v22_additional
70		Petite_v21_1
70		Petite_22_c1998_99_Ian_Luck
70		PEtite_v22_Ian_Luck
70		Petite_v21_1_additional
70		Petite_v21_1_Hint_WIN_EP
70		Petite_13_c1998_Ian_Luck_h
70		Petitev211
70		PEtitev22
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
60		suspicious_packer_section
20		isExecutable
10		Contains_PE_File

Score total: 1089

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_dns', '50'), ('win_registry', '20'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('PEtite_v22_wwwun4seencompetite', '70'), ('PEtite_v22', '70'), ('PEtite_v22_additional', '70'), ('Petite_v21_1', '70'), ('Petite_22_c1998_99_Ian_Luck', '70'), ('PEtite_v22_Ian_Luck', '70'), ('Petite_v21_1_additional', '70'), ('Petite_v21_1_Hint_WIN_EP', '70'), ('Petite_13_c1998_Ian_Luck_h', '70'), ('Petitev211', '70'), ('PEtitev22', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('suspicious_packer_section', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['1089']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
17259.486865901523
============================================


==================================================================
Fichier HTTP-FEuZQHPO7SsYIJY59.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FpZChg3ntLotdHPd4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FpZChg3ntLotdHPd4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.44 MB
Data read: 0.41 MB (ratio 1.06:1)
Time: 45.659 sec (0 m 45 s)
Start Date: 2022:02:07 13:05:51
End Date:   2022:02:07 13:06:36

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:05:51Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:06:46Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5dd0b130d5c3d40c69e3972f39fd7d62                                                   |
| sha1                   | 985c53d34bb0b7c8ddb615b5ec41168dfc96802c                                           |
| sha256                 | 708967cad421bb2396017bdd10a42e6799da27e29264f4b5fb095c0e3503e447                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FpZChg3ntLotdHPd4.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
|                        | Screen Capture:: \[T1113]\                                                         |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Inhibit System Recovery:: \[T1490]\                                                |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence:: [C0021]                                     |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Disk Content Wipe::Delete Shadow Drive [F0014.001]                            |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Wallpaper:: [C0035]                                                           |
| PROCESS                     | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                           | anti-analysis                                        |
| check for time delay via GetTickCount (2 matches)    | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (7 matches)             | anti-analysis/anti-vm/vm-detection                   |
| get geographical location (6 matches)                | collection                                           |
| log keystrokes                                       | collection/keylog                                    |
| log keystrokes via polling (7 matches)               | collection/keylog                                    |
| capture screenshot (2 matches)                       | collection/screenshot                                |
| compiled with Borland Delphi                         | compiler/delphi                                      |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| generate random numbers using the Delphi LCG         | data-manipulation/prng/lcg                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| manipulate boot configuration (2 matches)            | host-interaction/bootloader                          |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| get file size (2 matches)                            | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| read file on Windows (3 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (4 matches)                    | host-interaction/file-system/write                   |
| enumerate gui resources (2 matches)                  | host-interaction/gui                                 |
| set application hook (2 matches)                     | host-interaction/gui                                 |
| set global application hook                          | host-interaction/gui                                 |
| change the wallpaper                                 | host-interaction/gui/session                         |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window (7 matches)                    | host-interaction/gui/window/hide                     |
| get number of processors                             | host-interaction/hardware/cpu                        |
| get keyboard layout (2 matches)                      | host-interaction/hardware/keyboard/layout            |
| get disk information                                 | host-interaction/hardware/storage                    |
| get disk size                                        | host-interaction/hardware/storage                    |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| get thread local storage value                       | host-interaction/process                             |
| set thread local storage value                       | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (4 matches)        | host-interaction/registry                            |
| get session user name                                | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| delete volume shadow copies                          | impact/inhibit-system-recovery                       |
| link many functions at runtime (4 matches)           | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6		- Collection::Screen Capture [T1113;6]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Discovery::System Owner/User Discovery [T1033;3]
8		- Impact::Inhibit System Recovery [T1490;8]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
3		- Discovery::Account Discovery [T1087;3]
2		- Execution::Shared Modules [T1129;2]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 85.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Collection::Screen Capture [T1113;6]', '6'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Impact::Inhibit System Recovery [T1490;8]', '8'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['85.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1705.9492792983922
============================================


==================================================================
Fichier HTTP-FpZChg3ntLotdHPd4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FxdGZc1FrqK8axxyxf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5e6764534b3a1e4d3abacc4810b6985d                                                   |
| sha1                   | f10ad287f126f577f197070453812a7e88c2cc52                                           |
| sha256                 | e7d3181ef643d77bb33fe328d1ea58f512b4f27c8e6ed71935a2e7548f2facc0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FxdGZc1FrqK8axxyxf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate gui resources                              | host-interaction/gui                                 |
| link function at runtime on Windows                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
4		- Discovery::Application Window Discovery [T1010;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 16.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FxdGZc1FrqK8axxyxf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.77 MB
Data read: 0.72 MB (ratio 1.06:1)
Time: 45.172 sec (0 m 45 s)
Start Date: 2022:02:07 13:08:43
End Date:   2022:02:07 13:09:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:08:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FxdGZc1FrqK8axxyxf.exe SCORE: 474 TYPE: EXE SIZE: 757760 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7efe0877cfa0> 
MD5: 5e6764534b3a1e4d3abacc4810b6985d 
SHA1: f10ad287f126f577f197070453812a7e88c2cc52 
SHA256: e7d3181ef643d77bb33fe328d1ea58f512b4f27c8e6ed71935a2e7548f2facc0 CREATED: Mon Feb  7 13:08:43 2022 MODIFIED: Mon Feb  7 13:08:43 2022 ACCESSED: Mon Feb  7 13:09:26 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645c856c645c969c645ca72c645 Str2: c645c969c645ca72c645cb74c645 Str3: c645ca72c645cb74c645cc75c645 Str4: c645cb74c645cc75c645cd61c645 ... (truncated)
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff682896430068f42a400064a100000000506489250000000083ec68535657
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff682896430068f42a400064a10000000050
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff682896430068f42a400064a10000000050
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558beca1 Str3: 558bec51 Str4: 558bece8 Str5: 558bec68 Str6: 558bec8b Str7: 558bec53 Str8: 558bec83 Str9: 558becb9 Str1 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff682896430068f42a400064a1000000005064892500000000
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:09:30Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 474

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['474']
-------------- CAPA_Score ------------
['16.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
7841.612014235542
============================================


==================================================================
Fichier HTTP-FxdGZc1FrqK8axxyxf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FYM9Rb21VCWu0Lrybh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be a .NET module.
WARNING:capa: 
WARNING:capa: .NET is a cross-platform framework for running managed applications.
WARNING:capa: capa cannot handle non-native files. This means that the results may be misleading or incomplete.
WARNING:capa: You may have to analyze the file manually, using a tool like the .NET decompiler dnSpy.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) dotnet file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FYM9Rb21VCWu0Lrybh.exe: Win.Malware.Zusy-6866357-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FYM9Rb21VCWu0Lrybh.exe: Win.Packed.Bladabindi-6866359-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.633 sec (0 m 43 s)
Start Date: 2022:02:07 13:09:30
End Date:   2022:02:07 13:10:14

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Zusy-6866357-0
40		Win.Packed.Bladabindi-6866359-0

Score total: 90.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 36: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:09:31Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FYM9Rb21VCWu0Lrybh.exe SCORE: 654 TYPE: EXE SIZE: 39424 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f56ce7b2fa0> 
MD5: b9f5bd514485fb06da39beff051b9fdc 
SHA1: c72a2e50410475a51d897d29ffbbaf2103754d53 
SHA256: 34acc4c0b61b5ce0b37c3589f97d1f23e6d84011a241e6f85683ee517ce786f1 CREATED: Mon Feb  7 13:09:30 2022 MODIFIED: Mon Feb  7 13:09:30 2022 ACCESSED: Mon Feb  7 13:10:15 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: dotnet_libraries SUBSCORE: 5 
DESCRIPTION: .Net runtime mscoree.dll mscorwks.dll REF: - AUTHOR: - 
MATCHES: Str1: mscoree.dll Str2: _CorExeMain
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Studio_NET SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff250020400000000000000000000000000000000000000000000000000000000000000000000000
REASON_6: Yara Rule MATCH: Microsoft_Visual_C_v70_Basic_NET_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_7: Yara Rule MATCH: Microsoft_Visual_C_Basic_NET SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_8: Yara Rule MATCH: Microsoft_Visual_Studio_NET_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff250020400000000000000000000000000000000000000000000000000000000000000000000000
REASON_9: Yara Rule MATCH: Microsoft_Visual_C_v70_Basic_NET SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_10: Yara Rule MATCH: NET_executable_ SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_11: Yara Rule MATCH: NET_executable SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_12: Yara Rule MATCH: NETexecutableMicrosoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: 00000000000000005f436f724578654d61696e006d73636f7265652e646c6c0000000000ff25
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsNET_EXE SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:10:15Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_7
5		dotnet_libraries
5		executable_pe
70		Microsoft_Visual_Studio_NET
70		Microsoft_Visual_C_v70_Basic_NET_additional
70		Microsoft_Visual_C_Basic_NET
70		Microsoft_Visual_Studio_NET_additional
70		Microsoft_Visual_C_v70_Basic_NET
70		NET_executable_
70		NET_executable
70		NETexecutableMicrosoft
10		IsPE32
10		IsNET_EXE
10		IsWindowsGUI
10		IsPacked
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 654

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Zusy-6866357-0', '50'), ('Win.Packed.Bladabindi-6866359-0', '40')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_7', '2'), ('dotnet_libraries', '5'), ('executable_pe', '5'), ('Microsoft_Visual_Studio_NET', '70'), ('Microsoft_Visual_C_v70_Basic_NET_additional', '70'), ('Microsoft_Visual_C_Basic_NET', '70'), ('Microsoft_Visual_Studio_NET_additional', '70'), ('Microsoft_Visual_C_v70_Basic_NET', '70'), ('NET_executable_', '70'), ('NET_executable', '70'), ('NETexecutableMicrosoft', '70'), ('IsPE32', '10'), ('IsNET_EXE', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['654']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['90.0']
-------------- SCORE FINAL ------------
11498.23434931043
============================================


==================================================================
Fichier HTTP-FYM9Rb21VCWu0Lrybh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmKgni1Bm9v3f005Ae.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3f8e2b945deba235fa4888682bd0d640                                                   |
| sha1                   | d4e234ec4baf7d12dd59c3a9238326819a509a31                                           |
| sha256                 | 75eb05679a0a988dddf8badfc6d5996cc7e372c73e1023dde59efbaab6ece655                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmKgni1Bm9v3f005Ae.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
| DISCOVERY              | System Network Configuration Discovery::Internet Connection Discovery \[T1016.001]\ |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data                                         | communication                                        |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory                                     | host-interaction/file-system/create                  |
| delete file                                          | host-interaction/file-system/delete                  |
| check Internet connectivity via WinINet              | host-interaction/network/connectivity                |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]

Score total: 28.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmKgni1Bm9v3f005Ae.exe: Win.Trojan.Agent-6298583-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 29.704 sec (0 m 29 s)
Start Date: 2022:02:07 13:10:15
End Date:   2022:02:07 13:10:45

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-6298583-0
75		Win.Trojan.Agent-6298583-0
45		Win.Trojan.Agent-6298583-0

Score total: 190.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-6298583-0', '70'), ('Win.Trojan.Agent-6298583-0', '75'), ('Win.Trojan.Agent-6298583-0', '45')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['664']
-------------- CAPA_Score ------------
['28.5']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
13484.29884011684
============================================


==================================================================
Fichier HTTP-FmKgni1Bm9v3f005Ae.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FY6e5l1DZVrJ6IRdlc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 89e7c865c8d862c55404b8b9a5f4b371                                                   |
| sha1                   | 54f5e4c43388c958a1ed947e2bb9e0e5d8a43277                                           |
| sha256                 | b48d5b58d9bbf92fbffba06d98e695218676d3ba1d4a060c08e3b9ef1650110c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FY6e5l1DZVrJ6IRdlc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FY6e5l1DZVrJ6IRdlc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 42.835 sec (0 m 42 s)
Start Date: 2022:02:07 13:11:09
End Date:   2022:02:07 13:11:52

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:11:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FY6e5l1DZVrJ6IRdlc.exe SCORE: 239 TYPE: EXE SIZE: 83968 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6e1c7cffa0> 
MD5: 89e7c865c8d862c55404b8b9a5f4b371 
SHA1: 54f5e4c43388c958a1ed947e2bb9e0e5d8a43277 
SHA256: b48d5b58d9bbf92fbffba06d98e695218676d3ba1d4a060c08e3b9ef1650110c CREATED: Mon Feb  7 13:11:09 2022 MODIFIED: Mon Feb  7 13:11:09 2022 ACCESSED: Mon Feb  7 13:12:00 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e97efdffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:12:00Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_7
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		IsPacked
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 239

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_7', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['239']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3847.7525994311272
============================================


==================================================================
Fichier HTTP-FY6e5l1DZVrJ6IRdlc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fwf62v2leOqmFBoXLa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fwf62v2leOqmFBoXLa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.65 MB
Data read: 0.62 MB (ratio 1.06:1)
Time: 41.802 sec (0 m 41 s)
Start Date: 2022:02:07 13:12:00
End Date:   2022:02:07 13:12:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0
sh: 279: Syntax error: Unterminated quoted string

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c3341b7dfbb9d43bca8c812e07b4299f                                                   |
| sha1                   | 3a3e93cffca2a2cbaca24cb89cf8797c9aad7f97                                           |
| sha256                 | 17e53dc9559040773a1a3537f7d1c0ebe38929b905cb998f5c4cd9a2e435627f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fwf62v2leOqmFBoXLa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions (3 matches)             | anti-analysis/anti-vm/vm-detection                   |
| compiled with rust                                   | compiler/rust                                        |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (3 matches)              | data-manipulation/encryption/rc4                     |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| contains PDB path                                    | executable/pe/pdb                                    |
| list groups for user account                         | host-interaction/accounts                            |
| list user accounts                                   | host-interaction/accounts                            |
| accept command line arguments                        | host-interaction/cli                                 |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| read file on Windows (3 matches)                     | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| references logon banner                              | host-interaction/gui/logon                           |
| get hostname                                         | host-interaction/os/hostname                         |
| allocate thread local storage                        | host-interaction/process                             |
| get thread local storage value (9 matches)           | host-interaction/process                             |
| set thread local storage value (10 matches)          | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| set registry value                                   | host-interaction/registry/create                     |
| get logon sessions                                   | host-interaction/session                             |
| get kernel32 base address                            | linking/runtime-linking                              |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| enumerate PE sections (23 matches)                   | load-code/pe                                         |
| parse PE exports (47 matches)                        | load-code/pe                                         |
| parse PE header (102 matches)                        | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::Account Discovery [T1087;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]

Score total: 28.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('cred_local', '80'), ('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '10'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('antisb_threatExpert', '60'), ('SEH__vectored_v1', '60'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10'), ('SHA2_BLAKE2_IVs', '20'), ('BASE64_table', '5'), ('SipHash_big_endian_constants', '15')]
-------------- LOKI_Score ------------
['684']
-------------- CAPA_Score ------------
['28.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
11399.342884625301
============================================


==================================================================
Fichier HTTP-Fwf62v2leOqmFBoXLa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FdpkWH1Ne4hfsmxIZ1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9de952f476abab0cd62bfd81e20a3deb                                                   |
| sha1                   | 109cc4467b78dad4b12a3225020ea590bccee3e6                                           |
| sha256                 | e9cb6336359ac6f71ac75af2836efb28daa3bafd10a1f0b775dcdc2ec8850a6b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FdpkWH1Ne4hfsmxIZ1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                            |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DEFENSE EVASION             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI                    | data-manipulation/encryption/aes                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                      | data-manipulation/hashing                            |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path (11 matches)                    | host-interaction/file-system                         |
| create directory (3 matches)                         | host-interaction/file-system/create                  |
| delete file (3 matches)                              | host-interaction/file-system/delete                  |
| check if file exists (4 matches)                     | host-interaction/file-system/exists                  |
| enumerate files recursively (2 matches)              | host-interaction/file-system/files/list              |
| get file size (2 matches)                            | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| create shortcut via IShellLink                       | host-interaction/file-system/write                   |
| write file on Windows                                | host-interaction/file-system/write                   |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| check mutex (3 matches)                              | host-interaction/mutex                               |
| create mutex (2 matches)                             | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| set registry value (6 matches)                       | host-interaction/registry/create                     |
| delete registry value (2 matches)                    | host-interaction/registry/delete                     |
| create thread                                        | host-interaction/thread/create                       |
| link function at runtime on Windows (6 matches)      | linking/runtime-linking                              |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::Query Registry [T1012;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]

Score total: 44.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FdpkWH1Ne4hfsmxIZ1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 45.518 sec (0 m 45 s)
Start Date: 2022:02:07 13:14:40
End Date:   2022:02:07 13:15:25

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:14:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FdpkWH1Ne4hfsmxIZ1.exe SCORE: 509 TYPE: EXE SIZE: 77824 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb70bdf3fa0> 
MD5: 9de952f476abab0cd62bfd81e20a3deb 
SHA1: 109cc4467b78dad4b12a3225020ea590bccee3e6 
SHA256: e9cb6336359ac6f71ac75af2836efb28daa3bafd10a1f0b775dcdc2ec8850a6b CREATED: Mon Feb  7 13:14:40 2022 MODIFIED: Mon Feb  7 13:14:40 2022 ACCESSED: Mon Feb  7 13:15:33 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8eb0500004883c428e97efdffffcccccccccccccccccccccccccccc
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_17: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 8bc1488b8c24300200004833cc
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:15:34Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
20		win_registry
65		win_token
10		win_files_operation
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
10		anti_dbg
60		skip20_sqllang_hook
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 509

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;5]', '5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('anti_dbg', '10'), ('skip20_sqllang_hook', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['509']
-------------- CAPA_Score ------------
['44.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8954.998079788218
============================================


==================================================================
Fichier HTTP-FdpkWH1Ne4hfsmxIZ1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fo4aEJ1PutLnOQD6Jd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 22eb6c0cdc1c8b41e079c1d6ed625973                                                   |
| sha1                   | a014d18763e071d2b2bfc552e32598b138cfdf77                                           |
| sha256                 | 01179d6668a3aa00affc7481d53894233cc8f53eb2af23d4cc148e8bef904db2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fo4aEJ1PutLnOQD6Jd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings targeting Xen              | anti-analysis/anti-vm/vm-detection                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 7.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fo4aEJ1PutLnOQD6Jd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 6.33 MB
Data read: 5.95 MB (ratio 1.06:1)
Time: 48.453 sec (0 m 48 s)
Start Date: 2022:02:07 13:15:34
End Date:   2022:02:07 13:16:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:15:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:16:26Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['7.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
149.64467362266598
============================================


==================================================================
Fichier HTTP-Fo4aEJ1PutLnOQD6Jd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FArKc42r508ExbalGc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | bbdd0cfa22609724363ff4437bb47959                                                   |
| sha1                   | 68ecb50c8caa2a7205ccd50b194a43664bfde5ef                                           |
| sha256                 | b1f134a7183435671af8c9c1592d9662c1b4e1788577eb5bffa5b9e8caae148d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FArKc42r508ExbalGc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:16:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FArKc42r508ExbalGc.exe SCORE: 99 TYPE: EXE SIZE: 14336 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb79dbbdfa0> 
MD5: bbdd0cfa22609724363ff4437bb47959 
SHA1: 68ecb50c8caa2a7205ccd50b194a43664bfde5ef 
SHA256: b1f134a7183435671af8c9c1592d9662c1b4e1788577eb5bffa5b9e8caae148d CREATED: Mon Feb  7 13:16:27 2022 MODIFIED: Mon Feb  7 13:16:27 2022 ACCESSED: Mon Feb  7 13:17:03 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:17:03Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_4
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 99

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FArKc42r508ExbalGc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 45.115 sec (0 m 45 s)
Start Date: 2022:02:07 13:16:27
End Date:   2022:02:07 13:17:12

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['99']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1588.996883686191
============================================


==================================================================
Fichier HTTP-FArKc42r508ExbalGc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FPCzJ73CkA6ev3qvm4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FPCzJ73CkA6ev3qvm4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.28 MB
Data read: 0.27 MB (ratio 1.06:1)
Time: 41.804 sec (0 m 41 s)
Start Date: 2022:02:07 13:17:12
End Date:   2022:02:07 13:17:54

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:17:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FPCzJ73CkA6ev3qvm4.exe SCORE: 349 TYPE: EXE SIZE: 280576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f73c7634fa0> 
MD5: a5018ebb1a375f9bcf404b621c536426 
SHA1: 362280bcd1f26eca4943f2210160834fcc20da2e 
SHA256: b936f68a90d7a8e2a1e19826c6284abe2aa5cc4131bf231d1f1f08d664425d44 CREATED: Mon Feb  7 13:17:12 2022 MODIFIED: Mon Feb  7 13:17:12 2022 ACCESSED: Mon Feb  7 13:18:06 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
REASON_18: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_19: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:18:07Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API
25		Crypt32_CryptBinaryToString_API
5		BASE64_table

Score total: 349

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a5018ebb1a375f9bcf404b621c536426                                                   |
| sha1                   | 362280bcd1f26eca4943f2210160834fcc20da2e                                           |
| sha256                 | b936f68a90d7a8e2a1e19826c6284abe2aa5cc4131bf231d1f1f08d664425d44                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FPCzJ73CkA6ev3qvm4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| decode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (4 matches)                    | data-manipulation/encoding/xor                       |
| encrypt or decrypt data via BCrypt                   | data-manipulation/encryption                         |
| encrypt data using DPAPI (4 matches)                 | data-manipulation/encryption/dpapi                   |
| hash data via BCrypt (4 matches)                     | data-manipulation/hashing                            |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (5 matches)           | host-interaction/process/terminate                   |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 16.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Advapi_Hash_API', '20'), ('Crypt32_CryptBinaryToString_API', '25'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['349']
-------------- CAPA_Score ------------
['16.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5860.495523659151
============================================


==================================================================
Fichier HTTP-FPCzJ73CkA6ev3qvm4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FKv2Jp4wfnGhh9Jdx9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6fcc13563aad936c7d0f3165351cb453                                                   |
| sha1                   | 8b1757b95b7b7f9c4dfa09b52b0d3c6451b269fc                                           |
| sha256                 | 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FKv2Jp4wfnGhh9Jdx9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Luhn [C0032.002]                                                    |
|                             | Encode Data::Base64 [C0026.001]                                               |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send data                                            | communication                                        |
| connect to HTTP server                               | communication/http/client                            |
| validate payment card number using luhn algorithm    | data-manipulation/checksum/luhn                      |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| allocate thread local storage                        | host-interaction/process                             |
| read process memory                                  | host-interaction/process                             |
| enumerate processes                                  | host-interaction/process/list                        |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| get session user name                                | host-interaction/session                             |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::Account Discovery [T1087;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Discovery::Software Discovery [T1518;4]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 37.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FKv2Jp4wfnGhh9Jdx9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 41.657 sec (0 m 41 s)
Start Date: 2022:02:07 13:18:18
End Date:   2022:02:07 13:18:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:18:18Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FKv2Jp4wfnGhh9Jdx9.exe SCORE: 779 TYPE: EXE SIZE: 95232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5451b82fa0> 
MD5: 6fcc13563aad936c7d0f3165351cb453 
SHA1: 8b1757b95b7b7f9c4dfa09b52b0d3c6451b269fc 
SHA256: 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e CREATED: Mon Feb  7 13:18:18 2022 MODIFIED: Mon Feb  7 13:18:18 2022 ACCESSED: Mon Feb  7 13:19:07 2022 
REASON_1: Malware Hash TYPE: SHA256 HASH: 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e SUBSCORE: 100 DESC: Kronos Banking Trojan Used to Deliver New Point-of-Sale Malware https://www.proofpoint.com/us/threat-insight/post/kronos-banking-trojan-used-to-
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: HttpOpenRequest Str5: HttpSendRequest
REASON_3: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_5: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_6: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetConnect Str2: InternetOpen
REASON_7: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: win_scanpos_auto SUBSCORE: 45 
DESCRIPTION: Detects win.scanpos. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 03c703cf83ff1f0f87a4030000ff24bd0ce640008bc6e998030000 Str2: c745fc00000000807dd800750aba04000000e9c2000000c645fc018b16 Str3: 5dc38d4 ... (truncated)
REASON_10: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344539d555c0350104c409f8f5859b0a35bf401000000433a5c55736572735c6578616d706c655c646f63756d656e74735c76697375616c2073747564696f20323 ... (truncated)
REASON_11: Yara Rule MATCH: ConventionEngine_Term_VisualStudio SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344539d555c0350104c409f8f5859b0a35bf401000000433a5c55736572735c6578616d706c655c646f63756d656e74735c76697375616c2073747564696f20323 ... (truncated)
REASON_12: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_14: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8cd530000e989feffff Str2: e8d7fbffffe9b4feffff Str3: e8c14c0000e919ffffff
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: <gA Str4: <gA<gA Str5: <gA<gA<gA Str6: <gA<gA<gA<gA Str7: <gA<gA<gA<gA<gA Str8:  Str9:  Str10:  Str11:  Str12:  Str13 ... (truncated)
REASON_16: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_19: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_20: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_22: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_23: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_24: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_25: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_26: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:19:07Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
45		network_http
70		escalate_priv
65		win_token
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
45		win_scanpos_auto
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_VisualStudio
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 779

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Account Discovery [T1087;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Discovery::Software Discovery [T1518;4]', '4'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100'), ('network_http', '45'), ('escalate_priv', '70'), ('win_token', '65'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('win_scanpos_auto', '45'), ('ConventionEngine_Term_Users', '50'), ('ConventionEngine_Term_VisualStudio', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['779']
-------------- CAPA_Score ------------
['37.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
13084.565025810558
============================================


==================================================================
Fichier HTTP-FKv2Jp4wfnGhh9Jdx9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFJamv2R9xcbA3JUm5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFJamv2R9xcbA3JUm5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.37 MB
Data read: 0.08 MB (ratio 4.70:1)
Time: 47.002 sec (0 m 47 s)
Start Date: 2022:02:07 13:19:07
End Date:   2022:02:07 13:19:54

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0
sh: 194: Syntax error: EOF in backquote substitution

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('ASPack_v212_additional', '70'), ('ASPack_v21_additional', '70'), ('ASProtect_V2X_DLL_Alexey_Solodovnikov', '70'), ('ASPack_v212', '70'), ('yodas_Protector_v1033_dllocx_Ashkbiz_Danehkar_h', '70'), ('ASPack_v211d', '70'), ('ASProtect_V2X_DLL_Alexey_Solodovnikov_additional', '70'), ('ASPack_212withouth_Poly_Solodovnikov_Alexey', '70'), ('ASPack_v212_Alexey_Solodovnikov', '70'), ('ASPackv212AlexeySolodovnikov', '70'), ('ASProtectV2XDLLAlexeySolodovnikov', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('IsPacked', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('suspicious_packer_section', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['964']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
15278.370375325132
============================================


==================================================================
Fichier HTTP-FFJamv2R9xcbA3JUm5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FGdEl31ZswWrtCBH7a.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dfa95cf9ed03219827e5522d30d6c100                                                   |
| sha1                   | aaeafbabca133d19c49ecf1189dafb1c5ef45ef2                                           |
| sha256                 | 1a603726412f20385c8e488c9342c0da74210adf85395458b30b9ad59f78576f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FGdEl31ZswWrtCBH7a.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| get file system object information                   | host-interaction/file-system                         |
| read .ini file (3 matches)                           | host-interaction/file-system/read                    |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value (4 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| link function at runtime on Windows                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]

Score total: 8.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:20:03Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FGdEl31ZswWrtCBH7a.exe SCORE: 329 TYPE: EXE SIZE: 66048 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7efcbc366fa0> 
MD5: dfa95cf9ed03219827e5522d30d6c100 
SHA1: aaeafbabca133d19c49ecf1189dafb1c5ef45ef2 
SHA256: 1a603726412f20385c8e488c9342c0da74210adf85395458b30b9ad59f78576f CREATED: Mon Feb  7 13:20:03 2022 MODIFIED: Mon Feb  7 13:20:03 2022 ACCESSED: Mon Feb  7 13:20:44 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:20:44Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 329

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FGdEl31ZswWrtCBH7a.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 44.122 sec (0 m 44 s)
Start Date: 2022:02:07 13:20:03
End Date:   2022:02:07 13:20:47

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['329']
-------------- CAPA_Score ------------
['8.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5383.895899969418
============================================


==================================================================
Fichier HTTP-FGdEl31ZswWrtCBH7a.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FayhYs1MmUG8w59GCj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | d2cdbfcf382759848b76a2ac3422b491                                                   |
| sha1                   | edc3e444b5c046a47e58144977393a5b97b9158e                                           |
| sha256                 | be8040bd37a6868acb65672d94336ef62f831ca2100297744bcabadbc7f1d200                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FayhYs1MmUG8w59GCj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get thread local storage value                       | host-interaction/process                             |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| create thread                                        | host-interaction/thread/create                       |
| resume thread                                        | host-interaction/thread/resume                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::Query Registry [T1012;1]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 4.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:20:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FayhYs1MmUG8w59GCj.exe SCORE: 289 TYPE: EXE SIZE: 16384 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f46a88e5fa0> 
MD5: d2cdbfcf382759848b76a2ac3422b491 
SHA1: edc3e444b5c046a47e58144977393a5b97b9158e 
SHA256: be8040bd37a6868acb65672d94336ef62f831ca2100297744bcabadbc7f1d200 CREATED: Mon Feb  7 13:20:47 2022 MODIFIED: Mon Feb  7 13:20:47 2022 ACCESSED: Mon Feb  7 13:21:26 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:21:26Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_4
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 289

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FayhYs1MmUG8w59GCj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.789 sec (0 m 42 s)
Start Date: 2022:02:07 13:20:47
End Date:   2022:02:07 13:21:30

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '65'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['289']
-------------- CAPA_Score ------------
['4.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4670.128130386217
============================================


==================================================================
Fichier HTTP-FayhYs1MmUG8w59GCj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FyLyoL3k30w5rWgMU.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 80372de850597bd9e7e021a94f13f0a1                                                   |
| sha1                   | 037db820c8dee94ae25a439b758a2b89f527cbb4                                           |
| sha256                 | 2520b15068fa108c947db179377c6b462f2c4f47037168bf8c69fcb668cb11a8                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FyLyoL3k30w5rWgMU.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| CRYPTOGRAPHY                | Cryptographic Hash::SHA256 [C0029.003]                                        |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings (2 matches)          | anti-analysis/obfuscation/string/stackstring         |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (11 matches)                   | data-manipulation/encoding/xor                       |
| encrypt data using Curve25519 (2 matches)            | data-manipulation/encryption/elliptic-curve          |
| encrypt data using RC4 KSA                           | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| hash data using murmur3 (2 matches)                  | data-manipulation/hashing/murmur                     |
| hash data using SHA256                               | data-manipulation/hashing/sha256                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate PE sections (4 matches)                    | load-code/pe                                         |
| parse PE exports (6 matches)                         | load-code/pe                                         |
| parse PE header (20 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
2		- Execution::Shared Modules [T1129;2]

Score total: 6.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FyLyoL3k30w5rWgMU.exe: Win.Ransomware.Netwalker-7671868-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FyLyoL3k30w5rWgMU.exe: Win.Ransomware.Razy-9848777-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 36.567 sec (0 m 36 s)
Start Date: 2022:02:07 13:21:30
End Date:   2022:02:07 13:22:06

-------- Score ----------------
Scores		Rules
.......		...............
80		Win.Ransomware.Netwalker-7671868-0
80		Win.Ransomware.Razy-9848777-0

Score total: 160.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 2-3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 5-6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:21:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FyLyoL3k30w5rWgMU.exe SCORE: 384 TYPE: EXE SIZE: 70656 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f63f2f5afa0> 
MD5: 80372de850597bd9e7e021a94f13f0a1 
SHA1: 037db820c8dee94ae25a439b758a2b89f527cbb4 
SHA256: 2520b15068fa108c947db179377c6b462f2c4f47037168bf8c69fcb668cb11a8 CREATED: Mon Feb  7 13:21:30 2022 MODIFIED: Mon Feb  7 13:21:30 2022 ACCESSED: Mon Feb  7 13:22:24 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: win_mailto_auto SUBSCORE: 45 
DESCRIPTION: Detects win.mailto. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8b7c2410c1f81ac1f91f23c88bc1c1e01a2bf8 Str2: 03c0505655e8588e00008b742430 Str3: 85ed7ea4660f1f440000803c1e2e757656e844410000 Str4: 8b ... (truncated)
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: netwalker_ransomware_v1 SUBSCORE: 60 
DESCRIPTION: Rule to detect Netwalker ransomware REF: https://www.ccn-cert.cni.es/comunicacion-eventos/comunicados-ccn-cert/9802-publicado-un-informe-de-codigo-danino-sobre-netwalker.html AUTHOR: McAfee ATR Team 
MATCHES: Str1: cccccccccca170124100c3cccccccccccccccccccc538b5c24085533ed5785db747f8b7c241485ff74778b431085c07470c1e00250e8fb0e000083c404890785c0745 ... (truncated)
REASON_10: Yara Rule MATCH: Netwalker_v1 SUBSCORE: 60 
DESCRIPTION: Rule based on code overlap in RagnarLocker ransomware REF: - AUTHOR: McAfee ATR team 
MATCHES: Str1: c88bf28b4330f76f3803c88b434813f2f76f2003c88b433813f2f76f3003c88b434013f2f76f2803c88b432813f2f76f4003c8894d6813f289756c8b4338f76f388bc ... (truncated)
REASON_11: Yara Rule MATCH: Netwalker SUBSCORE: 60 
DESCRIPTION: Detects Netwalker Ransomware REF: https://github.com/f0wl/configwalker AUTHOR: Marius 'f0wL' Genheimer <hello@dissectingmalwa.re> 
MATCHES: Str1: svcwait Str2: mscfile Str3: pspath Str4: mode Str5: spsz Str6: idsz Str7: onion1 Str8: onion2 Str9: lfile Str10: lend Str11: white St ... (truncated)
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_15: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_16: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
REASON_17: Yara Rule MATCH: Chacha_128_constant SUBSCORE: 15 
DESCRIPTION: Look for 128-bit key Chacha stream cipher constant REF: https://www.ecrypt.eu.org/stream/salsa20pf.html AUTHOR: spelissier 
MATCHES: Str1: expand 16-byte k
REASON_18: Yara Rule MATCH: Chacha_256_constant SUBSCORE: 15 
DESCRIPTION: Look for 256-bit key Chacha stream cipher constant REF: https://tools.ietf.org/html/rfc8439#page-8 AUTHOR: spelissier 
MATCHES: Str1: expand 32-byte k Str2: expand 3 Str3: 2-byte k
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:22:24Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
45		win_mailto_auto
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
2		PE_File
60		netwalker_ransomware_v1
60		Netwalker_v1
60		Netwalker
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant
20		SHA2_BLAKE2_IVs
5		BASE64_table
15		Chacha_128_constant
15		Chacha_256_constant

Score total: 384

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Ransomware.Netwalker-7671868-0', '80'), ('Win.Ransomware.Razy-9848777-0', '80')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('win_mailto_auto', '45'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('PE_File', '2'), ('netwalker_ransomware_v1', '60'), ('Netwalker_v1', '60'), ('Netwalker', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25'), ('SHA2_BLAKE2_IVs', '20'), ('BASE64_table', '5'), ('Chacha_128_constant', '15'), ('Chacha_256_constant', '15')]
-------------- LOKI_Score ------------
['384']
-------------- CAPA_Score ------------
['6.0']
-------------- CLAMAV_Score ------------
['160.0']
-------------- SCORE FINAL ------------
8219.986256819475
============================================


==================================================================
Fichier HTTP-FyLyoL3k30w5rWgMU.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FZMDRt2yjCz1HWMKX.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6242e3d67787ccbf4e06ad2982853144                                                   |
| sha1                   | 6ac7947207d999a65890ab25fe344955da35028e                                           |
| sha256                 | 4ca10dba7ff487fdb3f1362a3681d7d929f5aa1262cdfd31b04c30826983fb1d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FZMDRt2yjCz1HWMKX.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | ICMP Communication::Echo Request [C0014.002]                                  |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send ICMP echo request                               | communication/icmp                                   |
| initialize Winsock library                           | communication/socket                                 |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| resolve DNS (4 matches)                              | host-interaction/network/dns/resolve                 |
| get routing table                                    | host-interaction/network/routing-table               |
| query or enumerate registry value                    | host-interaction/registry                            |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
1		- Discovery::Query Registry [T1012;1]

Score total: 15.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FZMDRt2yjCz1HWMKX.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 46.197 sec (0 m 46 s)
Start Date: 2022:02:07 13:22:25
End Date:   2022:02:07 13:23:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:22:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FZMDRt2yjCz1HWMKX.exe SCORE: 554 TYPE: EXE SIZE: 15360 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f95c3710fa0> 
MD5: 6242e3d67787ccbf4e06ad2982853144 
SHA1: 6ac7947207d999a65890ab25fe344955da35028e 
SHA256: 4ca10dba7ff487fdb3f1362a3681d7d929f5aa1262cdfd31b04c30826983fb1d CREATED: Mon Feb  7 13:22:25 2022 MODIFIED: Mon Feb  7 13:22:25 2022 ACCESSED: Mon Feb  7 13:23:19 2022 
REASON_1: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: getaddrinfo
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Visual_Cpp_2005_Release_Microsoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e805030000e9c3fdffff
REASON_8: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e805030000e9c3fdffff
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1:  Str2: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_17: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:23:19Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_dns
20		win_registry
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Visual_Cpp_2005_Release_Microsoft
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
40		SEH_Save
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 554

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_dns', '50'), ('win_registry', '20'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Visual_Cpp_2005_Release_Microsoft', '70'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['554']
-------------- CAPA_Score ------------
['15.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
9079.5976334799
============================================


==================================================================
Fichier HTTP-FZMDRt2yjCz1HWMKX.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXRh4e4GS1t8EWN8tk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXRh4e4GS1t8EWN8tk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.58 MB
Data read: 0.55 MB (ratio 1.06:1)
Time: 44.966 sec (0 m 44 s)
Start Date: 2022:02:07 13:23:20
End Date:   2022:02:07 13:24:05

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:23:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXRh4e4GS1t8EWN8tk.exe SCORE: 389 TYPE: EXE SIZE: 580056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7496453fa0> 
MD5: 4e9c546a54e40d0da89bb4616dd7f8c4 
SHA1: bea77cbd4fb58a6e97a994310b63f7c3c2761cbe 
SHA256: 66af4bca3df1ee98ec1fdb65b4e5fed4146bd0743ef8318c87368434d3ac50de CREATED: Mon Feb  7 13:23:20 2022 MODIFIED: Mon Feb  7 13:23:20 2022 ACCESSED: Mon Feb  7 13:24:13 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_3: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:24:14Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		win_files_operation
10		misc_pe_signature
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
10		anti_dbg
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant

Score total: 389

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4e9c546a54e40d0da89bb4616dd7f8c4                                                   |
| sha1                   | bea77cbd4fb58a6e97a994310b63f7c3c2761cbe                                           |
| sha256                 | 66af4bca3df1ee98ec1fdb65b4e5fed4146bd0743ef8318c87368434d3ac50de                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXRh4e4GS1t8EWN8tk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
| DATA                        | Checksum::CRC32 [C0032.001]                                                   |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| hash data with CRC32                                 | data-manipulation/checksum/crc32                     |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt data using RC4 with custom key via WinAPI    | data-manipulation/encryption/rc4                     |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path (3 matches)                     | host-interaction/file-system                         |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| check mutex and exit                                 | host-interaction/mutex                               |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (7 matches)                          | load-code/pe                                         |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]

Score total: 8.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('win_files_operation', '10'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['389']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6324.85550387124
============================================


==================================================================
Fichier HTTP-FXRh4e4GS1t8EWN8tk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FUvqYXdYmmyw3CxB1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FUvqYXdYmmyw3CxB1.exe: Win.Ransomware.Ryuk-9779552-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.14 MB
Data read: 0.13 MB (ratio 1.06:1)
Time: 45.527 sec (0 m 45 s)
Start Date: 2022:02:07 13:24:15
End Date:   2022:02:07 13:25:01

-------- Score ----------------
Scores		Rules
.......		...............
80		Win.Ransomware.Ryuk-9779552-0

Score total: 80.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xea in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd1 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:24:16Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FUvqYXdYmmyw3CxB1.exe SCORE: 524 TYPE: EXE SIZE: 137680 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f919edbffa0> 
MD5: a5c70086b3bc4fe64f4e7a0aa452e620 
SHA1: 2ab44cf5338ef5ed118365b4e8452b906c0dab4b 
SHA256: 2ec5256a7edb90b1c05c92f79e8a48c205b29e1ac910a535aa83c30b8dbbeff8 CREATED: Mon Feb  7 13:24:15 2022 MODIFIED: Mon Feb  7 13:24:15 2022 ACCESSED: Mon Feb  7 13:25:09 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_ryuk_auto SUBSCORE: 45 
DESCRIPTION: Detects win.ryuk. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 68940b02356a016a006814010000 Str2: 85c075086a01ff15200e023568940b02356a01 Str3: ff7508e8e40e00005e5dc36a086878b00135 Str4: 6a086a1868 ... (truncated)
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645bc48c645bd45c645be52c645 Str2: c645bd45c645be52c645bf4dc645 Str3: c645be52c645bf4dc645c045c645 Str4: c645bf4dc645c045c645c153c645
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e86d020000e98efeffff
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3: a Str4: a Str5: 00000000000000000000000000000081d3d8dee0f90000317e81fe00000000000000000000000000000000000000000000000 ... (truncated)
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: d021000000020200308221c006092a864886f70d010702a08221b1308221ad020101310b300906052b0e03021a0500304c060a2b060104018237020104a03e303c301 ... (truncated)
REASON_16: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_22: Yara Rule MATCH: cert_blocklist_07b74c70c4aa092648b7f0d1a8a3a28f SUBSCORE: 60 
DESCRIPTION: Certificate used for digitally signing malware. REF: - AUTHOR: ReversingLabs
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:25:10Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		misc_pe_signature
10		ft_exe
45		win_ryuk_auto
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDigitalSignature
10		HasDebugData
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
60		cert_blocklist_07b74c70c4aa092648b7f0d1a8a3a28f
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant

Score total: 524

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Ransomware.Ryuk-9779552-0', '80')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('win_ryuk_auto', '45'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDigitalSignature', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('cert_blocklist_07b74c70c4aa092648b7f0d1a8a3a28f', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['524']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['80.0']
-------------- SCORE FINAL ------------
9311.980657931566
============================================


==================================================================
Fichier HTTP-FUvqYXdYmmyw3CxB1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FrCkQ41oU3Q00hBEb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 88abae59e3b1cf07bef2feb1efee0324                                                   |
| sha1                   | 4337778595c76e82ea011103f320d2af33dbe899                                           |
| sha256                 | 3ba837e827a5a20cf51ec82972b5e5fe028708932bfe1e58fd1224ef2fe5bb75                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FrCkQ41oU3Q00hBEb.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| create process on Windows                            | host-interaction/process/create                      |
| inject thread                                        | host-interaction/process/inject                      |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| query or enumerate registry value                    | host-interaction/registry                            |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
1		- Discovery::Query Registry [T1012;1]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 14.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FrCkQ41oU3Q00hBEb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 44.683 sec (0 m 44 s)
Start Date: 2022:02:07 13:25:10
End Date:   2022:02:07 13:25:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]', '6'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('dll_injection_thread', '15'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Inject_Thread', '45'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['889']
-------------- CAPA_Score ------------
['14.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
14379.013516649786
============================================


==================================================================
Fichier HTTP-FrCkQ41oU3Q00hBEb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F7Gyvu4Hx0q2GCmbZ.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 05cff15ab2be64cdb74c1a542802f7bb                                                   |
| sha1                   | 365064133164b804317734f29e503749c5be0791                                           |
| sha256                 | 6f4a4f78ed11823f45fe9efeab507cbf8bbd90a415cd4151427b071ecc576dc0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F7Gyvu4Hx0q2GCmbZ.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag (2 matches)         | anti-analysis/anti-debugging/debugger-detection      |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| enumerate files via ntdll functions                  | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get system information on Windows (5 matches)        | host-interaction/os/info                             |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| create or open registry key (7 matches)              | host-interaction/registry                            |
| query or enumerate registry key (3 matches)          | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| get kernel32 base address                            | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 16.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F7Gyvu4Hx0q2GCmbZ.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 44.878 sec (0 m 44 s)
Start Date: 2022:02:07 13:26:00
End Date:   2022:02:07 13:26:45

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:26:01Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F7Gyvu4Hx0q2GCmbZ.exe SCORE: 324 TYPE: EXE SIZE: 92160 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe321c5cfa0> 
MD5: 05cff15ab2be64cdb74c1a542802f7bb 
SHA1: 365064133164b804317734f29e503749c5be0791 
SHA256: 6f4a4f78ed11823f45fe9efeab507cbf8bbd90a415cd4151427b071ecc576dc0 CREATED: Mon Feb  7 13:26:00 2022 MODIFIED: Mon Feb  7 13:26:00 2022 ACCESSED: Mon Feb  7 13:26:49 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_13: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_14: Yara Rule MATCH: Debugger_Hiding__Thread SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetInformationThread
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:26:49Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		Debugger_Check__QueryInfo
60		Debugger_Hiding__Thread
20		isExecutable
10		Contains_PE_File

Score total: 324

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Debugger_Check__QueryInfo', '60'), ('Debugger_Hiding__Thread', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['324']
-------------- CAPA_Score ------------
['16.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5454.295913969028
============================================


==================================================================
Fichier HTTP-F7Gyvu4Hx0q2GCmbZ.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FYL40H2DjYkQ4CXvEj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FYL40H2DjYkQ4CXvEj.exe: Win.Malware.Jaik-9870661-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FYL40H2DjYkQ4CXvEj.exe: Win.Malware.Hacktoolx-9870688-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.22 MB
Data read: 0.21 MB (ratio 1.04:1)
Time: 42.397 sec (0 m 42 s)
Start Date: 2022:02:07 13:26:50
End Date:   2022:02:07 13:27:32

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Jaik-9870661-0
50		Win.Malware.Hacktoolx-9870688-0

Score total: 100.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:26:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FYL40H2DjYkQ4CXvEj.exe SCORE: 69 TYPE: EXE SIZE: 222720 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd6fef18fa0> 
MD5: bb7922d368a9a9c8d981837b5ad988f1 
SHA1: 340502b54df264b7bbe6574b0e5e5a5edb3dede6 
SHA256: 16b061de843d79b686a1b4e7d2bf601fb9fa7df12b843f83e2a01546df9558ec CREATED: Mon Feb  7 13:26:50 2022 MODIFIED: Mon Feb  7 13:26:50 2022 ACCESSED: Mon Feb  7 13:27:44 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_8: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:27:45Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE32
10		IsWindowsGUI
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 69

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Jaik-9870661-0', '50'), ('Win.Malware.Hacktoolx-9870688-0', '50')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['69']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['100.0']
-------------- SCORE FINAL ------------
2352.5017145923357
============================================


==================================================================
Fichier HTTP-FYL40H2DjYkQ4CXvEj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FsRP803OvVMs1yHlB5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1d8fd13c890060464019c0f07b928b1a                                                   |
| sha1                   | 1bbcc9ba8d4ce5a1c6ca0c757d826e39619f94c0                                           |
| sha256                 | 6bffe5385dd1321fe5b99dec3f8858be9ff99c8629c1c8d6f414eebaa663a710                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FsRP803OvVMs1yHlB5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Luhn [C0032.002]                                                    |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+---------------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                                    | NAMESPACE                                            |
|---------------------------------------------------------------+------------------------------------------------------|
| parse credit card information                                 | collection/credit-card                               |
| validate payment card number using luhn algorithm (2 matches) | data-manipulation/checksum/luhn                      |
| encrypt data using RC4 PRGA                                   | data-manipulation/encryption/rc4                     |
| get file size (2 matches)                                     | host-interaction/file-system/meta                    |
| move file                                                     | host-interaction/file-system/move                    |
| read .ini file                                                | host-interaction/file-system/read                    |
| read file on Windows                                          | host-interaction/file-system/read                    |
| write file on Windows                                         | host-interaction/file-system/write                   |
| print debug messages                                          | host-interaction/log/debug/write-event               |
| check mutex and exit                                          | host-interaction/mutex                               |
| read process memory                                           | host-interaction/process                             |
| allocate RWX memory                                           | host-interaction/process/inject                      |
| enumerate processes                                           | host-interaction/process/list                        |
| acquire debug privileges                                      | host-interaction/process/modify                      |
| modify access privileges                                      | host-interaction/process/modify                      |
| terminate process (2 matches)                                 | host-interaction/process/terminate                   |
+---------------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Discovery::Process Discovery [T1057;4]
2		- Discovery::File and Directory Discovery [T1083;2]
6		- Collection::Automated Collection [T1119;6]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Discovery::Software Discovery [T1518;4]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 24.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FsRP803OvVMs1yHlB5.exe: Win.Trojan.GetMyPass-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 41.854 sec (0 m 41 s)
Start Date: 2022:02:07 13:27:45
End Date:   2022:02:07 13:28:27

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.GetMyPass-1

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:27:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FsRP803OvVMs1yHlB5.exe SCORE: 949 TYPE: EXE SIZE: 17376 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe3320c8fa0> 
MD5: 1d8fd13c890060464019c0f07b928b1a 
SHA1: 1bbcc9ba8d4ce5a1c6ca0c757d826e39619f94c0 
SHA256: 6bffe5385dd1321fe5b99dec3f8858be9ff99c8629c1c8d6f414eebaa663a710 CREATED: Mon Feb  7 13:27:45 2022 MODIFIED: Mon Feb  7 13:27:45 2022 ACCESSED: Mon Feb  7 13:28:38 2022 
REASON_1: Malware Hash TYPE: SHA1 HASH: 1bbcc9ba8d4ce5a1c6ca0c757d826e39619f94c0 SUBSCORE: 100 DESC: Signed POS malware - Carbanak http://blog.trendmicro.com/trendlabs-security-intelligence/signed-pos-malware-us
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_6: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: win_getmypass_auto SUBSCORE: 45 
DESCRIPTION: Detects win.getmypass. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 52b928444000e83df1ffff6800800000 Str2: 8b45f88b4d088948048b55f8833a00 Str3: 894204eb1a8b4d0851 Str4: e817faffff83c40c8945a0837da0ff0f ... (truncated)
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec8b Str2: 558becff Str3: 558bec81 Str4: 558bec83 Str5: 558bec51 Str6: 558bec6a Str7: 558bec68 Str8: 558bec0f Str9: 558beca1 Str1 ... (truncated)
REASON_12: Yara Rule MATCH: Borland_Delphi_30_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_13: Yara Rule MATCH: Borland_Delphi_30_ SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_14: Yara Rule MATCH: Borland_Delphi_v40_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_15: Yara Rule MATCH: Borland_Delphi_v30 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_16: Yara Rule MATCH: Borland_Delphi_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_17: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_20: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: e013000000020200308213d206092a864886f70d010702a08213c3308213bf020101310b300906052b0e03021a05003068060a2b060104018237020104a05a3058303 ... (truncated)
REASON_21: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_22: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_24: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_25: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_26: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_27: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:28:39Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
70		escalate_priv
60		win_mutex
65		win_token
10		win_files_operation
10		misc_pe_signature
10		ft_exe
45		win_getmypass_auto
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Borland_Delphi_30_additional
70		Borland_Delphi_30_
70		Borland_Delphi_v40_v50
70		Borland_Delphi_v30
70		Borland_Delphi_DLL
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDigitalSignature
10		HasRichSignature
2		PE_File
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 949

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Collection::Automated Collection [T1119;6]', '6'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::Software Discovery [T1518;4]', '4'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.GetMyPass-1', '45')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100'), ('escalate_priv', '70'), ('win_mutex', '60'), ('win_token', '65'), ('win_files_operation', '10'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('win_getmypass_auto', '45'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Borland_Delphi_30_additional', '70'), ('Borland_Delphi_30_', '70'), ('Borland_Delphi_v40_v50', '70'), ('Borland_Delphi_v30', '70'), ('Borland_Delphi_DLL', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDigitalSignature', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['949']
-------------- CAPA_Score ------------
['24.0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
16086.015787355873
============================================


==================================================================
Fichier HTTP-FsRP803OvVMs1yHlB5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3q4r32WP3qCngH6X6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:28:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3q4r32WP3qCngH6X6.exe SCORE: 649 TYPE: EXE SIZE: 65539 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd2ace43fa0> 
MD5: f0a6a1bd6d760497623611e8297a81df 
SHA1: 43a0c32e8c6c1c8d78c43550bcfa5740e27fdbb4 
SHA256: e50aaa300d13af1aeb4e5f06e89fe14d02300c6e27932f0c296e6706a4170963 CREATED: Mon Feb  7 13:28:39 2022 MODIFIED: Mon Feb  7 13:28:39 2022 ACCESSED: Mon Feb  7 13:29:15 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: PE_Lock_NT_v201_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60
REASON_5: Yara Rule MATCH: PE_Lock_NT_v204_MARQUISDESOIRE SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60eb03cd20ebeb01ebe803000000e9eb04584050c3
REASON_6: Yara Rule MATCH: PELOCKnt_204 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60
REASON_7: Yara Rule MATCH: PELOCKnt_204_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60
REASON_8: Yara Rule MATCH: PE_Lock_NT_v204 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60eb03cd20ebeb01ebe803000000e9eb04584050c3
REASON_9: Yara Rule MATCH: PELockNTv204 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60eb03cd20ebeb01ebe803000000e9eb04584050c3
REASON_10: Yara Rule MATCH: PELOCKnt204 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: PELOCKnt
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:29:15Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		PE_Lock_NT_v201_additional
70		PE_Lock_NT_v204_MARQUISDESOIRE
70		PELOCKnt_204
70		PELOCKnt_204_additional
70		PE_Lock_NT_v204
70		PELockNTv204
70		PELOCKnt204
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
60		suspicious_packer_section
20		isExecutable
10		Contains_PE_File

Score total: 649

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3q4r32WP3qCngH6X6.exe: Win.Worm.Hai-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 40.573 sec (0 m 40 s)
Start Date: 2022:02:07 13:28:39
End Date:   2022:02:07 13:29:20

-------- Score ----------------
Scores		Rules
.......		...............
35		Win.Worm.Hai-1

Score total: 35.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Worm.Hai-1', '35')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('PE_Lock_NT_v201_additional', '70'), ('PE_Lock_NT_v204_MARQUISDESOIRE', '70'), ('PELOCKnt_204', '70'), ('PELOCKnt_204_additional', '70'), ('PE_Lock_NT_v204', '70'), ('PELockNTv204', '70'), ('PELOCKnt204', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('suspicious_packer_section', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['649']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['35.0']
-------------- SCORE FINAL ------------
10726.580713200585
============================================


==================================================================
Fichier HTTP-F3q4r32WP3qCngH6X6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FYm9VC3YKDRn9W87kf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 82ef69ecabf12160625a6ba15d2a2671                                                   |
| sha1                   | 5e590f68d63ba7ddf86c822498faa944a4e0990a                                           |
| sha256                 | 4ab78dc788cead8f20227c9e2abfbefd5e74c64c85677c505ae7e694b7d41565                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FYm9VC3YKDRn9W87kf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get system information on Windows                    | host-interaction/os/info                             |
| query or enumerate registry value (4 matches)        | host-interaction/registry                            |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::Query Registry [T1012;1]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 5.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:29:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FYm9VC3YKDRn9W87kf.exe SCORE: 434 TYPE: EXE SIZE: 79032 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8125654fa0> 
MD5: 82ef69ecabf12160625a6ba15d2a2671 
SHA1: 5e590f68d63ba7ddf86c822498faa944a4e0990a 
SHA256: 4ab78dc788cead8f20227c9e2abfbefd5e74c64c85677c505ae7e694b7d41565 CREATED: Mon Feb  7 13:29:20 2022 MODIFIED: Mon Feb  7 13:29:20 2022 ACCESSED: Mon Feb  7 13:30:01 2022 
REASON_1: Yara Rule MATCH: cred_local SUBSCORE: 80 
DESCRIPTION: Steal credential REF: - AUTHOR: x0r 
MATCHES: Str1: SamQueryInformationUse
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e83b0300004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_11: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:30:02Z

-------- Score ----------------
Scores		Rules
.......		...............
80		cred_local
20		win_registry
65		win_token
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 434

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FYm9VC3YKDRn9W87kf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 43.154 sec (0 m 43 s)
Start Date: 2022:02:07 13:29:20
End Date:   2022:02:07 13:30:03

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('cred_local', '80'), ('win_registry', '20'), ('win_token', '65'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['434']
-------------- CAPA_Score ------------
['5.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6978.199571029675
============================================


==================================================================
Fichier HTTP-FYm9VC3YKDRn9W87kf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FQLdyQ3GEGU1DdglXf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FQLdyQ3GEGU1DdglXf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 44.004 sec (0 m 44 s)
Start Date: 2022:02:07 13:30:03
End Date:   2022:02:07 13:30:47

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:30:03Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FQLdyQ3GEGU1DdglXf.exe SCORE: 439 TYPE: EXE SIZE: 12288 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3896fc0fa0> 
MD5: 68eaaa29813d706f4024af83cf3b88dc 
SHA1: db773a25602a3b3b678ce89e26ea85ab5b8ee59b 
SHA256: b756a02776b6b33394b255ba99f4cc0379cccbe080f36fd80034a5a6e2ffaa3e CREATED: Mon Feb  7 13:30:03 2022 MODIFIED: Mon Feb  7 13:30:03 2022 ACCESSED: Mon Feb  7 13:30:55 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: PECompact_v110b2_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb066877150000c39c60e80200000033c08bc483c004938be38b5bfc81
REASON_6: Yara Rule MATCH: PECompact_v14xp_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb066877150000c39c60e80200000033c08bc483c004938be38b5bfc81
REASON_7: Yara Rule MATCH: PECompact_v14xp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb066877150000c39c60e80200000033c08bc483c004938be38b5bfc81
REASON_8: Yara Rule MATCH: PECompactv14x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: eb066877150000c39c60e80200000033c08bc483c004938be38b5bfc81
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: pec1 Str2: pec2
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:30:55Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_7
5		executable_pe
70		PECompact_v110b2_additional
70		PECompact_v14xp_additional
70		PECompact_v14xp
70		PECompactv14x
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasRichSignature
2		PE_File
60		suspicious_packer_section
20		isExecutable
10		Contains_PE_File

Score total: 439

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_7', '2'), ('executable_pe', '5'), ('PECompact_v110b2_additional', '70'), ('PECompact_v14xp_additional', '70'), ('PECompact_v14xp', '70'), ('PECompactv14x', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('suspicious_packer_section', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['439']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6957.681114904287
============================================


==================================================================
Fichier HTTP-FQLdyQ3GEGU1DdglXf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FkajG83KKwytZKT1f8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5247539e5510a12bb64bdef04027befb                                                   |
| sha1                   | c4ddbb32c13e207ce722774973d8763b47136155                                           |
| sha256                 | 2fb7c331a06b426c128ef653eb3496d0f8c8ef9a7d32195b9b660e559e6933c9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FkajG83KKwytZKT1f8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (17 matches)  | host-interaction/driver                              |
| terminate process via fastfail (13 matches)          | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
2		- Execution::Shared Modules [T1129;2]

Score total: 6.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FkajG83KKwytZKT1f8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 43.958 sec (0 m 43 s)
Start Date: 2022:02:07 13:30:56
End Date:   2022:02:07 13:31:40

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:30:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FkajG83KKwytZKT1f8.exe SCORE: 364 TYPE: EXE SIZE: 86864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fda6516ffa0> 
MD5: 5247539e5510a12bb64bdef04027befb 
SHA1: c4ddbb32c13e207ce722774973d8763b47136155 
SHA256: 2fb7c331a06b426c128ef653eb3496d0f8c8ef9a7d32195b9b660e559e6933c9 CREATED: Mon Feb  7 13:30:56 2022 MODIFIED: Mon Feb  7 13:30:56 2022 ACCESSED: Mon Feb  7 13:31:48 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8eb0400004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:31:48Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 364

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['364']
-------------- CAPA_Score ------------
['6.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5888.726959456586
============================================


==================================================================
Fichier HTTP-FkajG83KKwytZKT1f8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FcaGop2foduztTTHxk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dc4dc746d8a14060fb5fc7edd4ef5282                                                   |
| sha1                   | b0f1a213545cd7bc06ce9ee42709a2b45af06b28                                           |
| sha256                 | 3cf53c1ad414913e4d57a4d6f319938cafa6edb62a5e3f7b797658f90c0ceea9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FcaGop2foduztTTHxk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| write file on Windows                                | host-interaction/file-system/write                   |
| terminate process (2 matches)                        | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
| reference NCR ATM library routines                   | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FcaGop2foduztTTHxk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 44.028 sec (0 m 44 s)
Start Date: 2022:02:07 13:31:48
End Date:   2022:02:07 13:32:33

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:31:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FcaGop2foduztTTHxk.exe SCORE: 239 TYPE: EXE SIZE: 16384 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4335eebfa0> 
MD5: dc4dc746d8a14060fb5fc7edd4ef5282 
SHA1: b0f1a213545cd7bc06ce9ee42709a2b45af06b28 
SHA256: 3cf53c1ad414913e4d57a4d6f319938cafa6edb62a5e3f7b797658f90c0ceea9 CREATED: Mon Feb  7 13:31:49 2022 MODIFIED: Mon Feb  7 13:31:49 2022 ACCESSED: Mon Feb  7 13:32:34 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Nullsoft_PiMP_Install_System_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 83ec14535556
REASON_6: Yara Rule MATCH: Nullsoft_PiMP_Install_System SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 83ec14535556
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:32:34Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Nullsoft_PiMP_Install_System_additional
70		Nullsoft_PiMP_Install_System
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 239

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Nullsoft_PiMP_Install_System_additional', '70'), ('Nullsoft_PiMP_Install_System', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['239']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3827.7999762814384
============================================


==================================================================
Fichier HTTP-FcaGop2foduztTTHxk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAN04p1tUjTmWbK1Kb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | cb612bd0353ba7151c1e6898b6e962c8                                                   |
| sha1                   | b4cbfac922bbc0b99f8e8ce30ee9c2db893be21c                                           |
| sha256                 | 6248846240929afd09bd74fb91d08617e5cf07314c219562f37dc28e30474684                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAN04p1tUjTmWbK1Kb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:32:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FAN04p1tUjTmWbK1Kb.exe SCORE: 109 TYPE: EXE SIZE: 183808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f828ea61fa0> 
MD5: cb612bd0353ba7151c1e6898b6e962c8 
SHA1: b4cbfac922bbc0b99f8e8ce30ee9c2db893be21c 
SHA256: 6248846240929afd09bd74fb91d08617e5cf07314c219562f37dc28e30474684 CREATED: Mon Feb  7 13:32:35 2022 MODIFIED: Mon Feb  7 13:32:35 2022 ACCESSED: Mon Feb  7 13:33:12 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:33:13Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_7
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		IsPacked
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAN04p1tUjTmWbK1Kb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 43.686 sec (0 m 43 s)
Start Date: 2022:02:07 13:32:35
End Date:   2022:02:07 13:33:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_7', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('IsPacked', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['109']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1747.4862029323024
============================================


==================================================================
Fichier HTTP-FAN04p1tUjTmWbK1Kb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FRy1YY2Tn6hRSNvm5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FRy1YY2Tn6hRSNvm5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.66 MB
Data read: 0.84 MB (ratio 1.98:1)
Time: 49.537 sec (0 m 49 s)
Start Date: 2022:02:07 13:33:19
End Date:   2022:02:07 13:34:08

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:33:19Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FRy1YY2Tn6hRSNvm5.exe SCORE: 2144 TYPE: EXE SIZE: 878592 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9cc9157fa0> 
MD5: 5fbbfeed28b258c42e0cfeb16718b31c 
SHA1: 43e862583a091f3a88be2cee1b2c44892154dc32 
SHA256: 9b721175dcac05edf402c9b7eebe167270603c039310acdb5e609628fd591ad0 CREATED: Mon Feb  7 13:33:19 2022 MODIFIED: Mon Feb  7 13:33:19 2022 ACCESSED: Mon Feb  7 13:34:11 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CreateService Str4: ControlService Str5: StartService Str6: QueryServiceStatus
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: RegCloseKey
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: OpenProcessToken
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: Kernel32.dll Str3: KERNEL32.dll Str4: WriteFile Str5: SetFilePointer Str6: ReadFile Str7: FindClose Str8: CopyFile
REASON_7: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: ConventionEngine_Anomaly_OutsideOfDebug SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453f14648d77cd4d94186c369b86649ad7601000000583a5c5057445352565c41524d36345c52656c656173655c5057445352562e70646200
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: Microsoft_Visual_Basic_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: h
REASON_14: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_17: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_34: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_35: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_36: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_37: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_38: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_39: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: CallNextHookEx
REASON_40: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_41: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_42: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: nUI.exe
REASON_43: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_44: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_45: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: fdfb8cfc2e4d170431fb6b8c67210672 Str2: a7eb3390a15bcd2c80a978c75f2dcc4f Str3: 941dd5f1c32c7cec49703f0dfde8eba5 Str4: d2611745022d67cf ... (truncated)
REASON_46: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:34:13Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_service
65		screenshot
80		keylogger
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Http_API
10		ft_exe
50		ConventionEngine_Anomaly_OutsideOfDebug
2		math_entropy_6
5		executable_pe
15		dll_injection_hook
70		Microsoft_Visual_Basic_v50
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Anti_Automated_Sandbox
35		Win_Hook_v12
60		Debugger_Check__QueryInfo
60		DebuggerException__SetConsoleCtrl_v1
50		Antivirus_strings
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
20		Advapi_Hash_API

Score total: 2144

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5fbbfeed28b258c42e0cfeb16718b31c                                                   |
| sha1                   | 43e862583a091f3a88be2cee1b2c44892154dc32                                           |
| sha256                 | 9b721175dcac05edf402c9b7eebe167270603c039310acdb5e609628fd591ad0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FRy1YY2Tn6hRSNvm5.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
|                        | Clipboard Data:: \[T1115]\                                                         |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                            |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
|                             | Keylogging::Polling [F0002.002]                                               |
| COMMUNICATION               | Interprocess Communication::Create Pipe [C0003.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Encryption Key:: [C0028]                                                      |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::CRC32 [C0032.001]                                                   |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Console:: [C0033]                                                             |
|                             | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                                  | NAMESPACE                                            |
|-------------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints                              | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount                       | anti-analysis/anti-debugging/debugger-detection      |
| timestomp file (2 matches)                                  | anti-analysis/anti-forensic/timestomp                |
| execute anti-VM instructions                                | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings                             | anti-analysis/obfuscation/string/stackstring         |
| parse credit card information                               | collection/credit-card                               |
| log keystrokes via application hook                         | collection/keylog                                    |
| log keystrokes via polling                                  | collection/keylog                                    |
| create pipe                                                 | communication/named-pipe/create                      |
| hash data with CRC32 (2 matches)                            | data-manipulation/checksum/crc32                     |
| create new key via CryptAcquireContext                      | data-manipulation/encryption                         |
| hash data via WinCrypt                                      | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                             | data-manipulation/hashing                            |
| hash data with MD5                                          | data-manipulation/hashing/md5                        |
| contains PDB path                                           | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                          | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (6 matches)         | executable/resource                                  |
| contain an embedded PE file                                 | executable/subfile/pe                                |
| manipulate boot configuration (3 matches)                   | host-interaction/bootloader                          |
| replace clipboard data                                      | host-interaction/clipboard                           |
| manipulate console (3 matches)                              | host-interaction/console                             |
| query environment variable (3 matches)                      | host-interaction/environment-variable                |
| set environment variable (2 matches)                        | host-interaction/environment-variable                |
| get common file path (3 matches)                            | host-interaction/file-system                         |
| read raw disk data                                          | host-interaction/file-system                         |
| copy file (2 matches)                                       | host-interaction/file-system/copy                    |
| create directory                                            | host-interaction/file-system/create                  |
| delete directory                                            | host-interaction/file-system/delete                  |
| delete file (6 matches)                                     | host-interaction/file-system/delete                  |
| check if file exists (11 matches)                           | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions (9 matches)          | host-interaction/file-system/files/list              |
| get file attributes (14 matches)                            | host-interaction/file-system/meta                    |
| get file size (3 matches)                                   | host-interaction/file-system/meta                    |
| get file version info                                       | host-interaction/file-system/meta                    |
| set file attributes (7 matches)                             | host-interaction/file-system/meta                    |
| move file                                                   | host-interaction/file-system/move                    |
| read .ini file (4 matches)                                  | host-interaction/file-system/read                    |
| read file on Windows (14 matches)                           | host-interaction/file-system/read                    |
| read file via mapping                                       | host-interaction/file-system/read                    |
| write file on Windows (11 matches)                          | host-interaction/file-system/write                   |
| enumerate gui resources                                     | host-interaction/gui                                 |
| get graphical window text (15 matches)                      | host-interaction/gui/window/get-text                 |
| hide graphical window (2 matches)                           | host-interaction/gui/window/hide                     |
| enumerate disk volumes                                      | host-interaction/hardware/storage                    |
| get disk information (17 matches)                           | host-interaction/hardware/storage                    |
| get disk size (3 matches)                                   | host-interaction/hardware/storage                    |
| get storage device properties (4 matches)                   | host-interaction/hardware/storage                    |
| get system information on Windows (3 matches)               | host-interaction/os/info                             |
| check OS version                                            | host-interaction/os/version                          |
| get thread local storage value (20 matches)                 | host-interaction/process                             |
| read process memory                                         | host-interaction/process                             |
| set thread local storage value (4 matches)                  | host-interaction/process                             |
| create a process with modified I/O handles and window       | host-interaction/process/create                      |
| create process on Windows (11 matches)                      | host-interaction/process/create                      |
| allocate RWX memory (2 matches)                             | host-interaction/process/inject                      |
| enumerate processes (2 matches)                             | host-interaction/process/list                        |
| create registry key via offline registry library            | host-interaction/registry                            |
| open registry key via offline registry library (3 matches)  | host-interaction/registry                            |
| query or enumerate registry value (8 matches)               | host-interaction/registry                            |
| query registry key via offline registry library (3 matches) | host-interaction/registry                            |
| set registry key via offline registry library (2 matches)   | host-interaction/registry                            |
| set registry value (7 matches)                              | host-interaction/registry/create                     |
| delete registry key                                         | host-interaction/registry/delete                     |
| query service status                                        | host-interaction/service                             |
| create service (2 matches)                                  | host-interaction/service/create                      |
| start service                                               | host-interaction/service/start                       |
| stop service                                                | host-interaction/service/stop                        |
| get token membership                                        | host-interaction/session                             |
| create thread (2 matches)                                   | host-interaction/thread/create                       |
| link many functions at runtime (6 matches)                  | linking/runtime-linking                              |
| parse PE exports                                            | load-code/pe                                         |
| parse PE header (41 matches)                                | load-code/pe                                         |
| persist via Windows service (2 matches)                     | persistence/service                                  |
+-------------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Discovery::File and Directory Discovery [T1083;2]
6		- Collection::Automated Collection [T1119;6]
3		- Execution::System Services::Service Execution [T1569.002;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
9		- Impact::Service Stop [T1489;9]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
6		- Collection::Clipboard Data [T1115;6]
2		- Execution::Shared Modules [T1129;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 109.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Collection::Automated Collection [T1119;6]', '6'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;5]', '5'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Collection::Clipboard Data [T1115;6]', '6'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('create_service', '45'), ('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('ConventionEngine_Anomaly_OutsideOfDebug', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('dll_injection_hook', '15'), ('Microsoft_Visual_Basic_v50', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Anti_Automated_Sandbox', '35'), ('Win_Hook_v12', '35'), ('Debugger_Check__QueryInfo', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('Antivirus_strings', '50'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['2144']
-------------- CAPA_Score ------------
['109.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
36164.92228125719
============================================


==================================================================
Fichier HTTP-FRy1YY2Tn6hRSNvm5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FQoZUi2KpV6Iemb2ja.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b792676216706673b65d67916460299f                                                   |
| sha1                   | 7e7351664daea80efcf57c7a55e413c59bf53ba2                                           |
| sha256                 | 15e3a70fd3f2972cd8d7826dfe4058255b0fbb974969828644d93256f7fb9c12                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FQoZUi2KpV6Iemb2ja.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FQoZUi2KpV6Iemb2ja.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 44.719 sec (0 m 44 s)
Start Date: 2022:02:07 13:35:12
End Date:   2022:02:07 13:35:57

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:35:13Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FQoZUi2KpV6Iemb2ja.exe SCORE: 229 TYPE: EXE SIZE: 24576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9f36347fa0> 
MD5: b792676216706673b65d67916460299f 
SHA1: 7e7351664daea80efcf57c7a55e413c59bf53ba2 
SHA256: 15e3a70fd3f2972cd8d7826dfe4058255b0fbb974969828644d93256f7fb9c12 CREATED: Mon Feb  7 13:35:12 2022 MODIFIED: Mon Feb  7 13:35:12 2022 ACCESSED: Mon Feb  7 13:36:03 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:36:03Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3828.9316422328375
============================================


==================================================================
Fichier HTTP-FQoZUi2KpV6Iemb2ja.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fu1v3w1olgPBWK4yMf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7a2e485d1bea00ee5907e4cc02cb2552                                                   |
| sha1                   | c5b482c79be28e1e8dcaf489a88a586b80e2482c                                           |
| sha256                 | b3b4c065849c81d856558e9cf91e8cef5d481648fd8aa88cdda534ab6b75e988                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fu1v3w1olgPBWK4yMf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+------------------------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                                   |
|-----------------------------+------------------------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                                            |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                                     |
|                             | Virtual Machine Detection::Unique Hardware/Firmware Check - I/O Communication Port [B0009.025] |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                                         |
| EXECUTION                   | Install Additional Program:: [B0023]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                                      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                                      |
|                             | Registry::Open Registry Key [C0036.003]                                                        |
|                             | Registry::Query Registry Key [C0036.005]                                                       |
| PROCESS                     | Create Process:: [C0017]                                                                       |
|                             | Create Process::Create Suspended Process [C0017.003]                                           |
|                             | Create Thread:: [C0038]                                                                        |
|                             | Resume Thread:: [C0054]                                                                        |
+-----------------------------+------------------------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions                         | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| reference the VMWare IO port                         | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| get common file path                                 | host-interaction/file-system                         |
| read process memory                                  | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| inject dll                                           | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| query or enumerate registry key                      | host-interaction/registry                            |
| link function at runtime on Windows (3 matches)      | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Execution::Shared Modules [T1129;2]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
2		- Discovery::File and Directory Discovery [T1083;2]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 39.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fu1v3w1olgPBWK4yMf.exe: Win.Malware.Explorerhijack-9937586-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-Fu1v3w1olgPBWK4yMf.exe: Win.Malware.Explorerhijack-9937587-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-Fu1v3w1olgPBWK4yMf.exe: Win.Trojan.Agent-663582 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.480 sec (0 m 43 s)
Start Date: 2022:02:07 13:36:03
End Date:   2022:02:07 13:36:47

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Explorerhijack-9937586-0
50		Win.Malware.Explorerhijack-9937587-0
70		Win.Trojan.Agent-663582
75		Win.Trojan.Agent-663582
45		Win.Trojan.Agent-663582

Score total: 290.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:36:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fu1v3w1olgPBWK4yMf.exe SCORE: 784 TYPE: EXE SIZE: 45056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe98745bfa0> 
MD5: 7a2e485d1bea00ee5907e4cc02cb2552 
SHA1: c5b482c79be28e1e8dcaf489a88a586b80e2482c 
SHA256: b3b4c065849c81d856558e9cf91e8cef5d481648fd8aa88cdda534ab6b75e988 CREATED: Mon Feb  7 13:36:03 2022 MODIFIED: Mon Feb  7 13:36:03 2022 ACCESSED: Mon Feb  7 13:36:47 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegOpenKeyExA Str3: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645c800c645c950c645ca56c645 Str2: c645c950c645ca56c645cb00c645 Str3: c645ca56c645cb00c645cc0cc645 Str4: c645cb00c645cc0cc645cd29c645 ... (truncated)
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68d020400068301b400064a100000000506489250000000083ec20535657
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c020400068301b400064a10000000050 Str2: 558bec6aff68d020400068301b400064a10000000050
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c020400068301b400064a10000000050 Str2: 558bec6aff68d020400068301b400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83 Str2: 558bec51 Str3: 558bec81 Str4: 558bec57 Str5: 558bec6a Str6: 558bec6aff68c020400068301b400064a10000000050 Str7: 558bec6 ... (truncated)
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c020400068301b400064a1000000005064892500000000 Str2: 558bec6aff68d020400068301b400064a1000000005064892500000000
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: vmware Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_17: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_18: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_19: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_21: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:36:48Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		ft_exe
2		math_entropy_4
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_thread
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsConsole
10		HasRichSignature
2		PE_File
35		VMWare_Detection
60		antivm_vmware
60		vmdetect_2
60		ThreadControl__Context_v1
40		SEH_Init
60		vmdetect
20		isExecutable
10		Contains_PE_File

Score total: 784

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]', '6'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]', '5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]', '5'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Explorerhijack-9937586-0', '50'), ('Win.Malware.Explorerhijack-9937587-0', '50'), ('Win.Trojan.Agent-663582', '70'), ('Win.Trojan.Agent-663582', '75'), ('Win.Trojan.Agent-663582', '45')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('dll_injection_thread', '15'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('VMWare_Detection', '35'), ('antivm_vmware', '60'), ('vmdetect_2', '60'), ('ThreadControl__Context_v1', '60'), ('SEH_Init', '40'), ('vmdetect', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['784']
-------------- CAPA_Score ------------
['39.0']
-------------- CLAMAV_Score ------------
['290.0']
-------------- SCORE FINAL ------------
16854.598625936076
============================================


==================================================================
Fichier HTTP-Fu1v3w1olgPBWK4yMf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FiwoxlybfNTiba3wg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e43555271a5a44c962d09844e7adc137                                                   |
| sha1                   | afbceceee83031342fd035141c44c0affeae274b                                           |
| sha256                 | 3d761e69cbbfe3055677c6b5ab296919c940ad0a55cc527fdab8cf52bacd487b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FiwoxlybfNTiba3wg.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:36:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FiwoxlybfNTiba3wg.exe SCORE: 129 TYPE: EXE SIZE: 66448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6d4dcdffa0> 
MD5: e43555271a5a44c962d09844e7adc137 
SHA1: afbceceee83031342fd035141c44c0affeae274b 
SHA256: 3d761e69cbbfe3055677c6b5ab296919c940ad0a55cc527fdab8cf52bacd487b CREATED: Mon Feb  7 13:36:48 2022 MODIFIED: Mon Feb  7 13:36:48 2022 ACCESSED: Mon Feb  7 13:37:26 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:37:27Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
2		math_entropy_4
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 129

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FiwoxlybfNTiba3wg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 42.520 sec (0 m 42 s)
Start Date: 2022:02:07 13:36:48
End Date:   2022:02:07 13:37:31

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('ImportTableIsBad', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['129']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2064.464841424525
============================================


==================================================================
Fichier HTTP-FiwoxlybfNTiba3wg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FPer7c3FbQS1bCw8L2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5d7c34b6854d48d3da4f96b71550a221                                                   |
| sha1                   | 1f0e20fbc74b4a7b1d73a0a6ac131f9543bd6cbb                                           |
| sha256                 | bec31fc132cff00910cb07cf9d66c9fcf5ff511f8182b61622a18843f0fd5841                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FPer7c3FbQS1bCw8L2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| read and send data from client to server             | c2/file-transfer                                     |
| receive and write data from server to client         | c2/file-transfer                                     |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration                             | communication/socket                                 |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]

Score total: 19.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FPer7c3FbQS1bCw8L2.exe: Win.Trojan.Generickd-7 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 32.265 sec (0 m 32 s)
Start Date: 2022:02:07 13:37:31
End Date:   2022:02:07 13:38:03

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Generickd-7

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:37:31Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FPer7c3FbQS1bCw8L2.exe SCORE: 634 TYPE: EXE SIZE: 28672 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f18adcfcfa0> 
MD5: 5d7c34b6854d48d3da4f96b71550a221 
SHA1: 1f0e20fbc74b4a7b1d73a0a6ac131f9543bd6cbb 
SHA256: bec31fc132cff00910cb07cf9d66c9fcf5ff511f8182b61622a18843f0fd5841 CREATED: Mon Feb  7 13:37:31 2022 MODIFIED: Mon Feb  7 13:37:31 2022 ACCESSED: Mon Feb  7 13:38:23 2022 
REASON_1: Malware Hash TYPE: MD5 HASH: 5d7c34b6854d48d3da4f96b71550a221 SUBSCORE: 100 DESC: Analysis of DHS NCCIC Indicators (2014) https://www.secureworks.com/research/analysis-of-dhs-nccic-indicators
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_simplefilemover_auto SUBSCORE: 45 
DESCRIPTION: Detects win.simplefilemover. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8bfcf3a5e8def2ffff81c42002000085c0 Str2: 7d0733c0e9ee0100006820020000 Str3: 8b9540daffffd1e2528d855cfaffff50 Str4: 518d9524daffff52e8 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68d0304000686022400064a100000000506489250000000083ec20535657
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68d0304000686022400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68d0304000686022400064a10000000050
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83 Str2: 558bec56 Str3: 558bec68 Str4: 558becb8 Str5: 558bec81 Str6: 558bec6a Str7: 558bec6aff68d0304000686022400064a1000000005 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68d0304000686022400064a1000000005064892500000000
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:38:23Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
45		win_simplefilemover_auto
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsConsole
10		HasRichSignature
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 634

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Generickd-7', '45')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('win_simplefilemover_auto', '45'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['634']
-------------- CAPA_Score ------------
['19.0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
10993.839115354922
============================================


==================================================================
Fichier HTTP-FPer7c3FbQS1bCw8L2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FRmpC4WYDWgzRRxOi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ca042c9a80d01c409c740d0437942b4e                                                   |
| sha1                   | 715146caa48d94a6ae2f6f0b2d5268296d51773e                                           |
| sha256                 | cdaa7d2fd4328877fcab873cfa85b6b46b0a1afa6cc39017ced21dcfb139bba7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FRmpC4WYDWgzRRxOi.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| check OS version                                     | host-interaction/os/version                          |
| terminate process via fastfail (71 matches)          | host-interaction/process/terminate                   |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 7.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FRmpC4WYDWgzRRxOi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.11 MB
Data read: 0.11 MB (ratio 1.00:1)
Time: 43.242 sec (0 m 43 s)
Start Date: 2022:02:07 13:38:24
End Date:   2022:02:07 13:39:07

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:38:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FRmpC4WYDWgzRRxOi.exe SCORE: 264 TYPE: EXE SIZE: 120320 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9f0db2dfa0> 
MD5: ca042c9a80d01c409c740d0437942b4e 
SHA1: 715146caa48d94a6ae2f6f0b2d5268296d51773e 
SHA256: cdaa7d2fd4328877fcab873cfa85b6b46b0a1afa6cc39017ced21dcfb139bba7 CREATED: Mon Feb  7 13:38:24 2022 MODIFIED: Mon Feb  7 13:38:24 2022 ACCESSED: Mon Feb  7 13:39:13 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0600004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:39:14Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 264

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['264']
-------------- CAPA_Score ------------
['7.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4333.762701720006
============================================


==================================================================
Fichier HTTP-FRmpC4WYDWgzRRxOi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFMYiG2whFdpKW4ztd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFMYiG2whFdpKW4ztd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777979
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.51 MB
Data read: 0.48 MB (ratio 1.06:1)
Time: 37.966 sec (0 m 37 s)
Start Date: 2022:02:07 13:39:14
End Date:   2022:02:07 13:39:52

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 8-9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 8-9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:39:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFMYiG2whFdpKW4ztd.exe SCORE: 894 TYPE: EXE SIZE: 503808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb56633dfa0> 
MD5: 6f99a2c8944cb02ff28c6f9ced59b161 
SHA1: 2dcb89d0f72d854bef6fbca73fd7fbe503673bd0 
SHA256: c4bb8f54e3b4577bb391c0f283d1161d5636764c40f97c799b017ce5db6dbcb3 CREATED: Mon Feb  7 13:39:14 2022 MODIFIED: Mon Feb  7 13:39:14 2022 ACCESSED: Mon Feb  7 13:40:06 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: NtWriteVirtualMemory Str4: CreateThread
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetOpenUrl Str5: InternetReadFile Str6: HttpOpenRequest Str7: HttpSen ... (truncated)
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: socket Str3: connect
REASON_4: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_5: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_6: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_7: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA Str6: FindFirstFileA Str7: MoveFileExA Str8: FindC ... (truncated)
REASON_8: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_9: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_10: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_11: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_12: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: win_megumin_auto SUBSCORE: 45 
DESCRIPTION: Detects win.megumin. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 83bde8fbffff100f438dd4fbffff2bf203cf89b5e4fbffff2bf746 Str2: c78514ffffff00000000c78518ffffff0f000000e8489bfeff8b8d1cffffff8b531841c7 ... (truncated)
REASON_14: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445307583034e0a56d49a76d8cffa443ec6301000000433a5c55736572735c41646d696e6973747261746f725c4465736b746f705c4d6567756d696e56325c526 ... (truncated)
REASON_15: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445307583034e0a56d49a76d8cffa443ec6301000000433a5c55736572735c41646d696e6973747261746f725c4465736b746f705c4d6567756d696e56325c526 ... (truncated)
REASON_16: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_21: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_22: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_24: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_25: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_26: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_27: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: NtWriteVirtualMemory Str4: CreateThread
REASON_28: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_29: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_30: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_31: Yara Rule MATCH: browser_pass SUBSCORE: 10 
DESCRIPTION: This module is intended for forensicators and pen-testers to find passwords in memory that can help their case/engagement. REF: https://github.com/swoodsec/YARA-RULES/blob/master/browserpass.yar AUTHOR: swood 
MATCHES: Str1: pass=
REASON_32: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_33: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_34: Yara Rule MATCH: Big_Numbers3 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 64:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 21cf114e8a601f49a4b9d36250840853917a34072663f9c8beea3b45e8f129c5 Str2: 750144f9777a15f981a79e297849a140917a34072663f9c8beea3b45e8f129 ... (truncated)
REASON_35: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
REASON_36: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:40:07Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		network_http
50		network_tcp_socket
60		win_mutex
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
45		win_megumin_auto
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
45		Inject_Thread
40		SEH_Save
40		SEH_Init
10		anti_dbg
10		browser_pass
20		isExecutable
10		Contains_PE_File
10		Big_Numbers3
20		MD5_Constants
5		BASE64_table

Score total: 894

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6f99a2c8944cb02ff28c6f9ced59b161                                                   |
| sha1                   | 2dcb89d0f72d854bef6fbca73fd7fbe503673bd0                                           |
| sha256                 | c4bb8f54e3b4577bb391c0f283d1161d5636764c40f97c799b017ce5db6dbcb3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFMYiG2whFdpKW4ztd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                  |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Location Discovery:: \[T1614]\                                               |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Resource Hijacking:: \[T1496]\                                                      |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Create UDP Socket [C0001.010]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| get geographical location                            | collection                                           |
| receive data (3 matches)                             | communication                                        |
| send data (6 matches)                                | communication                                        |
| send HTTP request with Host header                   | communication/http                                   |
| get HTTP response content encoding                   | communication/http/client                            |
| creates tcp or udp socket                            | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| create UDP socket                                    | communication/socket/udp/send                        |
| act as TCP client                                    | communication/tcp/client                             |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| read clipboard data                                  | host-interaction/clipboard                           |
| replace clipboard data                               | host-interaction/clipboard                           |
| query environment variable                           | host-interaction/environment-variable                |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path (6 matches)                     | host-interaction/file-system                         |
| get file system object information                   | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory (3 matches)                         | host-interaction/file-system/create                  |
| delete file                                          | host-interaction/file-system/delete                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| create shortcut via IShellLink                       | host-interaction/file-system/write                   |
| write file on Windows                                | host-interaction/file-system/write                   |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| get keyboard layout                                  | host-interaction/hardware/keyboard/layout            |
| get disk information                                 | host-interaction/hardware/storage                    |
| check mutex and exit                                 | host-interaction/mutex                               |
| resolve DNS (2 matches)                              | host-interaction/network/dns/resolve                 |
| allocate thread local storage (3 matches)            | host-interaction/process                             |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| create process on Windows (11 matches)               | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| enumerate processes on remote desktop session host   | host-interaction/process/list                        |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process by name                            | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| get session user name                                | host-interaction/session                             |
| create thread (5 matches)                            | host-interaction/thread/create                       |
| mine cryptocurrency                                  | impact/cryptocurrency                                |
| access PEB ldr_data (2 matches)                      | linking/runtime-linking                              |
| linked against CPP regex library                     | linking/static/cppregex                              |
| parse PE header (4 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Discovery::File and Directory Discovery [T1083;2]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1.5		- Discovery::System Location Discovery [T1614;1.5]
4		- Discovery::Application Window Discovery [T1010;4]
8		- Impact::Resource Hijacking [T1496;8]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6		- Collection::Clipboard Data [T1115;6]
3		- Discovery::System Network Configuration Discovery [T1016;3]
3		- Discovery::Account Discovery [T1087;3]
2		- Execution::Shared Modules [T1129;2]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 89.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]', '5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Impact::Resource Hijacking [T1496;8]', '8'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;5]', '5'), ('- Collection::Clipboard Data [T1115;6]', '6'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('network_http', '45'), ('network_tcp_socket', '50'), ('win_mutex', '60'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('win_megumin_auto', '45'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('Inject_Thread', '45'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('browser_pass', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers3', '10'), ('MD5_Constants', '20'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['894']
-------------- CAPA_Score ------------
['89.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
15954.7049124995
============================================


==================================================================
Fichier HTTP-FFMYiG2whFdpKW4ztd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FPgNQHPKwDTeP6O9d.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FPgNQHPKwDTeP6O9d.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 3.02 MB
Data read: 2.83 MB (ratio 1.06:1)
Time: 45.619 sec (0 m 45 s)
Start Date: 2022:02:07 13:41:03
End Date:   2022:02:07 13:41:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:41:03Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FPgNQHPKwDTeP6O9d.exe SCORE: 514 TYPE: EXE SIZE: 2970624 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f23723a4fa0> 
MD5: f4ff94ccd882cc33c6ba26e441cfcc78 
SHA1: 9450342e37a232c76c1573c0f00b83f82f034289 
SHA256: dbda182d31f85e507587ac6e37c56fe3380537d517573dd1f50050d1156b6f89 CREATED: Mon Feb  7 13:41:03 2022 MODIFIED: Mon Feb  7 13:41:03 2022 ACCESSED: Mon Feb  7 13:41:45 2022 
REASON_1: Yara Rule MATCH: network_udp_sock SUBSCORE: 45 
DESCRIPTION: Communications over UDP network REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSAStartup Str3: recvfrom
REASON_2: Yara Rule MATCH: network_tcp_listen SUBSCORE: 45 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: bind Str3: accept Str4: WSAStartup Str5: WSASocket Str6: listen
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSASocket Str3: socket Str4: send Str5: WSASend Str6: connect Str7: WSAStartup Str8: WSACleanup
REASON_4: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: getaddrinfo
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_16: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_17: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 4c8d9c2420010000498b5b40498b7348498be3415f415e415c5f5dc3
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2962ADEAE004074C8C0D598C5387FEB3 Str2: 5FFFB6E33C19F27A8A5535D45382B9E8 Str3: 4EDDBBCE46E0542C24BEC5BF9717C971 Str4: D946354436F2F3C7 ... (truncated)
REASON_23: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:41:51Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_udp_sock
45		network_tcp_listen
50		network_tcp_socket
50		network_dns
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		skip20_sqllang_hook
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
5		BASE64_table

Score total: 514

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f4ff94ccd882cc33c6ba26e441cfcc78                                                   |
| sha1                   | 9450342e37a232c76c1573c0f00b83f82f034289                                           |
| sha256                 | dbda182d31f85e507587ac6e37c56fe3380537d517573dd1f50050d1156b6f89                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FPgNQHPKwDTeP6O9d.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data (3 matches)                             | communication                                        |
| send data (4 matches)                                | communication                                        |
| get socket information (2 matches)                   | communication/socket                                 |
| get socket status                                    | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration (17 matches)                | communication/socket                                 |
| encode data using Base64 (3 matches)                 | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (50 matches)                   | data-manipulation/encoding/xor                       |
| encrypt or decrypt data via BCrypt (2 matches)       | data-manipulation/encryption                         |
| encrypt data using DPAPI                             | data-manipulation/encryption/dpapi                   |
| hash data via BCrypt                                 | data-manipulation/hashing                            |
| hash data using fnv (32 matches)                     | data-manipulation/hashing/fnv                        |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get local IPv4 addresses (3 matches)                 | host-interaction/network/address                     |
| resolve DNS (4 matches)                              | host-interaction/network/dns/resolve                 |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header (11 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]

Score total: 14.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_udp_sock', '45'), ('network_tcp_listen', '45'), ('network_tcp_socket', '50'), ('network_dns', '50'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('skip20_sqllang_hook', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['514']
-------------- CAPA_Score ------------
['14.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8435.66404492061
============================================


==================================================================
Fichier HTTP-FPgNQHPKwDTeP6O9d.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FxxUvw9yVIXx2SU1d.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be a .NET module.
WARNING:capa: 
WARNING:capa: .NET is a cross-platform framework for running managed applications.
WARNING:capa: capa cannot handle non-native files. This means that the results may be misleading or incomplete.
WARNING:capa: You may have to analyze the file manually, using a tool like the .NET decompiler dnSpy.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) dotnet file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FxxUvw9yVIXx2SU1d.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 43.380 sec (0 m 43 s)
Start Date: 2022:02:07 13:50:44
End Date:   2022:02:07 13:51:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xed in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 10: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 11: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 2-3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xaa in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xaf in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xad in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xed in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 8: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xce in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb4 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xaa in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 15-16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 34: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 38: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:50:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FxxUvw9yVIXx2SU1d.exe SCORE: 289 TYPE: EXE SIZE: 50688 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7978680fa0> 
MD5: 9e600914f713d84ad23cc64d902a25ac 
SHA1: 262c2cfd9487e3762bbaa864d6a5f32681a70654 
SHA256: 2fb7d4574d11376d545b785b8751d79ef5405b79072a3e3d8106ff1a5349f777 CREATED: Mon Feb  7 13:50:44 2022 MODIFIED: Mon Feb  7 13:50:44 2022 ACCESSED: Mon Feb  7 13:51:38 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: dotnet_libraries SUBSCORE: 5 
DESCRIPTION: .Net runtime mscoree.dll mscorwks.dll REF: - AUTHOR: - 
MATCHES: Str1: mscoree.dll Str2: _CorDllMain
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Armadillo_v4x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 0000001680100000042acccccccccccccccccccccccccc4c894424184c894c2420535556574883ec2833ed488d42ff483dfeffff7f488b Str2: 001680100000042a ... (truncated)
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsNET_DLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:51:38Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		dotnet_libraries
5		executable_pe
70		Armadillo_v4x
10		IsPE64
10		IsNET_DLL
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 289

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('dotnet_libraries', '5'), ('executable_pe', '5'), ('Armadillo_v4x', '70'), ('IsPE64', '10'), ('IsNET_DLL', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['289']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4580.341326212618
============================================


==================================================================
Fichier HTTP-FxxUvw9yVIXx2SU1d.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOHyue21Vxb9eBigh7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOHyue21Vxb9eBigh7.exe: Win.Malware.Zusy-9938038-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FOHyue21Vxb9eBigh7.exe: Win.Trojan.Agent-1250609 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.47 MB
Data read: 0.45 MB (ratio 1.04:1)
Time: 43.466 sec (0 m 43 s)
Start Date: 2022:02:07 13:51:38
End Date:   2022:02:07 13:52:22

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Zusy-9938038-0
70		Win.Trojan.Agent-1250609
75		Win.Trojan.Agent-1250609
45		Win.Trojan.Agent-1250609

Score total: 240.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:51:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FOHyue21Vxb9eBigh7.exe SCORE: 1224 TYPE: EXE SIZE: 475138 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9466206fa0> 
MD5: a70052c45e907820187c7e6bcdc7ecca 
SHA1: a8ae62aac336c119176f83e1b3d8c663e141709d 
SHA256: 8aec186d533ab9acf93965808e61ec9a8df4b7de250395f1c4bb9b7653ed6d1a CREATED: Mon Feb  7 13:51:38 2022 MODIFIED: Mon Feb  7 13:51:38 2022 ACCESSED: Mon Feb  7 13:52:30 2022 
REASON_1: Yara Rule MATCH: network_tcp_listen SUBSCORE: 45 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: bind Str3: accept Str4: WSAStartup Str5: listen
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.DLL Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: socket Str3: send Str4: connect Str5: WSAStartup Str6: closesocket Str7: WSACleanup
REASON_4: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: gethostbyname
REASON_5: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_6: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_7: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.DLL Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_8: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: CreateFileA Str5: SetFileAttributesA
REASON_9: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WSOCK32.DLL
REASON_10: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.DLL
REASON_11: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_12: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_13: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: misc_no_dosmode_header SUBSCORE: 10 
DESCRIPTION: Detect on absence of 'DOS Mode' heaader between MZ and PE boundries REF: - AUTHOR: Jason Batchelor
REASON_15: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_17: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: MingWin32_GCC_3x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_20: Yara Rule MATCH: MingWin32_v_h_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_21: Yara Rule MATCH: MinGW_GCC_3x_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_22: Yara Rule MATCH: MinGW_GCC_3x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_23: Yara Rule MATCH: MingWin32_GCC_3x_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_24: Yara Rule MATCH: MingWin32_v_h SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_25: Yara Rule MATCH: MingWin32_v SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_26: Yara Rule MATCH: MinGWGCC3x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_27: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_28: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_29: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_30: Yara Rule MATCH: HasModified_DOS_Message SUBSCORE: 10 
DESCRIPTION: DOS Message Check REF: - AUTHOR: _pusher_
REASON_31: Yara Rule MATCH: MinGW_1 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: _pusher_ 
MATCHES: Str1: msvcrt.dll Str2: -LIBGCCW32-EH-2-SJLJ-GTHR-MINGW32
REASON_32: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_33: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_34: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: SetWindowsHookExA Str4: CallNextHookEx
REASON_35: Yara Rule MATCH: sitrof_fortis_scar SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: J from THL <j@techhelplist.com> 
MATCHES: Str1: ?get&version Str2: ?get&exe Str3: ?get&download Str4: ?get&module Str5: &ver= Str6: &comp= Str7: &addinfo=
REASON_36: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_37: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:52:32Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_tcp_listen
45		network_http
50		network_tcp_socket
50		network_dns
65		screenshot
80		keylogger
20		win_registry
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
10		misc_no_dosmode_header
2		math_entropy_6
5		executable_pe
15		dll_injection_hook
5		winsocks
70		MingWin32_GCC_3x
70		MingWin32_v_h_additional
70		MinGW_GCC_3x_additional
70		MinGW_GCC_3x
70		MingWin32_GCC_3x_additional
70		MingWin32_v_h
70		MingWin32_v
70		MinGWGCC3x
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasModified_DOS_Message
10		MinGW_1
2		PE_File
35		Anti_Automated_Sandbox
35		Win_Hook_v12
60		sitrof_fortis_scar
20		isExecutable
10		Contains_PE_File

Score total: 1224

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a70052c45e907820187c7e6bcdc7ecca                                                   |
| sha1                   | a8ae62aac336c119176f83e1b3d8c663e141709d                                           |
| sha256                 | 8aec186d533ab9acf93965808e61ec9a8df4b7de250395f1c4bb9b7653ed6d1a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FOHyue21Vxb9eBigh7.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Audio Capture:: \[T1123]\                                                           |
|                        | Clipboard Data:: \[T1115]\                                                          |
|                        | Input Capture::Keylogging \[T1056.001]\                                             |
|                        | Screen Capture:: \[T1113]\                                                          |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                  |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
|                        | System Network Configuration Discovery::Internet Connection Discovery \[T1016.001]\ |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
|                             | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Create UDP Socket [C0001.010]                           |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| receive and write data from server to client         | c2/file-transfer                                     |
| log keystrokes via application hook                  | collection/keylog                                    |
| log keystrokes via polling (2 matches)               | collection/keylog                                    |
| capture microphone audio                             | collection/microphone                                |
| capture screenshot                                   | collection/screenshot                                |
| send data (6 matches)                                | communication                                        |
| send HTTP request with Host header                   | communication/http                                   |
| create UDP socket                                    | communication/socket/udp/send                        |
| encode data using XOR (2 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| read clipboard data                                  | host-interaction/clipboard                           |
| query environment variable (12 matches)              | host-interaction/environment-variable                |
| create directory (3 matches)                         | host-interaction/file-system/create                  |
| delete file (10 matches)                             | host-interaction/file-system/delete                  |
| check if file exists (20 matches)                    | host-interaction/file-system/exists                  |
| set file attributes (14 matches)                     | host-interaction/file-system/meta                    |
| read file on Windows (3 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (6 matches)                    | host-interaction/file-system/write                   |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information                                 | host-interaction/hardware/storage                    |
| check Internet connectivity via WinINet (3 matches)  | host-interaction/network/connectivity                |
| resolve DNS (2 matches)                              | host-interaction/network/dns/resolve                 |
| get hostname                                         | host-interaction/os/hostname                         |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| allocate thread local storage (3 matches)            | host-interaction/process                             |
| get thread local storage value (10 matches)          | host-interaction/process                             |
| set thread local storage value (9 matches)           | host-interaction/process                             |
| create process on Windows (8 matches)                | host-interaction/process/create                      |
| create process suspended                             | host-interaction/process/create                      |
| enumerate processes                                  | host-interaction/process/list                        |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| create thread (7 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| enumerate PE sections (20 matches)                   | load-code/pe                                         |
| parse PE exports (3 matches)                         | load-code/pe                                         |
| parse PE header (21 matches)                         | load-code/pe                                         |
| persist via Run registry key (2 matches)             | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6		- Collection::Screen Capture [T1113;6]
1		- Discovery::Query Registry [T1012;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Discovery::File and Directory Discovery [T1083;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
5		- Collection::Audio Capture [T1123;5]
2		- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6		- Collection::Clipboard Data [T1115;6]
3		- Discovery::System Network Configuration Discovery [T1016;3]
2		- Execution::Shared Modules [T1129;2]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 90.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Collection::Screen Capture [T1113;6]', '6'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Collection::Audio Capture [T1123;5]', '5'), ('- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]', '2'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;5]', '5'), ('- Collection::Clipboard Data [T1115;6]', '6'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Zusy-9938038-0', '50'), ('Win.Trojan.Agent-1250609', '70'), ('Win.Trojan.Agent-1250609', '75'), ('Win.Trojan.Agent-1250609', '45')]
-------------- LOKI_Rules ------------
[('network_tcp_listen', '45'), ('network_http', '45'), ('network_tcp_socket', '50'), ('network_dns', '50'), ('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('misc_no_dosmode_header', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('dll_injection_hook', '15'), ('winsocks', '5'), ('MingWin32_GCC_3x', '70'), ('MingWin32_v_h_additional', '70'), ('MinGW_GCC_3x_additional', '70'), ('MinGW_GCC_3x', '70'), ('MingWin32_GCC_3x_additional', '70'), ('MingWin32_v_h', '70'), ('MingWin32_v', '70'), ('MinGWGCC3x', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasModified_DOS_Message', '10'), ('MinGW_1', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Win_Hook_v12', '35'), ('sitrof_fortis_scar', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['1224']
-------------- CAPA_Score ------------
['90.0']
-------------- CLAMAV_Score ------------
['240.0']
-------------- SCORE FINAL ------------
24216.24974750202
============================================


==================================================================
Fichier HTTP-FOHyue21Vxb9eBigh7.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fq5hMA3Yvy86vF1Wyd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fq5hMA3Yvy86vF1Wyd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.16 MB
Data read: 0.16 MB (ratio 1.02:1)
Time: 44.428 sec (0 m 44 s)
Start Date: 2022:02:07 13:52:33
End Date:   2022:02:07 13:53:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:52:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fq5hMA3Yvy86vF1Wyd.exe SCORE: 369 TYPE: EXE SIZE: 167936 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8b55ce9fa0> 
MD5: db931bcbb03f78ecd39a793ba37201c4 
SHA1: 9f4cb9a7916366c71c07db6446c2fcbfdab4bf38 
SHA256: d19342e870809bcf20d3bac6bb7c92ca86253df615dbea835f2040e6e5a94391 CREATED: Mon Feb  7 13:52:34 2022 MODIFIED: Mon Feb  7 13:52:34 2022 ACCESSED: Mon Feb  7 13:53:22 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: MapVirtualKey
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: OpenProcessToken
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:53:23Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 369

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | db931bcbb03f78ecd39a793ba37201c4                                                   |
| sha1                   | 9f4cb9a7916366c71c07db6446c2fcbfdab4bf38                                           |
| sha256                 | d19342e870809bcf20d3bac6bb7c92ca86253df615dbea835f2040e6e5a94391                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fq5hMA3Yvy86vF1Wyd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                           | anti-analysis                                        |
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| log keystrokes                                       | collection/keylog                                    |
| check HTTP status code                               | communication/http/client                            |
| encode data using XOR (18 matches)                   | data-manipulation/encoding/xor                       |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| find graphical window                                | host-interaction/gui/window/find                     |
| register raw input devices (2 matches)               | host-interaction/hardware                            |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 33.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('keylogger', '80'), ('win_registry', '20'), ('win_token', '65'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['369']
-------------- CAPA_Score ------------
['33.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6516.668755696083
============================================


==================================================================
Fichier HTTP-Fq5hMA3Yvy86vF1Wyd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fjph07D5LhC0DAGK5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3fdfb2d522e7deecaaaf2f87420f7e75                                                   |
| sha1                   | a48505f1c45f50c4f028703bce826e38fc1f9b3c                                           |
| sha256                 | 70445e660358ef905cc01149dd3ffc604822a57a7dc32698f9f799d51ad57b62                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fjph07D5LhC0DAGK5.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| decompress data using aPLib                          | data-manipulation/compression                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fjph07D5LhC0DAGK5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 41.446 sec (0 m 41 s)
Start Date: 2022:02:07 13:53:30
End Date:   2022:02:07 13:54:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:53:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-Fjph07D5LhC0DAGK5.exe SCORE: 69 TYPE: EXE SIZE: 23040 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4793976fa0> 
MD5: 3fdfb2d522e7deecaaaf2f87420f7e75 
SHA1: a48505f1c45f50c4f028703bce826e38fc1f9b3c 
SHA256: 70445e660358ef905cc01149dd3ffc604822a57a7dc32698f9f799d51ad57b62 CREATED: Mon Feb  7 13:53:30 2022 MODIFIED: Mon Feb  7 13:53:30 2022 ACCESSED: Mon Feb  7 13:54:23 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_8: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:54:23Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 69

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['69']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1153.4341722472345
============================================


==================================================================
Fichier HTTP-Fjph07D5LhC0DAGK5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIAlLq2b5kGjvCdXud.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6bad650a415802b2213368d9e32e46c5                                                   |
| sha1                   | 19085001edec67a61bda3d151ee4e09a3afcc825                                           |
| sha256                 | ff851f2724c4c35995c945f67e8c156ca34dc98f6f7381febb1c09aa0c624e46                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FIAlLq2b5kGjvCdXud.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIAlLq2b5kGjvCdXud.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 44.840 sec (0 m 44 s)
Start Date: 2022:02:07 13:54:23
End Date:   2022:02:07 13:55:08

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:54:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FIAlLq2b5kGjvCdXud.exe SCORE: 264 TYPE: EXE SIZE: 63488 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fed7aba1fa0> 
MD5: 6bad650a415802b2213368d9e32e46c5 
SHA1: 19085001edec67a61bda3d151ee4e09a3afcc825 
SHA256: ff851f2724c4c35995c945f67e8c156ca34dc98f6f7381febb1c09aa0c624e46 CREATED: Mon Feb  7 13:54:23 2022 MODIFIED: Mon Feb  7 13:54:23 2022 ACCESSED: Mon Feb  7 13:55:17 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:55:18Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 264

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['264']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4243.975897546406
============================================


==================================================================
Fichier HTTP-FIAlLq2b5kGjvCdXud.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfpjtD4xwH7g1NN7U.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa6 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdc in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T12:55:18Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FfpjtD4xwH7g1NN7U.exe SCORE: 1184 TYPE: EXE SIZE: 3120640 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f60de854fa0> 
MD5: 6cc148363200798a12091b97a17181a1 
SHA1: be0ad25b7b48347984908175404996531cfd74b7 
SHA256: dbaf4a8c8431fd80cc5160dfdaca7adb301adc26ab7e3a48be9543edf539ea8d CREATED: Mon Feb  7 13:55:18 2022 MODIFIED: Mon Feb  7 13:55:18 2022 ACCESSED: Mon Feb  7 13:55:47 2022 
REASON_1: Yara Rule MATCH: network_tcp_listen SUBSCORE: 45 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: bind Str3: accept Str4: WSAStartup Str5: WSASocket Str6: listen
REASON_2: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSASocket Str3: socket Str4: send Str5: WSASend Str6: connect Str7: WSAStartup
REASON_3: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: getaddrinfo Str3: gethostbyname
REASON_4: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: ConventionEngine_Keyword_Reverse SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_9: Yara Rule MATCH: ConventionEngine_Keyword_Shell SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_10: Yara Rule MATCH: ConventionEngine_Keyword_Proxy SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_11: Yara Rule MATCH: ConventionEngine_Keyword_Client SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_12: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_13: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_14: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_17: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_20: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_21: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER
REASON_23: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER
REASON_24: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER
REASON_25: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_26: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_27: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_28: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_29: Yara Rule MATCH: browser_pass SUBSCORE: 10 
DESCRIPTION: This module is intended for forensicators and pen-testers to find passwords in memory that can help their case/engagement. REF: https://github.com/swoodsec/YARA-RULES/blob/master/browserpass.yar AUTHOR: swood 
MATCHES: Str1: password=
REASON_30: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_31: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_32: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 44f95cb9056da018991f9cc488ff7f38 Str2: e7b51236358cf576f2311ad760d4f7a8 Str3: d3284d61fdd76368e9f0ca0747334655 Str4: 0493be962c3f6830 ... (truncated)
REASON_33: Yara Rule MATCH: Big_Numbers2 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 48:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 666666666666666666666666666666666666666666666666
REASON_34: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_35: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_36: Yara Rule MATCH: BLOWFISH_Constants SUBSCORE: 25 
DESCRIPTION: Look for Blowfish constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: a60b31d1 Str2: acb5df98 Str3: db72fd2f Str4: b7df1ad0 Str5: e9707a4b Str6: 1c264cf6
REASON_37: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
REASON_38: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_39: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
REASON_40: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_41: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_42: Yara Rule MATCH: WHIRLPOOL_Constants SUBSCORE: 15 
DESCRIPTION: Look for WhirlPool constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 18186018c07830d8 Str2: 23238c2305af4626
REASON_43: Yara Rule MATCH: DES_Long SUBSCORE: 15 
DESCRIPTION: DES [long] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 10801040000000000080100000001040100000401080000000800040008010000080000010001040100000000080004010001000008010400000104010000000
REASON_44: Yara Rule MATCH: RijnDael_AES_CHAR SUBSCORE: 15 
DESCRIPTION: RijnDael AES (check2) [char] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0
REASON_45: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
REASON_46: Yara Rule MATCH: ecc_order SUBSCORE: 15 
DESCRIPTION: Look for known Elliptic curve orders REF: - AUTHOR: spelissier 
MATCHES: Str1: fffffffffffffffffffffffe26f2fc170f69466a74defd8d Str2: ffffffffffffffffffffffff99def836146bc9b1b4d22831 Str3: 01000000000000000000000 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T12:55:51Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_tcp_listen
50		network_tcp_socket
50		network_dns
60		win_mutex
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
50		ConventionEngine_Keyword_Reverse
50		ConventionEngine_Keyword_Shell
50		ConventionEngine_Keyword_Proxy
50		ConventionEngine_Keyword_Client
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		DebuggerException__SetConsoleCtrl_v1
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
10		browser_pass
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
10		Big_Numbers2
25		CRC32_poly_Constant
25		CRC32_table
25		BLOWFISH_Constants
20		MD5_Constants
15		RIPEMD160_Constants
20		SHA1_Constants
20		SHA512_Constants
20		SHA2_BLAKE2_IVs
15		WHIRLPOOL_Constants
15		DES_Long
15		RijnDael_AES_CHAR
5		BASE64_table
15		ecc_order

Score total: 1184

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfpjtD4xwH7g1NN7U.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 3.16 MB
Data read: 2.97 MB (ratio 1.06:1)
Time: 46.268 sec (0 m 46 s)
Start Date: 2022:02:07 13:55:18
End Date:   2022:02:07 13:56:04

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6cc148363200798a12091b97a17181a1                                                   |
| sha1                   | be0ad25b7b48347984908175404996531cfd74b7                                           |
| sha256                 | dbaf4a8c8431fd80cc5160dfdaca7adb301adc26ab7e3a48be9543edf539ea8d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FfpjtD4xwH7g1NN7U.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Execution Guardrails::Runs as Service [E1480.m07]                             |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Crypto Library:: [C0059]                                                      |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Cryptographic Hash::SHA224 [C0029.004]                                        |
|                             | Cryptographic Hash::SHA256 [C0029.003]                                        |
|                             | Decrypt Data::AES [C0031.001]                                                 |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encrypt Data::Blowfish [C0027.002]                                            |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Adler [C0032.005]                                                   |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+--------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                             | NAMESPACE                                            |
|--------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints                         | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount (2 matches)      | anti-analysis/anti-debugging/debugger-detection      |
| receive data (4 matches)                               | communication                                        |
| send data (4 matches)                                  | communication                                        |
| check HTTP status code (3 matches)                     | communication/http/client                            |
| get socket information (3 matches)                     | communication/socket                                 |
| get socket status (3 matches)                          | communication/socket                                 |
| initialize Winsock library (3 matches)                 | communication/socket                                 |
| set socket configuration (8 matches)                   | communication/socket                                 |
| compute adler32 checksum                               | data-manipulation/checksum/adler32                   |
| encode data using Base64 (3 matches)                   | data-manipulation/encoding/base64                    |
| reference Base64 string                                | data-manipulation/encoding/base64                    |
| encode data using XOR (130 matches)                    | data-manipulation/encoding/xor                       |
| decrypt data using AES via x86 extensions (10 matches) | data-manipulation/encryption/aes                     |
| encrypt data using AES via x86 extensions (18 matches) | data-manipulation/encryption/aes                     |
| reference AES constants (4 matches)                    | data-manipulation/encryption/aes                     |
| encrypt data using blowfish                            | data-manipulation/encryption/blowfish                |
| encrypt data using DPAPI (2 matches)                   | data-manipulation/encryption/dpapi                   |
| encrypt data using RC4 PRGA (5 matches)                | data-manipulation/encryption/rc4                     |
| hash data with MD5 (3 matches)                         | data-manipulation/hashing/md5                        |
| hash data using murmur3 (2 matches)                    | data-manipulation/hashing/murmur                     |
| hash data using SHA1 (3 matches)                       | data-manipulation/hashing/sha1                       |
| hash data using SHA224 (2 matches)                     | data-manipulation/hashing/sha224                     |
| hash data using SHA256 (2 matches)                     | data-manipulation/hashing/sha256                     |
| authenticate HMAC (2 matches)                          | data-manipulation/hmac                               |
| contains PDB path                                      | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                     | executable/pe/section/rsrc                           |
| accept command line arguments                          | host-interaction/cli                                 |
| check if file exists                                   | host-interaction/file-system/exists                  |
| read file on Windows                                   | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                      | host-interaction/file-system/write                   |
| get memory capacity                                    | host-interaction/hardware/memory                     |
| print debug messages (5 matches)                       | host-interaction/log/debug/write-event               |
| access the Windows event log                           | host-interaction/log/winevt/access                   |
| check mutex and exit                                   | host-interaction/mutex                               |
| get local IPv4 addresses (3 matches)                   | host-interaction/network/address                     |
| resolve DNS                                            | host-interaction/network/dns/resolve                 |
| allocate thread local storage (2 matches)              | host-interaction/process                             |
| get thread local storage value (29 matches)            | host-interaction/process                             |
| set thread local storage value (23 matches)            | host-interaction/process                             |
| terminate process                                      | host-interaction/process/terminate                   |
| run as service                                         | host-interaction/service                             |
| create thread (3 matches)                              | host-interaction/thread/create                       |
| terminate thread                                       | host-interaction/thread/terminate                    |
| link many functions at runtime                         | linking/runtime-linking                              |
| linked against OpenSSL                                 | linking/static/openssl                               |
| linked against ZLIB                                    | linking/static/zlib                                  |
| enumerate PE sections (20 matches)                     | load-code/pe                                         |
| parse PE exports (5 matches)                           | load-code/pe                                         |
| parse PE header (85 matches)                           | load-code/pe                                         |
+--------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 47.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_tcp_listen', '45'), ('network_tcp_socket', '50'), ('network_dns', '50'), ('win_mutex', '60'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('ConventionEngine_Keyword_Reverse', '50'), ('ConventionEngine_Keyword_Shell', '50'), ('ConventionEngine_Keyword_Proxy', '50'), ('ConventionEngine_Keyword_Client', '50'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('browser_pass', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10'), ('Big_Numbers2', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('BLOWFISH_Constants', '25'), ('MD5_Constants', '20'), ('RIPEMD160_Constants', '15'), ('SHA1_Constants', '20'), ('SHA512_Constants', '20'), ('SHA2_BLAKE2_IVs', '20'), ('WHIRLPOOL_Constants', '15'), ('DES_Long', '15'), ('RijnDael_AES_CHAR', '15'), ('BASE64_table', '5'), ('ecc_order', '15')]
-------------- LOKI_Score ------------
['1184']
-------------- CAPA_Score ------------
['47.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
19702.908686774954
============================================


==================================================================
Fichier HTTP-FfpjtD4xwH7g1NN7U.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAf8Fz3Q7QU0Vmrzjk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a9c55bb87a7c5c3c923c4fa12940e719                                                   |
| sha1                   | d971656c6c605a6e2130ab83a38420e655428f94                                           |
| sha256                 | 57d8d248a8741176348b5d12dcf29f34c8f48ede0ca13c30d12e5ba0384056d7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAf8Fz3Q7QU0Vmrzjk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| PERSISTENCE            | Event Triggered Execution:: \[T1546]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| persist via GinaDLL registry key                     | persistence/registry/ginadll                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Event Triggered Execution [T1546;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 7.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAf8Fz3Q7QU0Vmrzjk.exe: Win.Trojan.Agent-595082 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.08:1)
Time: 44.005 sec (0 m 44 s)
Start Date: 2022:02:07 14:04:43
End Date:   2022:02:07 14:05:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Persistence::Event Triggered Execution [T1546;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['644']
-------------- CAPA_Score ------------
['7.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
10356.356833072236
============================================


==================================================================
Fichier HTTP-FAf8Fz3Q7QU0Vmrzjk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIif0b1Rehbjj1snye.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIif0b1Rehbjj1snye.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.24 MB
Data read: 0.23 MB (ratio 1.03:1)
Time: 43.602 sec (0 m 43 s)
Start Date: 2022:02:07 14:05:34
End Date:   2022:02:07 14:06:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:05:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FIif0b1Rehbjj1snye.exe SCORE: 589 TYPE: EXE SIZE: 244224 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f98f2317fa0> 
MD5: 1e609dffd12a59ea5d5c9b3055939b1f 
SHA1: 0a6cd87f09ae5961fce6ca9c1c2aeda8a99447fb 
SHA256: 57771f6312b091fb5450112864e56413ae2a2a2874289e8245eb3a0d286577e9 CREATED: Mon Feb  7 14:05:34 2022 MODIFIED: Mon Feb  7 14:05:34 2022 ACCESSED: Mon Feb  7 14:06:21 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: win_rdat_auto SUBSCORE: 45 
DESCRIPTION: Detects win.rdat. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 48984885c0751e483bfb Str2: 4885c0751e483bfb731383c8ff Str3: 48ffc34038341a75f74883791810488b7910 Str4: 669048ffc34038341a75f748837918 ... (truncated)
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Documents SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532d3ad0ab66582a428f2eb2a659aaccc303000000433a5c55736572735c4361726c6f732044616e6765725c446f63756d656e74735c56697375616c2053747 ... (truncated)
REASON_6: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532d3ad0ab66582a428f2eb2a659aaccc303000000433a5c55736572735c4361726c6f732044616e6765725c446f63756d656e74735c56697375616c2053747 ... (truncated)
REASON_7: Yara Rule MATCH: ConventionEngine_Term_VisualStudio SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532d3ad0ab66582a428f2eb2a659aaccc303000000433a5c55736572735c4361726c6f732044616e6765725c446f63756d656e74735c56697375616c2053747 ... (truncated)
REASON_8: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_12: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_18: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_19: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_20: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:06:22Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
10		win_files_operation
10		ft_exe
45		win_rdat_auto
50		ConventionEngine_Term_Documents
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_VisualStudio
2		math_entropy_6
5		executable_pe
15		dll_injection_thread
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
45		Inject_Thread
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 589

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1e609dffd12a59ea5d5c9b3055939b1f                                                   |
| sha1                   | 0a6cd87f09ae5961fce6ca9c1c2aeda8a99447fb                                           |
| sha256                 | 57771f6312b091fb5450112864e56413ae2a2a2874289e8245eb3a0d286577e9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FIif0b1Rehbjj1snye.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| CREDENTIAL ACCESS      | Credentials from Password Stores::Password Managers \[T1555.005]\                  |
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| steal KeePass passwords using KeeFarce               | collection/password-manager                          |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| write file on Windows                                | host-interaction/file-system/write                   |
| inject thread (2 matches)                            | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process via fastfail                       | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Execution::Shared Modules [T1129;2]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
2		- Discovery::File and Directory Discovery [T1083;2]
8		- Credential Access::Credentials from Password Stores::Password Managers [T1555.005;8]
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
4		- Discovery::Software Discovery [T1518;4]

Score total: 32.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]', '6'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Credential Access::Credentials from Password Stores::Password Managers [T1555.005;8]', '8'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]', '5'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_files_operation', '10'), ('ft_exe', '10'), ('win_rdat_auto', '45'), ('ConventionEngine_Term_Documents', '50'), ('ConventionEngine_Term_Users', '50'), ('ConventionEngine_Term_VisualStudio', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('dll_injection_thread', '15'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Inject_Thread', '45'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['589']
-------------- CAPA_Score ------------
['32.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
9973.504844386
============================================


==================================================================
Fichier HTTP-FIif0b1Rehbjj1snye.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6ZVmi3SHCINwFr9G3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | bf3700789059bda100668d870aa7da4f                                                   |
| sha1                   | be3b9f386af5437f5a8948d6d11e9c21eb71b6b5                                           |
| sha256                 | 9f3db7047a20988b5790f6aafe0f06c3201ce8c7419915ff5c1c6647c27b64ad                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6ZVmi3SHCINwFr9G3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| link function at runtime on Windows (3 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6ZVmi3SHCINwFr9G3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 43.916 sec (0 m 43 s)
Start Date: 2022:02:07 14:06:24
End Date:   2022:02:07 14:07:08

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:06:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F6ZVmi3SHCINwFr9G3.exe SCORE: 159 TYPE: EXE SIZE: 21504 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1ae654cfa0> 
MD5: bf3700789059bda100668d870aa7da4f 
SHA1: be3b9f386af5437f5a8948d6d11e9c21eb71b6b5 
SHA256: 9f3db7047a20988b5790f6aafe0f06c3201ce8c7419915ff5c1c6647c27b64ad CREATED: Mon Feb  7 14:06:24 2022 MODIFIED: Mon Feb  7 14:06:24 2022 ACCESSED: Mon Feb  7 14:07:17 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:07:17Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['159']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2579.8380454622366
============================================


==================================================================
Fichier HTTP-F6ZVmi3SHCINwFr9G3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F7BFHw1iTaEHYzu31k.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F7BFHw1iTaEHYzu31k.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 40.476 sec (0 m 40 s)
Start Date: 2022:02:07 14:07:17
End Date:   2022:02:07 14:07:58

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b40fcca78adbc528f5ac0dac3df3a959                                                   |
| sha1                   | 1859e6b054d245f863973d0844a23348a2593a31                                           |
| sha256                 | 1953c9e88e24fd6594170a1f62da21b27847595e067ef9dba7e07543d0e3a510                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F7BFHw1iTaEHYzu31k.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:07:17Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F7BFHw1iTaEHYzu31k.exe SCORE: 289 TYPE: EXE SIZE: 108544 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7087933fa0> 
MD5: b40fcca78adbc528f5ac0dac3df3a959 
SHA1: 1859e6b054d245f863973d0844a23348a2593a31 
SHA256: 1953c9e88e24fd6594170a1f62da21b27847595e067ef9dba7e07543d0e3a510 CREATED: Mon Feb  7 14:07:17 2022 MODIFIED: Mon Feb  7 14:07:17 2022 ACCESSED: Mon Feb  7 14:08:07 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8ff0400004883c428e96efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:08:08Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 289

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['289']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4640.199195661684
============================================


==================================================================
Fichier HTTP-F7BFHw1iTaEHYzu31k.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fb2WFSLgbjuj2SmDj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 07f7846bbcda782e5639292ad93907eb                                                   |
| sha1                   | 19929c80e9191bf101da7f8f164984f49c6df8d4                                           |
| sha256                 | a52c3792d8cef6019ce67203220dc191e207c6ddbdfa51ac385d9493ffe2a83a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fb2WFSLgbjuj2SmDj.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                    |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | System Information Discovery:: \[T1082]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings                       | anti-analysis/obfuscation/string/stackstring         |
| parse credit card information                         | collection/credit-card                               |
| check HTTP status code                                | communication/http/client                            |
| encode data using Base64 (2 matches)                  | data-manipulation/encoding/base64                    |
| reference Base64 string                               | data-manipulation/encoding/base64                    |
| encrypt data using RC4 KSA                            | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| get common file path (2 matches)                      | host-interaction/file-system                         |
| read file on Windows                                  | host-interaction/file-system/read                    |
| write file on Windows                                 | host-interaction/file-system/write                   |
| get disk information                                  | host-interaction/hardware/storage                    |
| get hostname                                          | host-interaction/os/hostname                         |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows                             | host-interaction/process/create                      |
| parse PE exports                                      | load-code/pe                                         |
| parse PE header                                       | load-code/pe                                         |
| write file to startup folder                          | persistence/startup-folder                           |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
6		- Collection::Automated Collection [T1119;6]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 33.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fb2WFSLgbjuj2SmDj.exe: Win.Trojan.Datper-6736003-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 43.935 sec (0 m 43 s)
Start Date: 2022:02:07 14:08:08
End Date:   2022:02:07 14:08:52

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Datper-6736003-0

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:08:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fb2WFSLgbjuj2SmDj.exe SCORE: 474 TYPE: EXE SIZE: 24576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3a8045dfa0> 
MD5: 07f7846bbcda782e5639292ad93907eb 
SHA1: 19929c80e9191bf101da7f8f164984f49c6df8d4 
SHA256: a52c3792d8cef6019ce67203220dc191e207c6ddbdfa51ac385d9493ffe2a83a CREATED: Mon Feb  7 14:08:08 2022 MODIFIED: Mon Feb  7 14:08:08 2022 ACCESSED: Mon Feb  7 14:09:01 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_2 SUBSCORE: 2 
DESCRIPTION: Very low entropy - repeating sequence of couple of bytes REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff685031400068a421400064a100000000506489250000000083ec20535657
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685031400068a421400064a10000000050
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685031400068a421400064a10000000050
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec6aff685031400068a421400064a10000000050
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685031400068a421400064a1000000005064892500000000
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:09:01Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_2
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 474

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Collection::Automated Collection [T1119;6]', '6'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Datper-6736003-0', '45')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_2', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['474']
-------------- CAPA_Score ------------
['33.5']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
8747.323043087627
============================================


==================================================================
Fichier HTTP-Fb2WFSLgbjuj2SmDj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FKn50W13JOlguSfeIl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FKn50W13JOlguSfeIl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.28 MB
Data read: 0.27 MB (ratio 1.06:1)
Time: 41.495 sec (0 m 41 s)
Start Date: 2022:02:07 14:09:02
End Date:   2022:02:07 14:09:43

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 605a2773eb23be4393f1a6938dfb34af                                                   |
| sha1                   | dd7b39389aec906d3355ccc2becb57f0fc876587                                           |
| sha256                 | f9057ba9c9f2e6cc22c0c25d3d834f8cd80ac9a749e0609c2b91f79d62d0ad51                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FKn50W13JOlguSfeIl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | HTTP Communication::Send Data [C0002.005]                                     |
| CRYPTOGRAPHY                | Encrypt Data:: [C0027]                                                        |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| OPERATING SYSTEM            | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| log keystrokes via polling (3 matches)               | collection/keylog                                    |
| receive data                                         | communication                                        |
| send data                                            | communication                                        |
| parse URL                                            | communication/http                                   |
| connect to URL                                       | communication/http/client                            |
| create HTTP request                                  | communication/http/client                            |
| encrypt data using DPAPI (2 matches)                 | data-manipulation/encryption/dpapi                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| get file system object information (2 matches)       | host-interaction/file-system                         |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| get graphical window text (3 matches)                | host-interaction/gui/window/get-text                 |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| parse PE header (7 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
1		- Discovery::Query Registry [T1012;1]

Score total: 32.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:09:02Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FKn50W13JOlguSfeIl.exe SCORE: 449 TYPE: EXE SIZE: 280064 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9997510fa0> 
MD5: 605a2773eb23be4393f1a6938dfb34af 
SHA1: dd7b39389aec906d3355ccc2becb57f0fc876587 
SHA256: f9057ba9c9f2e6cc22c0c25d3d834f8cd80ac9a749e0609c2b91f79d62d0ad51 CREATED: Mon Feb  7 14:09:02 2022 MODIFIED: Mon Feb  7 14:09:02 2022 ACCESSED: Mon Feb  7 14:09:53 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetOpenUrl Str5: InternetReadFile Str6: InternetWriteFile
REASON_2: Yara Rule MATCH: network_ftp SUBSCORE: 60 
DESCRIPTION: Communications over FTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: FtpGetCurrentDirectory Str3: FtpGetFile Str4: FtpPutFile Str5: FtpSetCurrentDirectory Str6: FtpOpenFile Str7: FtpDe ... (truncated)
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetAsyncKeyState Str3: GetKeyState
REASON_4: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_5: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: FindFirstFileA Str6: FindClose
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_16: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 33333333333333333333
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:09:54Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
60		network_ftp
80		keylogger
60		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0

Score total: 449

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('network_ftp', '60'), ('keylogger', '80'), ('win_mutex', '60'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers0', '10')]
-------------- LOKI_Score ------------
['449']
-------------- CAPA_Score ------------
['32.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
7764.630686515284
============================================


==================================================================
Fichier HTTP-FKn50W13JOlguSfeIl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FaNUcz1sXuo0w8Rc6h.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a5d66324daaee5672b913aa461d4bd3a                                                   |
| sha1                   | 856263bb665825de8c47ca649f33868df9eb79df                                           |
| sha256                 | 0e9d5b57db6d9d75bfa5837b62bd8402688433a998bf3d6ee9430898a7686025                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FaNUcz1sXuo0w8Rc6h.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Process Doppelgänging \[T1055.013]\                             |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get file size                                        | host-interaction/file-system/meta                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| use process Doppelgänging                            | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Defense Evasion::Process Injection::Process Doppelgänging [T1055.013;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 9.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FaNUcz1sXuo0w8Rc6h.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 41.078 sec (0 m 41 s)
Start Date: 2022:02:07 14:09:54
End Date:   2022:02:07 14:10:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:09:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FaNUcz1sXuo0w8Rc6h.exe SCORE: 369 TYPE: EXE SIZE: 180736 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1bce780fa0> 
MD5: a5d66324daaee5672b913aa461d4bd3a 
SHA1: 856263bb665825de8c47ca649f33868df9eb79df 
SHA256: 0e9d5b57db6d9d75bfa5837b62bd8402688433a998bf3d6ee9430898a7686025 CREATED: Mon Feb  7 14:09:54 2022 MODIFIED: Mon Feb  7 14:09:54 2022 ACCESSED: Mon Feb  7 14:10:43 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: Process_Doppelganging SUBSCORE: 35 
DESCRIPTION: Detect Process Doppelganging REF: https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_ 
MATCHES: Str1: CreateTransaction Str2: CreateFileTransacted Str3: WriteFile Str4: RollbackTransaction Str5: CreateProcess Str6: CreateProcessParamet ... (truncated)
REASON_14: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_15: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:10:44Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Process_Doppelganging
60		Debugger_Check__QueryInfo
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 369

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Process Injection::Process Doppelgänging [T1055.013;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Process_Doppelganging', '35'), ('Debugger_Check__QueryInfo', '60'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['369']
-------------- CAPA_Score ------------
['9.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6027.829488528708
============================================


==================================================================
Fichier HTTP-FaNUcz1sXuo0w8Rc6h.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fb8mpP1p7zApp5BC6e.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ba0422ccb92c557e2d54a826242cdd08                                                   |
| sha1                   | b77b2f349b076821b4f0daf5374fe5b2b8e40a91                                           |
| sha256                 | b31a65a8740c6ac91ccf81bc7e0e0f04e205ad453cfc35ceac60d1e6b51f9549                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fb8mpP1p7zApp5BC6e.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:10:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fb8mpP1p7zApp5BC6e.exe SCORE: 404 TYPE: EXE SIZE: 132096 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f02dc175fa0> 
MD5: ba0422ccb92c557e2d54a826242cdd08 
SHA1: b77b2f349b076821b4f0daf5374fe5b2b8e40a91 
SHA256: b31a65a8740c6ac91ccf81bc7e0e0f04e205ad453cfc35ceac60d1e6b51f9549 CREATED: Mon Feb  7 14:10:44 2022 MODIFIED: Mon Feb  7 14:10:44 2022 ACCESSED: Mon Feb  7 14:11:25 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetConnect
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8470500004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:11:26Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 404

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fb8mpP1p7zApp5BC6e.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.13 MB
Data read: 0.12 MB (ratio 1.06:1)
Time: 44.113 sec (0 m 44 s)
Start Date: 2022:02:07 14:10:44
End Date:   2022:02:07 14:11:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['404']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6462.826366991963
============================================


==================================================================
Fichier HTTP-Fb8mpP1p7zApp5BC6e.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FjfxBO3MUTOpsQT1e4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3d547b8c756973b61a634db99aca74d8                                                   |
| sha1                   | b7d9c8fd14e8419c6f1b5d62d8dfafe8ed12be06                                           |
| sha256                 | f0aeee2d6851b6d1b616e85ccb24ea4045c1d00880c39be644b4899f9cac398c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FjfxBO3MUTOpsQT1e4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery :: \[T1016]\                                |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| get domain controller name                           | host-interaction/network/domain                      |
| get hostname                                         | host-interaction/os/hostname                         |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (3 matches)        | host-interaction/registry                            |
| set registry value (3 matches)                       | host-interaction/registry/create                     |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 12.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FjfxBO3MUTOpsQT1e4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 35.497 sec (0 m 35 s)
Start Date: 2022:02:07 14:11:28
End Date:   2022:02:07 14:12:04

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:11:29Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FjfxBO3MUTOpsQT1e4.exe SCORE: 284 TYPE: EXE SIZE: 40448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4464624fa0> 
MD5: 3d547b8c756973b61a634db99aca74d8 
SHA1: b7d9c8fd14e8419c6f1b5d62d8dfafe8ed12be06 
SHA256: f0aeee2d6851b6d1b616e85ccb24ea4045c1d00880c39be644b4899f9cac398c CREATED: Mon Feb  7 14:11:28 2022 MODIFIED: Mon Feb  7 14:11:28 2022 ACCESSED: Mon Feb  7 14:12:20 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:12:20Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 284

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['284']
-------------- CAPA_Score ------------
['12.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4750.504455960672
============================================


==================================================================
Fichier HTTP-FjfxBO3MUTOpsQT1e4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FxNulv1Gx28fjwlIRf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9a86c3da2f39f3c6b1a4291f6940f6ea                                                   |
| sha1                   | 42e18468193e656b0e782be8023947a7e4c941d1                                           |
| sha256                 | 2235f03245ab289919a5c0b2272bf2f3a6a6a1e091944be1dfce79831678a71d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FxNulv1Gx28fjwlIRf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FxNulv1Gx28fjwlIRf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 42.822 sec (0 m 42 s)
Start Date: 2022:02:07 14:12:20
End Date:   2022:02:07 14:13:03

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:12:21Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FxNulv1Gx28fjwlIRf.exe SCORE: 194 TYPE: EXE SIZE: 35840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fae7c1f3fa0> 
MD5: 9a86c3da2f39f3c6b1a4291f6940f6ea 
SHA1: 42e18468193e656b0e782be8023947a7e4c941d1 
SHA256: 2235f03245ab289919a5c0b2272bf2f3a6a6a1e091944be1dfce79831678a71d CREATED: Mon Feb  7 14:12:20 2022 MODIFIED: Mon Feb  7 14:12:20 2022 ACCESSED: Mon Feb  7 14:13:10 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:13:10Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 194

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['194']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3094.6454165242485
============================================


==================================================================
Fichier HTTP-FxNulv1Gx28fjwlIRf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FeJb7z1HIg2HPkLqKb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 0a0882b8da225406cc838991b5f67d11                                                   |
| sha1                   | ef62537d97d436b6e7c03190ef35e9dbb4ef997d                                           |
| sha256                 | aa2316ff30647295efac2c884b30b6e83a8515c2d2ff1df3c5d6091b404c73a9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FeJb7z1HIg2HPkLqKb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Network Share Discovery:: \[T1135]\                                                |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | Windows Management Instrumentation:: \[T1047]\                                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings targeting VirtualBox       | anti-analysis/anti-vm/vm-detection                   |
| receive data                                         | communication                                        |
| send data (2 matches)                                | communication                                        |
| reference Google Public DNS server                   | communication/dns                                    |
| connect network resource                             | communication/http                                   |
| parse URL                                            | communication/http                                   |
| check HTTP status code (2 matches)                   | communication/http/client                            |
| encode data using XOR (18 matches)                   | data-manipulation/encoding/xor                       |
| encrypt data using Curve25519 (2 matches)            | data-manipulation/encryption/elliptic-curve          |
| encrypt data using Salsa20 or ChaCha                 | data-manipulation/encryption/salsa20                 |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file size                                        | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| enumerate disk volumes (2 matches)                   | host-interaction/hardware/storage                    |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| enumerate network shares                             | host-interaction/network                             |
| get hostname (2 matches)                             | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| get session user name (2 matches)                    | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| connect to WMI namespace via WbemLocator             | host-interaction/wmi                                 |
| link function at runtime on Windows (5 matches)      | linking/runtime-linking                              |
| enumerate PE sections (2 matches)                    | load-code/pe                                         |
| parse PE exports (4 matches)                         | load-code/pe                                         |
| parse PE header (8 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::Account Discovery [T1087;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
4.5		- Execution::Windows Management Instrumentation [T1047;4.5]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 37.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FeJb7z1HIg2HPkLqKb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.17 MB
Data read: 0.16 MB (ratio 1.05:1)
Time: 44.208 sec (0 m 44 s)
Start Date: 2022:02:07 14:13:11
End Date:   2022:02:07 14:13:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:13:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:14:01Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Windows Management Instrumentation [T1047;4.5]', '4.5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['37.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
738.2470565384855
============================================


==================================================================
Fichier HTTP-FeJb7z1HIg2HPkLqKb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfuWLndFwkneudk08.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfuWLndFwkneudk08.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.03 MB
Data read: 0.97 MB (ratio 1.06:1)
Time: 44.205 sec (0 m 44 s)
Start Date: 2022:02:07 14:14:02
End Date:   2022:02:07 14:14:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:14:02Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FfuWLndFwkneudk08.exe SCORE: 409 TYPE: EXE SIZE: 1015944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7dbed49fa0> 
MD5: 7a32d32f1e6d327f9adab871ba83aef3 
SHA1: 3f9a3bc046fad113fcc5a809ab98dce495cecaa5 
SHA256: 2bb06d7f050031f587eb3041952ba5312deeb234ecfe658136bf17a7450db2fc CREATED: Mon Feb  7 14:14:02 2022 MODIFIED: Mon Feb  7 14:14:02 2022 ACCESSED: Mon Feb  7 14:14:53 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 0ef37e9732bb247e3978f5e17dd65686 Str2: c7c7d9542f7252f4362267a060bbc20d Str3: d70dd71faf241293299ef257245aa4bc Str4: fdaeaf418c9d7e82 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:14:56Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		Debugger_Check__QueryInfo
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 409

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7a32d32f1e6d327f9adab871ba83aef3                                                   |
| sha1                   | 3f9a3bc046fad113fcc5a809ab98dce495cecaa5                                           |
| sha256                 | 2bb06d7f050031f587eb3041952ba5312deeb234ecfe658136bf17a7450db2fc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FfuWLndFwkneudk08.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (18 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('Debugger_Check__QueryInfo', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['409']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6542.071026615019
============================================


==================================================================
Fichier HTTP-FfuWLndFwkneudk08.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FTeSe53QvURgeLMp21.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FTeSe53QvURgeLMp21.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.30 MB
Data read: 0.29 MB (ratio 1.05:1)
Time: 42.863 sec (0 m 42 s)
Start Date: 2022:02:07 14:17:47
End Date:   2022:02:07 14:18:30

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:17:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FTeSe53QvURgeLMp21.exe SCORE: 434 TYPE: EXE SIZE: 304712 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa9df6fcfa0> 
MD5: 3188cdc07256812f554e31432ef6b8c6 
SHA1: 13929ad3e0ab7c77cf9d7e6ef955df3a795d4c78 
SHA256: 4d7b19afa6159fc77c593115143da7c47ee09e7f0fd4da58eb7b371c75be4748 CREATED: Mon Feb  7 14:17:47 2022 MODIFIED: Mon Feb  7 14:17:47 2022 ACCESSED: Mon Feb  7 14:18:37 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e85b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_16: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_17: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:18:39Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 434

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3188cdc07256812f554e31432ef6b8c6                                                   |
| sha1                   | 13929ad3e0ab7c77cf9d7e6ef955df3a795d4c78                                           |
| sha256                 | 4d7b19afa6159fc77c593115143da7c47ee09e7f0fd4da58eb7b371c75be4748                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FTeSe53QvURgeLMp21.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag (2 matches)         | anti-analysis/anti-debugging/debugger-detection      |
| listen for remote procedure calls                    | communication/rpc/server                             |
| encrypt or decrypt data via BCrypt (4 matches)       | data-manipulation/encryption                         |
| hash data via BCrypt (3 matches)                     | data-manipulation/hashing                            |
| generate random numbers via WinAPI (2 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get system information on Windows                    | host-interaction/os/info                             |
| terminate process via fastfail (21 matches)          | host-interaction/process/terminate                   |
| get kernel32 base address (3 matches)                | linking/runtime-linking                              |
| access PE header                                     | load-code/pe                                         |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 13.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['434']
-------------- CAPA_Score ------------
['13.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
7147.79686780203
============================================


==================================================================
Fichier HTTP-FTeSe53QvURgeLMp21.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FYEcTu2k2RVhrvpCZ6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2b8bec5bcb1777eaa155d832f7afc797                                                   |
| sha1                   | 356d60df7a64367ca059d8e1fae02a9d4160e9da                                           |
| sha256                 | 782a48821d88060adf0f7ef3e8759fee3ddad49e942daad18c5af8ae0e9eb51e                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FYEcTu2k2RVhrvpCZ6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Scheduled Task/Job::Scheduled Task \[T1053.005]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Create UDP Socket [C0001.010]                           |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data (2 matches)                             | communication                                        |
| send data                                            | communication                                        |
| creates tcp or udp socket (4 matches)                | communication/socket                                 |
| create UDP socket                                    | communication/socket/udp/send                        |
| act as TCP client (3 matches)                        | communication/tcp/client                             |
| decode data using Base64 via WinAPI (7 matches)      | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| decrypt data via SSPI                                | data-manipulation/encryption                         |
| encrypt data via SSPI                                | data-manipulation/encryption                         |
| get client handle via SChannel                       | data-manipulation/encryption                         |
| encrypt data using RC4 KSA (2 matches)               | data-manipulation/encryption/rc4                     |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory                                     | host-interaction/file-system/create                  |
| delete directory                                     | host-interaction/file-system/delete                  |
| delete file                                          | host-interaction/file-system/delete                  |
| write file on Windows                                | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| get disk information                                 | host-interaction/hardware/storage                    |
| check mutex                                          | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| get session user name (2 matches)                    | host-interaction/session                             |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| access PEB ldr_data (2 matches)                      | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| schedule task via ITaskScheduler                     | persistence/scheduled-tasks                          |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
3		- Discovery::Account Discovery [T1087;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
5		- Persistence/Scheduled Task/Job/Scheduled Task [T1053.005;5]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Discovery::Application Window Discovery [T1010;4]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 53.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FYEcTu2k2RVhrvpCZ6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 43.600 sec (0 m 43 s)
Start Date: 2022:02:07 14:18:49
End Date:   2022:02:07 14:19:33

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:18:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FYEcTu2k2RVhrvpCZ6.exe SCORE: 569 TYPE: EXE SIZE: 31232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8c59911fa0> 
MD5: 2b8bec5bcb1777eaa155d832f7afc797 
SHA1: 356d60df7a64367ca059d8e1fae02a9d4160e9da 
SHA256: 782a48821d88060adf0f7ef3e8759fee3ddad49e942daad18c5af8ae0e9eb51e CREATED: Mon Feb  7 14:18:49 2022 MODIFIED: Mon Feb  7 14:18:49 2022 ACCESSED: Mon Feb  7 14:19:42 2022 
REASON_1: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.dll Str2: wsock32.dll Str3: socket Str4: send Str5: connect Str6: WSAStartup Str7: closesocket Str8: WSACleanup
REASON_2: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.dll Str2: dnsapi.dll Str3: wsock32.dll Str4: getaddrinfo Str5: DnsQuery
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: WriteFile Str3: SetFilePointer Str4: DeleteFileA Str5: CreateFileA Str6: CopyFile
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: ws2_32.dll Str2: wsock32.dll
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: win_systembc_auto SUBSCORE: 45 
DESCRIPTION: Detects win.systembc. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: ff75fce830030000ff75fce8620200005e5f Str2: 4f8bc75e5f Str3: 8b85f4feffffeb038b46185e5f5bc9 Str4: 8b450cab8b4514ab Str5: 74f4368a94290 ... (truncated)
REASON_9: Yara Rule MATCH: MiniTor SUBSCORE: 50 
DESCRIPTION: Identifies MiniTor implementation as seen in SystemBC and Parallax RAT. REF: https://news.sophos.com/en-us/2020/12/16/systembc/ AUTHOR: @bartblaze 
MATCHES: Str1: 558bec81c4f0fdffff5157568d4df42bcc518d44241050e8472500006a0f8d8500feffff50680c834000e8ad2400008d850ffeffff506a14ff7510e8b42800008d85f ... (truncated)
REASON_10: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d305c645d401c645d500c645 Str2: c645d401c645d500c645d601c645 Str3: c645d500c645d601c645d700c645 Str4: c645d601c645d700c645d800c645 ... (truncated)
REASON_12: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_13: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec81 Str2: 558bec83 Str3: 558bec53 Str4: 558bec51 Str5: 558bec60
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: guard.exe
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:19:42Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_tcp_socket
50		network_dns
60		win_mutex
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
45		win_systembc_auto
50		MiniTor
2		math_entropy_5
5		obfuscation_singlebyte_mov
5		executable_pe
5		winsocks
70		Microsoft_Visual_Cpp_v50v60_MFC
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
50		Antivirus_strings
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 569

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Persistence/Scheduled Task/Job/Scheduled Task [T1053.005;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_tcp_socket', '50'), ('network_dns', '50'), ('win_mutex', '60'), ('win_token', '65'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('win_systembc_auto', '45'), ('MiniTor', '50'), ('math_entropy_5', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('winsocks', '5'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Antivirus_strings', '50'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['569']
-------------- CAPA_Score ------------
['53.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
10085.507603612086
============================================


==================================================================
Fichier HTTP-FYEcTu2k2RVhrvpCZ6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FHG56f2Kxe9qwyFK2c.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b94af4a4d4af6eac81fc135abda1c40c                                                   |
| sha1                   | d6356b2c6f8d29f8626062b5aefb13b7fc744d54                                           |
| sha256                 | 6ac06dfa543dca43327d55a61d0aaed25f3c90cce791e0555e3e306d47107859                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FHG56f2Kxe9qwyFK2c.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DEFENSE EVASION             | Self Deletion::COMSPEC Environment Variable [F0007.001]                       |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| self delete                                          | anti-analysis/anti-forensic/self-deletion            |
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| read and send data from client to server             | c2/file-transfer                                     |
| receive and write data from server to client         | c2/file-transfer                                     |
| creates tcp or udp socket                            | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| act as TCP client                                    | communication/tcp/client                             |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| modify service                                       | host-interaction/service/modify                      |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]

Score total: 53.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FHG56f2Kxe9qwyFK2c.exe: Win.Dropper.Ulise-9937584-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 39.698 sec (0 m 39 s)
Start Date: 2022:02:07 14:19:42
End Date:   2022:02:07 14:20:22

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.Ulise-9937584-0

Score total: 30.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5')]
---------------- ClamAV_Rules --------------
[('Win.Dropper.Ulise-9937584-0', '30')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('VC6_Random', '15')]
-------------- LOKI_Score ------------
['669']
-------------- CAPA_Score ------------
['53.5']
-------------- CLAMAV_Score ------------
['30.0']
-------------- SCORE FINAL ------------
12048.07841961145
============================================


==================================================================
Fichier HTTP-FHG56f2Kxe9qwyFK2c.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCXqtO1wbQKrSjlFj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCXqtO1wbQKrSjlFj.exe: Win.Malware.Beaugrit-9835568-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 42.190 sec (0 m 42 s)
Start Date: 2022:02:07 14:20:33
End Date:   2022:02:07 14:21:15

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Beaugrit-9835568-0

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:20:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FCXqtO1wbQKrSjlFj.exe SCORE: 784 TYPE: EXE SIZE: 53346 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3d5f581fa0> 
MD5: 9324d1a8ae37a36ae560c37448c9705a 
SHA1: 042eb46fbd8480f85a860266907cab24954d57e1 
SHA256: a3d7bfbdd9e9f72fb9201a8e7f05f524007ed3ac2172c51a49bd361cb39aaf0f CREATED: Mon Feb  7 14:20:33 2022 MODIFIED: Mon Feb  7 14:20:33 2022 ACCESSED: Mon Feb  7 14:21:24 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: CopyFile
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetOpen
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645f072c645f175c645f26ec645 Str2: c645f633c645f732c645f82ec645 Str3: c645f732c645f82ec645f965c645 Str4: c645f82ec645f965c645fa78c645 ... (truncated)
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68a892400068907e400064a100000000506489250000000083ec14535657 Str3: 558bec6aff68c892400068907e400064a100000000506489 ... (truncated)
REASON_13: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff689892400068907e400064a10000000050 Str2: 558bec6aff68a892400068907e400064a10000000050 Str3: 558bec6aff68b892400068907e40006 ... (truncated)
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff689892400068907e400064a10000000050 Str2: 558bec6aff68a892400068907e400064a10000000050 Str3: 558bec6aff68b892400068907e40006 ... (truncated)
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec83 Str3: 558bec81 Str4: 558bec53 Str5: 558bec6aff689892400068907e400064a10000000050 Str6: 558bec6aff68a892400068 ... (truncated)
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff689892400068907e400064a1000000005064892500000000 Str2: 558bec6aff68a892400068907e400064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_17: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_20: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_21: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_22: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_24: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_25: Yara Rule MATCH: LimaAlfa SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: Novetta Threat Research & Interdiction Group - trig@novetta.com 
MATCHES: Str1: 33c0668b028be881e500f0ffff81fd00300000750d8b6c241825ff0f000003c701
REASON_26: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_27: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:21:24Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_5
5		obfuscation_singlebyte_mov
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Init
60		LimaAlfa
20		isExecutable
10		Contains_PE_File

Score total: 784

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Beaugrit-9835568-0', '50')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Init', '40'), ('LimaAlfa', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['784']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
13055.025334792212
============================================


==================================================================
Fichier HTTP-FCXqtO1wbQKrSjlFj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FbsA5s2PdbrcymCwv5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dafbfa941f1d5af65c296a2b22d0ec7a                                                   |
| sha1                   | eaad1642d87dc72247930f93d7800f5e4c12e82c                                           |
| sha256                 | 5319c6b57e4dbf9cf23362bce0835a5deae25ff1036ea2766033333db6295f97                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FbsA5s2PdbrcymCwv5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FbsA5s2PdbrcymCwv5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.25 MB
Data read: 0.24 MB (ratio 1.03:1)
Time: 42.920 sec (0 m 42 s)
Start Date: 2022:02:07 14:21:25
End Date:   2022:02:07 14:22:07

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:21:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FbsA5s2PdbrcymCwv5.exe SCORE: 149 TYPE: EXE SIZE: 250696 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fcccbc76fa0> 
MD5: dafbfa941f1d5af65c296a2b22d0ec7a 
SHA1: eaad1642d87dc72247930f93d7800f5e4c12e82c 
SHA256: 5319c6b57e4dbf9cf23362bce0835a5deae25ff1036ea2766033333db6295f97 CREATED: Mon Feb  7 14:21:25 2022 MODIFIED: Mon Feb  7 14:21:25 2022 ACCESSED: Mon Feb  7 14:22:15 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:22:16Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_7
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		IsPacked
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 149

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_7', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['149']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2421.348726216125
============================================


==================================================================
Fichier HTTP-FbsA5s2PdbrcymCwv5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FzUedg4DKmbUzDSY96.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FzUedg4DKmbUzDSY96.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.30 MB
Data read: 0.28 MB (ratio 1.06:1)
Time: 43.721 sec (0 m 43 s)
Start Date: 2022:02:07 14:22:16
End Date:   2022:02:07 14:23:00

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | fd5ea005e9ac54c8692ef8d8dbcc8a0c                                                   |
| sha1                   | 084e7e6db9b1047ff1171bc29696ae4a00459197                                           |
| sha256                 | d40375ca08c682192bd6f57dcc43f056eb75ce61afb9172776253589be21194c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FzUedg4DKmbUzDSY96.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| get file system object information (2 matches)       | host-interaction/file-system                         |
| delete file (5 matches)                              | host-interaction/file-system/delete                  |
| get file size (4 matches)                            | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| create thread                                        | host-interaction/thread/create                       |
| resume thread                                        | host-interaction/thread/resume                       |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
4		- Discovery::Application Window Discovery [T1010;4]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]

Score total: 28.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:22:17Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FzUedg4DKmbUzDSY96.exe SCORE: 299 TYPE: EXE SIZE: 297472 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1592e8bfa0> 
MD5: fd5ea005e9ac54c8692ef8d8dbcc8a0c 
SHA1: 084e7e6db9b1047ff1171bc29696ae4a00459197 
SHA256: d40375ca08c682192bd6f57dcc43f056eb75ce61afb9172776253589be21194c CREATED: Mon Feb  7 14:22:16 2022 MODIFIED: Mon Feb  7 14:22:16 2022 ACCESSED: Mon Feb  7 14:23:09 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:23:09Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 299

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['299']
-------------- CAPA_Score ------------
['28.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5297.504093650015
============================================


==================================================================
Fichier HTTP-FzUedg4DKmbUzDSY96.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDTlcLPvSnJLX7x97.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 8b21545a9a6b5fa8894bb8ec4d06de5b                                                   |
| sha1                   | 3feb6f204ad4a1a8653f66e73dc35c9555f49b88                                           |
| sha256                 | 6e9d3fc3e4c502592e48a42aaa498180eaa11a2b3dbb2e5aede88a2e74ad8f43                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FDTlcLPvSnJLX7x97.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDTlcLPvSnJLX7x97.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 43.899 sec (0 m 43 s)
Start Date: 2022:02:07 14:23:10
End Date:   2022:02:07 14:23:54

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:23:10Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FDTlcLPvSnJLX7x97.exe SCORE: 264 TYPE: EXE SIZE: 64248 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4f0fd08fa0> 
MD5: 8b21545a9a6b5fa8894bb8ec4d06de5b 
SHA1: 3feb6f204ad4a1a8653f66e73dc35c9555f49b88 
SHA256: 6e9d3fc3e4c502592e48a42aaa498180eaa11a2b3dbb2e5aede88a2e74ad8f43 CREATED: Mon Feb  7 14:23:10 2022 MODIFIED: Mon Feb  7 14:23:10 2022 ACCESSED: Mon Feb  7 14:24:01 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: ConventionEngine_Keyword_Install SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453a5fa96a1a66ab8489e4408a7632f3eda01000000453a5c5744462d494d4339302d4a4f42315c77696e31305f6275696c647465616d5f4d6f6465726e2e536 ... (truncated)
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:24:02Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
50		ConventionEngine_Keyword_Install
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		ImportTableIsBad
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 264

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '10'), ('ft_exe', '10'), ('ConventionEngine_Keyword_Install', '50'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('ImportTableIsBad', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['264']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4204.070651247028
============================================


==================================================================
Fichier HTTP-FDTlcLPvSnJLX7x97.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FJ9DrSP5wdmb3khsf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 61908f4d70ce6f16173e76aa42a8c25a                                                   |
| sha1                   | fd47522692c262de30da8d1f682dd014281d9317                                           |
| sha256                 | d7ff81ff775d4ab50d31ac1e962c8c4dea7ff9f280aa2b42ddd06760a5665002                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FJ9DrSP5wdmb3khsf.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::User Activity Based Checks \[T1497.002]\           |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Human User Check [B0009.012]                       |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for unmoving mouse cursor                      | anti-analysis/anti-vm/vm-detection                   |
| get geographical location                            | collection                                           |
| decompress data using aPLib                          | data-manipulation/compression                        |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| read file on Windows                                 | host-interaction/file-system/read                    |
| read file via mapping                                | host-interaction/file-system/read                    |
| check OS version                                     | host-interaction/os/version                          |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
7.5		- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 20.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FJ9DrSP5wdmb3khsf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.753 sec (0 m 43 s)
Start Date: 2022:02:07 14:24:02
End Date:   2022:02:07 14:24:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]', '7.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_7', '2'), ('executable_pe', '5'), ('Armadillo_v4x', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['284']
-------------- CAPA_Score ------------
['20.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4900.149129583338
============================================


==================================================================
Fichier HTTP-FJ9DrSP5wdmb3khsf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FLqwho1rrHJqCvthhe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FLqwho1rrHJqCvthhe.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 43.881 sec (0 m 43 s)
Start Date: 2022:02:07 14:24:54
End Date:   2022:02:07 14:25:38

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c56af5561e3f20bed435fb4355cffc29                                                   |
| sha1                   | 7e0e6900f4528e7dacb65ab1b1c107425d2a321b                                           |
| sha256                 | 70aaf2b367b97fa35d599a6db4d08875206ef18c99d8c8c5b5f25e4f5509931a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FLqwho1rrHJqCvthhe.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
| CREDENTIAL ACCESS      | Credentials from Password Stores::Windows Credential Manager \[T1555.004]\          |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                               |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| acquire credentials from Windows Credential Manager  | collection                                           |
| encode data using XOR (9 matches)                    | data-manipulation/encoding/xor                       |
| authenticate HMAC (2 matches)                        | data-manipulation/hmac                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| open clipboard                                       | host-interaction/clipboard                           |
| replace clipboard data                               | host-interaction/clipboard                           |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| delete file (3 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read .ini file (7 matches)                           | host-interaction/file-system/read                    |
| read file on Windows (2 matches)                     | host-interaction/file-system/read                    |
| read file via mapping                                | host-interaction/file-system/read                    |
| write file on Windows (4 matches)                    | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| enumerate internet cache                             | host-interaction/internet/cache                      |
| read process memory                                  | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| enumerate processes                                  | host-interaction/process/list                        |
| acquire debug privileges                             | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| delete registry value                                | host-interaction/registry/delete                     |
| link many functions at runtime (7 matches)           | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (4 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Collection::Clipboard Data [T1115;6]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
8		- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Software Discovery [T1518;4]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 67.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:24:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FLqwho1rrHJqCvthhe.exe SCORE: 444 TYPE: EXE SIZE: 101376 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f17c908afa0> 
MD5: c56af5561e3f20bed435fb4355cffc29 
SHA1: 7e0e6900f4528e7dacb65ab1b1c107425d2a321b 
SHA256: 70aaf2b367b97fa35d599a6db4d08875206ef18c99d8c8c5b5f25e4f5509931a CREATED: Mon Feb  7 14:24:54 2022 MODIFIED: Mon Feb  7 14:24:54 2022 ACCESSED: Mon Feb  7 14:25:45 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: SeDebugPrivilege Str4: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: RegQueryValueExA Str4: RegOpenKeyExA Str5: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: AdjustTokenPrivileges Str4: OpenProcessToken Str5: LookupPrivilegeValueA
REASON_5: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: GetPrivateProfileIntA Str4: GetPrivateProfileStringA Str5: WritePrivateProfileStringA
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: FindFir ... (truncated)
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645f401c645f500c645f600c645 Str2: c645f500c645f600c645f700c645 Str3: c645ec01c645f0d0c645f18cc645 Str4: c645f0d0c645f18cc645f29dc645 ... (truncated)
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
REASON_21: Yara Rule MATCH: DES_sbox SUBSCORE: 15 
DESCRIPTION: DES [sbox] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:25:46Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
65		screenshot
20		win_registry
65		win_token
10		win_private_profile
10		win_files_operation
10		Str_Win32_Wininet_Library
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Init
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API
15		DES_sbox

Score total: 444

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Collection::Clipboard Data [T1115;6]', '6'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]', '8'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('screenshot', '65'), ('win_registry', '20'), ('win_token', '65'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Advapi_Hash_API', '20'), ('DES_sbox', '15')]
-------------- LOKI_Score ------------
['444']
-------------- CAPA_Score ------------
['67.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8373.751525556492
============================================


==================================================================
Fichier HTTP-FLqwho1rrHJqCvthhe.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOMrjo1ZtFXjqVBMY8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e2bf42217a67e46433da8b6f4507219e                                                   |
| sha1                   | daf263702f11dc0430d30f9bf443e7885cf91fcb                                           |
| sha256                 | ae8a1c7eb64c42ea2a04f97523ebf0844c27029eb040d910048b680f884b9dce                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FOMrjo1ZtFXjqVBMY8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| get common file path                                 | host-interaction/file-system                         |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| read process memory                                  | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
2		- Execution::Shared Modules [T1129;2]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOMrjo1ZtFXjqVBMY8.exe: Win.Malware.Explorerhijack-9937586-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FOMrjo1ZtFXjqVBMY8.exe: Win.Malware.Explorerhijack-9937587-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 42.153 sec (0 m 42 s)
Start Date: 2022:02:07 14:25:46
End Date:   2022:02:07 14:26:28

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Explorerhijack-9937586-0
50		Win.Malware.Explorerhijack-9937587-0

Score total: 100.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Explorerhijack-9937586-0', '50'), ('Win.Malware.Explorerhijack-9937587-0', '50')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('ThreadControl__Context_v1', '60'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['649']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['100.0']
-------------- SCORE FINAL ------------
11744.40846236368
============================================


==================================================================
Fichier HTTP-FOMrjo1ZtFXjqVBMY8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSf12C2prd2NNfWSGl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSf12C2prd2NNfWSGl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.36 MB
Data read: 0.34 MB (ratio 1.05:1)
Time: 44.164 sec (0 m 44 s)
Start Date: 2022:02:07 14:26:40
End Date:   2022:02:07 14:27:24

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa2 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa2 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:26:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FSf12C2prd2NNfWSGl.exe SCORE: 574 TYPE: EXE SIZE: 363008 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe77b9c5fa0> 
MD5: 0c605276ff21b5150365b7d1991f5904 
SHA1: 2d336978af261e07b1ecfaf65dc903b239e287a4 
SHA256: 720610b9067c8afe857819a098a44cab24e9da5cf6a086351d01b73714afd397 CREATED: Mon Feb  7 14:26:40 2022 MODIFIED: Mon Feb  7 14:26:40 2022 ACCESSED: Mon Feb  7 14:27:30 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA Str6: FindClose
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8418945ece90fffffff Str2: e829050000e974feffff Str3: e83e080000e977ffffff Str4: e80f060000e977ffffff Str5: e861b4ffffe96cffffff
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1:  Str2: PE Str3: @B Str4: 00000000000000000000000000000000000070a24400401343001c0000002cb242000000000000000000000000000001000000000000 ... (truncated)
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Process_Doppelganging SUBSCORE: 35 
DESCRIPTION: Detect Process Doppelganging REF: https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_ 
MATCHES: Str1: CreateTransaction Str2: CreateFileTransacted Str3: WriteFile Str4: RollbackTransaction
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_17: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_19: Yara Rule MATCH: MAL_Stashlog_Sep_2021_1 SUBSCORE: 70 
DESCRIPTION: Detect Stashlog malware REF: https://www.fireeye.com/blog/threat-research/2021/09/unknown-actor-using-clfs-log-files-for-stealth.html AUTHOR: Arkbird_SOLG 
MATCHES: Str1: 497E724A7BA2764BB4570B225601FB693A796873E7847DB943F7FE9E7281C91A443DF1F8519CBB25FC736CC65BF3DE67A82E704BEB698E17 Str2: 5083ec0c89e031 ... (truncated)
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_23: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:27:31Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
2		PE_File
35		Anti_Automated_Sandbox
35		Process_Doppelganging
30		Check_OutputDebugStringA_iat_v1
40		SEH_Save
40		SEH_Init
30		Check_OutputDebugStringA_iat
10		anti_dbg
70		MAL_Stashlog_Sep_2021_1
20		isExecutable
10		Contains_PE_File
15		RIPEMD160_Constants
20		SHA1_Constants

Score total: 574

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 0c605276ff21b5150365b7d1991f5904                                                   |
| sha1                   | 2d336978af261e07b1ecfaf65dc903b239e287a4                                           |
| sha256                 | 720610b9067c8afe857819a098a44cab24e9da5cf6a086351d01b73714afd397                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSf12C2prd2NNfWSGl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Cryptographic Hash::SHA1 [C0029.002]                                          |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| read file via mapping (2 matches)                    | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| get disk size                                        | host-interaction/hardware/storage                    |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 7.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Process_Doppelganging', '35'), ('Check_OutputDebugStringA_iat_v1', '30'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('MAL_Stashlog_Sep_2021_1', '70'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('RIPEMD160_Constants', '15'), ('SHA1_Constants', '20')]
-------------- LOKI_Score ------------
['574']
-------------- CAPA_Score ------------
['7.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
9236.955286774612
============================================


==================================================================
Fichier HTTP-FSf12C2prd2NNfWSGl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fj6IHS3DFUymatS8z4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fj6IHS3DFUymatS8z4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.24 MB
Data read: 0.23 MB (ratio 1.03:1)
Time: 42.938 sec (0 m 42 s)
Start Date: 2022:02:07 14:30:05
End Date:   2022:02:07 14:30:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:30:05Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fj6IHS3DFUymatS8z4.exe SCORE: 234 TYPE: EXE SIZE: 249054 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f75cc977fa0> 
MD5: 068a76d4823419b376d418cf03215d5c 
SHA1: 4096855ff2c286c737ccf298ea048219cbe8e537 
SHA256: 39655d8f0d03173bd98de4d6f0c9bde51bc7ea0deed3a644ccd5d7732052e9c6 CREATED: Mon Feb  7 14:30:05 2022 MODIFIED: Mon Feb  7 14:30:05 2022 ACCESSED: Mon Feb  7 14:30:57 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Basic_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: h
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: rlpack SUBSCORE: 15 
DESCRIPTION: RLPack packed file REF: - AUTHOR: - 
MATCHES: Str1: MZ Str2: .packed Str3: .RLPack
REASON_11: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: .packed Str2: .RLPack
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:30:57Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		Microsoft_Visual_Basic_v50
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasRichSignature
2		PE_File
15		rlpack
60		suspicious_packer_section
20		isExecutable
10		Contains_PE_File

Score total: 234

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Basic_v50', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('rlpack', '15'), ('suspicious_packer_section', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['234']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3708.650070359005
============================================


==================================================================
Fichier HTTP-Fj6IHS3DFUymatS8z4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6l0dp40GCjHrfBVXi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6l0dp40GCjHrfBVXi.exe: Win.Trojan.Agent-375080 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.04 MB (ratio 1.44:1)
Time: 44.563 sec (0 m 44 s)
Start Date: 2022:02:07 14:30:58
End Date:   2022:02:07 14:31:42

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-375080
75		Win.Trojan.Agent-375080
45		Win.Trojan.Agent-375080

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:30:58Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F6l0dp40GCjHrfBVXi.exe SCORE: 714 TYPE: EXE SIZE: 36864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f62b3853fa0> 
MD5: 625ac05fd47adc3c63700c3b30de79ab 
SHA1: 9369d80106dd245938996e245340a3c6f17587fe 
SHA256: 0fa1498340fca6c562cfa389ad3e93395f44c72fd128d7ba08579a69aaf3b126 CREATED: Mon Feb  7 14:30:58 2022 MODIFIED: Mon Feb  7 14:30:58 2022 ACCESSED: Mon Feb  7 14:31:49 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: CreateFileA
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_1 SUBSCORE: 2 
DESCRIPTION: Very low entropy - repeating 2 bytes REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff6898204000681017400064a100000000506489250000000083ec20535657 Str3: 558bec6aff6858204000687012400064a100000000506489 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a10000000050 Str2: 558bec6aff6858204000687012400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a10000000050 Str2: 558bec6aff6858204000687012400064a10000000050
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec81 Str2: 558bec83 Str3: 558becb8 Str4: 558bec6a Str5: 558bec6aff6898204000681017400064a10000000050 Str6: 558bec6aff685820400068 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a1000000005064892500000000 Str2: 558bec6aff6858204000687012400064a1000000005064892500000000
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:31:49Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
70		escalate_priv
65		win_token
10		win_files_operation
10		ft_exe
2		math_entropy_1
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 714

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-375080', '70'), ('Win.Trojan.Agent-375080', '75'), ('Win.Trojan.Agent-375080', '45')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('escalate_priv', '70'), ('win_token', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_1', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['714']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
13708.095676581266
============================================


==================================================================
Fichier HTTP-F6l0dp40GCjHrfBVXi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFXWAo25Wl6NPTwEE3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFXWAo25Wl6NPTwEE3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.67 MB
Data read: 0.63 MB (ratio 1.06:1)
Time: 45.243 sec (0 m 45 s)
Start Date: 2022:02:07 14:31:50
End Date:   2022:02:07 14:32:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 64: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 55: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 54: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 53: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 47: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 45: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 38: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 33: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 32: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 26: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 25: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 24: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 4: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:31:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFXWAo25Wl6NPTwEE3.exe SCORE: 1689 TYPE: EXE SIZE: 665088 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9154009fa0> 
MD5: 66602b5fab602cb4e6f754748d249542 
SHA1: 105232653edcf20ce539973401aa8015232c5cdf 
SHA256: c5144dd0a675e0c9d7f7a9cab034a680d99a8e8ae56e3588a1f3e0b2e8d917f3 CREATED: Mon Feb  7 14:31:50 2022 MODIFIED: Mon Feb  7 14:31:50 2022 ACCESSED: Mon Feb  7 14:32:42 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645fc08c645fc09c645fc0ac645 Str2: c645fc09c645fc0ac645fc0bc645 Str3: c645fc0ac645fc0bc645fc0cc645
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e81a050000e987feffff Str2: e8ddceffffe992feffff Str3: e893cdffffe98cfdffff Str4: e8e0ccffffe9fbfcffff Str5: e8e1f2ffffe9fbfeffff Str6 ... (truncated)
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_15: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_16: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_17: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_34: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_35: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_36: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_37: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_38: Yara Rule MATCH: RijnDael_AES_CHAR SUBSCORE: 15 
DESCRIPTION: RijnDael AES (check2) [char] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:32:43Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
15		RijnDael_AES_CHAR

Score total: 1689

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 66602b5fab602cb4e6f754748d249542                                                   |
| sha1                   | 105232653edcf20ce539973401aa8015232c5cdf                                           |
| sha256                 | c5144dd0a675e0c9d7f7a9cab034a680d99a8e8ae56e3588a1f3e0b2e8d917f3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFXWAo25Wl6NPTwEE3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| CRYPTOGRAPHY                | Crypto Library:: [C0059]                                                      |
|                             | Decrypt Data::AES [C0031.001]                                                 |
|                             | Encrypt Data::AES [C0027.001]                                                 |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| initialize Winsock library                            | communication/socket                                 |
| encode data using XOR (4 matches)                     | data-manipulation/encoding/xor                       |
| decrypt data using AES via x86 extensions (2 matches) | data-manipulation/encryption/aes                     |
| encrypt data using AES via x86 extensions             | data-manipulation/encryption/aes                     |
| contains PDB path                                     | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section         | executable/pe/section/tls                            |
| set environment variable                              | host-interaction/environment-variable                |
| allocate thread local storage                         | host-interaction/process                             |
| allocate RWX memory                                   | host-interaction/process/inject                      |
| linked against Crypto++                               | linking/static/cryptopp                              |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]

Score total: 13.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('RijnDael_AES_CHAR', '15')]
-------------- LOKI_Score ------------
['1689']
-------------- CAPA_Score ------------
['13.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
27038.206433189003
============================================


==================================================================
Fichier HTTP-FFXWAo25Wl6NPTwEE3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F4WggU2sfT0JvnfKT9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 766597058149125847962eecf0c6dac0                                                   |
| sha1                   | 3c75ac9f8ff661f133acb9dd1a8e210a9a0a3d0c                                           |
| sha256                 | 6b877d6bb0fb40835fd4494003b14377feeb8a304fa1a850f0067b4c8cadeefc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F4WggU2sfT0JvnfKT9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| CREDENTIAL ACCESS      | Input Capture::GUI Input Capture \[T1056.002]\                                     |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| prompt user for credentials                          | collection/credentials                               |
| log keystrokes via polling (3 matches)               | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| create thread                                        | host-interaction/thread/create                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 21.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F4WggU2sfT0JvnfKT9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.11 MB
Data read: 0.11 MB (ratio 1.00:1)
Time: 43.945 sec (0 m 43 s)
Start Date: 2022:02:07 14:33:17
End Date:   2022:02:07 14:34:01

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:33:17Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F4WggU2sfT0JvnfKT9.exe SCORE: 179 TYPE: EXE SIZE: 113152 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7eecea7fa0> 
MD5: 766597058149125847962eecf0c6dac0 
SHA1: 3c75ac9f8ff661f133acb9dd1a8e210a9a0a3d0c 
SHA256: 6b877d6bb0fb40835fd4494003b14377feeb8a304fa1a850f0067b4c8cadeefc CREATED: Mon Feb  7 14:33:17 2022 MODIFIED: Mon Feb  7 14:33:17 2022 ACCESSED: Mon Feb  7 14:34:09 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:34:10Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 179

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('keylogger', '80'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['179']
-------------- CAPA_Score ------------
['21.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3265.9402122237016
============================================


==================================================================
Fichier HTTP-F4WggU2sfT0JvnfKT9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FJGu3g2s4ytkooZgYi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 004091b8024936ff322c11cf370f2184                                                   |
| sha1                   | 8208fee26d92e661a8f65a721b272ae931bc7692                                           |
| sha256                 | 6210fa6ade115dd07409cfae21683b1772d6d3fdb6b438814cacbd3588dad9e3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FJGu3g2s4ytkooZgYi.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| query or enumerate registry value                    | host-interaction/registry                            |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 7.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FJGu3g2s4ytkooZgYi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 43.017 sec (0 m 43 s)
Start Date: 2022:02:07 14:34:10
End Date:   2022:02:07 14:34:53

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:34:10Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FJGu3g2s4ytkooZgYi.exe SCORE: 294 TYPE: EXE SIZE: 22016 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f66a773efa0> 
MD5: 004091b8024936ff322c11cf370f2184 
SHA1: 8208fee26d92e661a8f65a721b272ae931bc7692 
SHA256: 6210fa6ade115dd07409cfae21683b1772d6d3fdb6b438814cacbd3588dad9e3 CREATED: Mon Feb  7 14:34:10 2022 MODIFIED: Mon Feb  7 14:34:10 2022 ACCESSED: Mon Feb  7 14:35:02 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0400004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:35:02Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 294

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['294']
-------------- CAPA_Score ------------
['7.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4809.23065945834
============================================


==================================================================
Fichier HTTP-FJGu3g2s4ytkooZgYi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSyj0v4CYHz5oBzCI9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a198216798ca38f280dc413f8c57f2c2                                                   |
| sha1                   | bd2dfda3d3abd9684f8608c4eb1007c26cb0e200                                           |
| sha256                 | 16a7d90a578215fb1796caf1c2ad99126bfd7022f49bd6b8051e925384910712                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSyj0v4CYHz5oBzCI9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| write file on Windows                                | host-interaction/file-system/write                   |
| get ntdll base address                               | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
2		- Execution::Shared Modules [T1129;2]

Score total: 4.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSyj0v4CYHz5oBzCI9.exe: Win.Countermeasure.LoaderWinGeneric-9804845-2 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FSyj0v4CYHz5oBzCI9.exe: Win.Malware.Agent-9870952-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.29 MB
Data read: 0.28 MB (ratio 1.06:1)
Time: 42.413 sec (0 m 42 s)
Start Date: 2022:02:07 14:35:02
End Date:   2022:02:07 14:35:45

-------- Score ----------------
Scores		Rules
.......		...............
60		Win.Countermeasure.LoaderWinGeneric-9804845-2
50		Win.Malware.Agent-9870952-0

Score total: 110.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:35:03Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FSyj0v4CYHz5oBzCI9.exe SCORE: 209 TYPE: EXE SIZE: 292864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f52b8023fa0> 
MD5: a198216798ca38f280dc413f8c57f2c2 
SHA1: bd2dfda3d3abd9684f8608c4eb1007c26cb0e200 
SHA256: 16a7d90a578215fb1796caf1c2ad99126bfd7022f49bd6b8051e925384910712 CREATED: Mon Feb  7 14:35:02 2022 MODIFIED: Mon Feb  7 14:35:02 2022 ACCESSED: Mon Feb  7 14:35:52 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: Trojan_Win_Generic_v101 SUBSCORE: 50 
DESCRIPTION: not set REF: - AUTHOR: FireEye 
MATCHES: Str1: 2a00000041b817000000ba0204000089c1ff15 Str2: 817c243802040000757a48837c244017757248837c24482a75 Str3: ff15328c0400ffd32d5802000029f03 ... (truncated)
REASON_3: Yara Rule MATCH: Trojan_Win_Generic_101 SUBSCORE: 70 
DESCRIPTION: Detects FireEye Windows trojan REF: https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html AUTHOR: FireEye 
MATCHES: Str1: 2a00000041b817000000ba0204000089c1ff15 Str2: 817c243802040000757a48837c244017757248837c24482a75 Str3: ff15328c0400ffd32d5802000029f03 ... (truncated)
REASON_4: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:35:53Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
50		Trojan_Win_Generic_v101
70		Trojan_Win_Generic_101
2		math_entropy_7
5		executable_pe
10		IsPE64
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 209

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Countermeasure.LoaderWinGeneric-9804845-2', '60'), ('Win.Malware.Agent-9870952-0', '50')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('Trojan_Win_Generic_v101', '50'), ('Trojan_Win_Generic_101', '70'), ('math_entropy_7', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['209']
-------------- CAPA_Score ------------
['4.5']
-------------- CLAMAV_Score ------------
['110.0']
-------------- SCORE FINAL ------------
4787.03152939091
============================================


==================================================================
Fichier HTTP-FSyj0v4CYHz5oBzCI9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6pShA1B2s6mZFtV1b.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3808f21e56dede99bc914d90aeabe47a                                                   |
| sha1                   | 93cc73149d4bb34830a2cb2a3047e9267b9e3080                                           |
| sha256                 | 4a5ac3c6f8383cc33c795804ba5f7f5553c029bbb4a6d28f1e4d8fb5107902c1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6pShA1B2s6mZFtV1b.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                            |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Network Share Discovery:: \[T1135]\                                                |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery :: \[T1016]\                                |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
|                        | Windows Management Instrumentation:: \[T1047]\                                     |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Debugger Detection::Timing/Delay Check QueryPerformanceCounter [B0001.033]    |
| CRYPTOGRAPHY                | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encryption Key:: [C0028]                                                      |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Analysis Tool Discovery::Process Detection [B0013.001]                        |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Console:: [C0033]                                                             |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference analysis tools strings                     | anti-analysis                                        |
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via QueryPerformanceCounter     | anti-analysis/anti-debugging/debugger-detection      |
| connect network resource                             | communication/http                                   |
| encode data using XOR (9 matches)                    | data-manipulation/encoding/xor                       |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| reference public RSA key                             | data-manipulation/encryption/rsa                     |
| encrypt data using Salsa20 or ChaCha (2 matches)     | data-manipulation/encryption/salsa20                 |
| accept command line arguments (3 matches)            | host-interaction/cli                                 |
| manipulate console (2 matches)                       | host-interaction/console                             |
| interact with driver via control codes               | host-interaction/driver                              |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file                                          | host-interaction/file-system/delete                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file size                                        | host-interaction/file-system/meta                    |
| set file attributes                                  | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                    | host-interaction/file-system/write                   |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| enumerate network shares (2 matches)                 | host-interaction/network                             |
| enumerate domain computers via LDAP                  | host-interaction/network/domain                      |
| get domain controller name                           | host-interaction/network/domain                      |
| get hostname (2 matches)                             | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| allocate thread local storage                        | host-interaction/process                             |
| get thread local storage value                       | host-interaction/process                             |
| set thread local storage value                       | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| set registry value                                   | host-interaction/registry/create                     |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| enumerate services                                   | host-interaction/service/list                        |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| get session user name                                | host-interaction/session                             |
| create thread (3 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| connect to WMI namespace via WbemLocator             | host-interaction/wmi                                 |
| parse PE exports (2 matches)                         | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
3		- Discovery::Account Discovery [T1087;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
4		- Discovery::Process Discovery [T1057;4]
4.5		- Execution::Windows Management Instrumentation [T1047;4.5]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
9		- Impact::Service Stop [T1489;9]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 74.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6pShA1B2s6mZFtV1b.exe: Win.Ransomware.MountLocker-9802291-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 44.447 sec (0 m 44 s)
Start Date: 2022:02:07 14:35:54
End Date:   2022:02:07 14:36:38

-------- Score ----------------
Scores		Rules
.......		...............
80		Win.Ransomware.MountLocker-9802291-0

Score total: 80.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:35:54Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F6pShA1B2s6mZFtV1b.exe SCORE: 914 TYPE: EXE SIZE: 68096 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9dac4fefa0> 
MD5: 3808f21e56dede99bc914d90aeabe47a 
SHA1: 93cc73149d4bb34830a2cb2a3047e9267b9e3080 
SHA256: 4a5ac3c6f8383cc33c795804ba5f7f5553c029bbb4a6d28f1e4d8fb5107902c1 CREATED: Mon Feb  7 14:35:54 2022 MODIFIED: Mon Feb  7 14:35:54 2022 ACCESSED: Mon Feb  7 14:36:47 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: CreateService Str3: ControlService Str4: StartService Str5: QueryServiceStatus
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetDC
REASON_4: Yara Rule MATCH: spreading_share SUBSCORE: 70 
DESCRIPTION: Malware can spread east-west using share drive REF: - AUTHOR: x0r 
MATCHES: Str1: NETAPI32.dll Str2: NetShareEnum
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: win_mount_locker_auto SUBSCORE: 45 
DESCRIPTION: Detects win.mount_locker. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 4883f8ff74364883642420004c8d4c2468448bc7488bd3 Str2: ff156e3b00008bd885c0743b488b4d6f488d4567c744243000010000 Str3: ff15f95f00004c8d4 ... (truncated)
REASON_9: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_12: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Detect_Monitoring SUBSCORE: 50 
DESCRIPTION: Check for monitoring tools REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: procexp.exe Str2: procmon.exe
REASON_17: Yara Rule MATCH: anti_dbgtools_v1 SUBSCORE: 60 
DESCRIPTION: Checks for the presence of known debug tools REF: - AUTHOR: x0r 
MATCHES: Str1: procexp.exe Str2: procmon.exe
REASON_18: Yara Rule MATCH: anti_dbgtools SUBSCORE: 55 
DESCRIPTION: Checks for the presence of known debug tools REF: - AUTHOR: x0r 
MATCHES: Str1: procexp.exe Str2: procmon.exe
REASON_19: Yara Rule MATCH: RANSOM_mountlocker SUBSCORE: 60 
DESCRIPTION: Rule to detect Mount Locker ransomware REF: - AUTHOR: McAfee ATR Team 
MATCHES: Str1: cid=%CLIENT_ID
REASON_20: Yara Rule MATCH: RAN_MountLocker_May_2021_1 SUBSCORE: 75 
DESCRIPTION: Detect the Mountlocker ransomware REF: Internal Research AUTHOR: Arkbird_SOLG 
MATCHES: Str1: 48214d774c8d055040000048214d6f458bce488d4d7744897d6733d2c7442420000000f0ff15913b000085c00f840b020000488b4d77488d456f4889442428488d3de ... (truncated)
REASON_21: Yara Rule MATCH: dbgdetect_procs SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: procexp Str2: procmon
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 879538e20b82e80052dd5f7ef9ad5077
REASON_25: Yara Rule MATCH: Chacha_256_constant SUBSCORE: 15 
DESCRIPTION: Look for 256-bit key Chacha stream cipher constant REF: https://tools.ietf.org/html/rfc8439#page-8 AUTHOR: spelissier 
MATCHES: Str1: expand 32-byte k Str2: expand 3 Str3: 2-byte k
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:36:47Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_service
70		escalate_priv
65		screenshot
70		spreading_share
65		win_token
10		win_files_operation
10		ft_exe
45		win_mount_locker_auto
2		math_entropy_4
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
50		Detect_Monitoring
60		anti_dbgtools_v1
55		anti_dbgtools
60		RANSOM_mountlocker
75		RAN_MountLocker_May_2021_1
70		dbgdetect_procs
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
15		Chacha_256_constant

Score total: 914

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Execution::Windows Management Instrumentation [T1047;4.5]', '4.5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;5]', '5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5')]
---------------- ClamAV_Rules --------------
[('Win.Ransomware.MountLocker-9802291-0', '80')]
-------------- LOKI_Rules ------------
[('create_service', '45'), ('escalate_priv', '70'), ('screenshot', '65'), ('spreading_share', '70'), ('win_token', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('win_mount_locker_auto', '45'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Detect_Monitoring', '50'), ('anti_dbgtools_v1', '60'), ('anti_dbgtools', '55'), ('RANSOM_mountlocker', '60'), ('RAN_MountLocker_May_2021_1', '75'), ('dbgdetect_procs', '70'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10'), ('Chacha_256_constant', '15')]
-------------- LOKI_Score ------------
['914']
-------------- CAPA_Score ------------
['74.5']
-------------- CLAMAV_Score ------------
['80.0']
-------------- SCORE FINAL ------------
16979.534533181726
============================================


==================================================================
Fichier HTTP-F6pShA1B2s6mZFtV1b.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fm5OU731DA8nhCUxq6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:36:48Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fm5OU731DA8nhCUxq6.exe SCORE: 409 TYPE: EXE SIZE: 772608 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f73ad59cfa0> 
MD5: e24b2506af9f97069b171dc87240b2f7 
SHA1: 5718a9bcae2706e6e5e5b9d322a0d3be0e1a3558 
SHA256: 18d51bd52b4fa76870407f7ee4a0b0bd0b86c0fbdd7f00322edc50d3d4ff15d2 CREATED: Mon Feb  7 14:36:47 2022 MODIFIED: Mon Feb  7 14:36:47 2022 ACCESSED: Mon Feb  7 14:37:26 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_17: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 8bc1488b8c24300200004833cc
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:37:28Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
60		win_mutex
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
10		anti_dbg
60		skip20_sqllang_hook
20		isExecutable
10		Contains_PE_File

Score total: 409

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fm5OU731DA8nhCUxq6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.78 MB
Data read: 0.73 MB (ratio 1.06:1)
Time: 46.297 sec (0 m 46 s)
Start Date: 2022:02:07 14:36:47
End Date:   2022:02:07 14:37:34

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e24b2506af9f97069b171dc87240b2f7                                                   |
| sha1                   | 5718a9bcae2706e6e5e5b9d322a0d3be0e1a3558                                           |
| sha256                 | 18d51bd52b4fa76870407f7ee4a0b0bd0b86c0fbdd7f00322edc50d3d4ff15d2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fm5OU731DA8nhCUxq6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
|                             | Interprocess Communication::Read Pipe [C0003.003]                             |
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions (2 matches)      | anti-analysis/anti-debugging/debugger-detection      |
| get geographical location (4 matches)                | collection                                           |
| check HTTP status code (2 matches)                   | communication/http/client                            |
| create pipe                                          | communication/named-pipe/create                      |
| read pipe                                            | communication/named-pipe/read                        |
| encode data using XOR (36 matches)                   | data-manipulation/encoding/xor                       |
| hash data using murmur3 (2 matches)                  | data-manipulation/hashing/murmur                     |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (10 matches) | executable/resource                                  |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get file system object information                   | host-interaction/file-system                         |
| check if file exists (11 matches)                    | host-interaction/file-system/exists                  |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| get disk size                                        | host-interaction/hardware/storage                    |
| get storage device properties (2 matches)            | host-interaction/hardware/storage                    |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| create mutex (2 matches)                             | host-interaction/mutex                               |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| create process on Windows (3 matches)                | host-interaction/process/create                      |
| terminate process via fastfail (14 matches)          | host-interaction/process/terminate                   |
| link many functions at runtime (2 matches)           | linking/runtime-linking                              |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
4		- Discovery::Application Window Discovery [T1010;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]

Score total: 36.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('win_mutex', '60'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('anti_dbg', '10'), ('skip20_sqllang_hook', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['409']
-------------- CAPA_Score ------------
['36.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
7200.507590554749
============================================


==================================================================
Fichier HTTP-Fm5OU731DA8nhCUxq6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6GznT1QqboMppaYrc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 05db5eaffee4d667b4fde07041bbbef6                                                   |
| sha1                   | bc35edb25aceb0826c4e4f638f9fe19c1192cc84                                           |
| sha256                 | 71a4f9b800d81ff6632b9892a6a502c412c141341e46d697a8c004e2f460913b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6GznT1QqboMppaYrc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount (9 matches)    | anti-analysis/anti-debugging/debugger-detection      |
| obfuscated with callobfuscator                       | anti-analysis/obfuscation                            |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| write file on Windows                                | host-interaction/file-system/write                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2		- Execution::Shared Modules [T1129;2]

Score total: 14.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6GznT1QqboMppaYrc.exe: Win.Countermeasure.LoaderWinGeneric-9804845-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.29 MB
Data read: 0.28 MB (ratio 1.06:1)
Time: 39.012 sec (0 m 39 s)
Start Date: 2022:02:07 14:38:57
End Date:   2022:02:07 14:39:36

-------- Score ----------------
Scores		Rules
.......		...............
60		Win.Countermeasure.LoaderWinGeneric-9804845-2

Score total: 60.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:38:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F6GznT1QqboMppaYrc.exe SCORE: 149 TYPE: EXE SIZE: 292864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f0ba6b2bfa0> 
MD5: 05db5eaffee4d667b4fde07041bbbef6 
SHA1: bc35edb25aceb0826c4e4f638f9fe19c1192cc84 
SHA256: 71a4f9b800d81ff6632b9892a6a502c412c141341e46d697a8c004e2f460913b CREATED: Mon Feb  7 14:38:57 2022 MODIFIED: Mon Feb  7 14:38:57 2022 ACCESSED: Mon Feb  7 14:39:50 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:39:50Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_7
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		IsPacked
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 149

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Countermeasure.LoaderWinGeneric-9804845-2', '60')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_7', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['149']
-------------- CAPA_Score ------------
['14.5']
-------------- CLAMAV_Score ------------
['60.0']
-------------- SCORE FINAL ------------
3406.1591395140467
============================================


==================================================================
Fichier HTTP-F6GznT1QqboMppaYrc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FVHVjV82Us5ZSYGr3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4c220a9fd4d1aee3e5861fea1ab3573e                                                   |
| sha1                   | ba6a6627917900a5740110e589c8ea602c2ba341                                           |
| sha256                 | b95769a76e3148e35b76eae351f22c1ac609c6a4fbf5e0794deeeac13b55bd1d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FVHVjV82Us5ZSYGr3.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate PE sections                                | load-code/pe                                         |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FVHVjV82Us5ZSYGr3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.16 MB
Data read: 0.15 MB (ratio 1.05:1)
Time: 44.694 sec (0 m 44 s)
Start Date: 2022:02:07 14:39:51
End Date:   2022:02:07 14:40:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:39:51Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FVHVjV82Us5ZSYGr3.exe SCORE: 239 TYPE: EXE SIZE: 158208 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8ae61f0fa0> 
MD5: 4c220a9fd4d1aee3e5861fea1ab3573e 
SHA1: ba6a6627917900a5740110e589c8ea602c2ba341 
SHA256: b95769a76e3148e35b76eae351f22c1ac609c6a4fbf5e0794deeeac13b55bd1d CREATED: Mon Feb  7 14:39:51 2022 MODIFIED: Mon Feb  7 14:39:51 2022 ACCESSED: Mon Feb  7 14:40:43 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:40:43Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 239

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['239']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3847.7525994311272
============================================


==================================================================
Fichier HTTP-FVHVjV82Us5ZSYGr3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FJs7YH10FK1ZdgG3P3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FJs7YH10FK1ZdgG3P3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.12 MB
Data read: 0.12 MB (ratio 1.00:1)
Time: 35.901 sec (0 m 35 s)
Start Date: 2022:02:07 14:40:44
End Date:   2022:02:07 14:41:20

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a117edc0e74ab4770acf7f7e86e573f7                                                   |
| sha1                   | 5ceffb1a5e05e52aafcbc2d44e1e8445440706f3                                           |
| sha256                 | b5bc4fce58403ea554691db678e6c8c448310fe59990990f0e37cd4357567d37                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FJs7YH10FK1ZdgG3P3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                             |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Location Discovery:: \[T1614]\                                               |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| spoof parent PID                                     | anti-analysis/anti-forensic                          |
| get geographical location                            | collection                                           |
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| query environment variable (5 matches)               | host-interaction/environment-variable                |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| find graphical window (2 matches)                    | host-interaction/gui/window/find                     |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| check mutex (7 matches)                              | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| read process memory                                  | host-interaction/process                             |
| create process on Windows (4 matches)                | host-interaction/process/create                      |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process via fastfail (5 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (12 matches)       | host-interaction/registry                            |
| delete registry key (3 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| get session user name                                | host-interaction/session                             |
| get token membership                                 | host-interaction/session                             |
| link function at runtime on Windows (3 matches)      | linking/runtime-linking                              |
| parse PE header (8 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
3		- Discovery::Account Discovery [T1087;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
4		- Discovery::Application Window Discovery [T1010;4]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 43.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:40:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FJs7YH10FK1ZdgG3P3.exe SCORE: 499 TYPE: EXE SIZE: 126464 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f870e2bcfa0> 
MD5: a117edc0e74ab4770acf7f7e86e573f7 
SHA1: 5ceffb1a5e05e52aafcbc2d44e1e8445440706f3 
SHA256: b5bc4fce58403ea554691db678e6c8c448310fe59990990f0e37cd4357567d37 CREATED: Mon Feb  7 14:40:44 2022 MODIFIED: Mon Feb  7 14:40:44 2022 ACCESSED: Mon Feb  7 14:41:36 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e84b0400004883c428e97efdffffcccccccccccccccccccccccccccc
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:41:37Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
60		win_mutex
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 499

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('keylogger', '80'), ('win_mutex', '60'), ('win_registry', '20'), ('win_token', '65'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['499']
-------------- CAPA_Score ------------
['43.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8766.579825817573
============================================


==================================================================
Fichier HTTP-FJs7YH10FK1ZdgG3P3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXcayD1nIZlRgS7mD6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXcayD1nIZlRgS7mD6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.48 MB
Data read: 0.46 MB (ratio 1.05:1)
Time: 43.058 sec (0 m 43 s)
Start Date: 2022:02:07 14:41:37
End Date:   2022:02:07 14:42:20

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:41:37Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXcayD1nIZlRgS7mD6.exe SCORE: 419 TYPE: EXE SIZE: 486736 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fbd59daefa0> 
MD5: 4b944d93d5c75ef05f64ccb9d877d9f5 
SHA1: f343691790795f06b22a1f6995c53124fb70f8f2 
SHA256: 5cbb22f583517b32f8bdca9e5d8083761c8a414588b8506adf5c5761a528dfbe CREATED: Mon Feb  7 14:41:37 2022 MODIFIED: Mon Feb  7 14:41:37 2022 ACCESSED: Mon Feb  7 14:42:30 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System Str2: identifier
REASON_17: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System Str2: identifier
REASON_18: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_19: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:42:31Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
60		win_mutex
10		Str_Win32_Http_API
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 419

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4b944d93d5c75ef05f64ccb9d877d9f5                                                   |
| sha1                   | f343691790795f06b22a1f6995c53124fb70f8f2                                           |
| sha256                 | 5cbb22f583517b32f8bdca9e5d8083761c8a414588b8506adf5c5761a528dfbe                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXcayD1nIZlRgS7mD6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Download URL [C0002.006]                                  |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data                                         | communication                                        |
| initialize WinHTTP library                           | communication/http                                   |
| read HTTP header (2 matches)                         | communication/http                                   |
| set HTTP header (2 matches)                          | communication/http                                   |
| check HTTP status code                               | communication/http/client                            |
| prepare HTTP request                                 | communication/http/client                            |
| receive HTTP response (3 matches)                    | communication/http/client                            |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (14 matches)                   | data-manipulation/encoding/xor                       |
| hash data using fnv (14 matches)                     | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| linked against CPP regex library                     | linking/static/cppregex                              |
| enumerate PE sections (2 matches)                    | load-code/pe                                         |
| parse PE header (11 matches)                         | load-code/pe                                         |
| persist via Run registry key (2 matches)             | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]

Score total: 24.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('win_mutex', '60'), ('Str_Win32_Http_API', '10'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['419']
-------------- CAPA_Score ------------
['24.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
7119.565432004595
============================================


==================================================================
Fichier HTTP-FXcayD1nIZlRgS7mD6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDTStSdtdslBphiGl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ffeae4a391a1d5203bd04b4161557227                                                   |
| sha1                   | 7c7013dd8def75c94828b40ffa139b6d89ec4683                                           |
| sha256                 | 81fc45c95bdb421257645b4ff91a6afc82201d3ffe570c059994d79ff1484f90                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FDTStSdtdslBphiGl.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
|                        | Input Capture::Keylogging \[T1056.001]\                                             |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Resource Hijacking:: \[T1496]\                                                      |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Data [C0002.005]                                     |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Encryption Key::Import Public Key [C0028.001]                                 |
|                             | Generate Pseudo-random Sequence::Mersenne Twister [C0021.005]                 |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+--------------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                                   | NAMESPACE                                            |
|--------------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                                   | anti-analysis                                        |
| log keystrokes via polling (3 matches)                       | collection/keylog                                    |
| receive data                                                 | communication                                        |
| send data (2 matches)                                        | communication                                        |
| connect to HTTP server                                       | communication/http/client                            |
| create HTTP request                                          | communication/http/client                            |
| encode data using XOR (15 matches)                           | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext (3 matches)           | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt (4 matches)                  | data-manipulation/encryption                         |
| import public key                                            | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI (2 matches)                | data-manipulation/encryption/aes                     |
| reference public RSA key                                     | data-manipulation/encryption/rsa                     |
| hash data via WinCrypt                                       | data-manipulation/hashing                            |
| hash data using SHA1                                         | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                            | data-manipulation/hashing/sha1                       |
| generate random numbers using a Mersenne Twister (3 matches) | data-manipulation/prng/mersenne                      |
| contain a resource (.rsrc) section                           | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (3 matches)          | executable/resource                                  |
| accept command line arguments (2 matches)                    | host-interaction/cli                                 |
| replace clipboard data                                       | host-interaction/clipboard                           |
| query environment variable (2 matches)                       | host-interaction/environment-variable                |
| get common file path (3 matches)                             | host-interaction/file-system                         |
| get file system object information                           | host-interaction/file-system                         |
| copy file                                                    | host-interaction/file-system/copy                    |
| delete file (5 matches)                                      | host-interaction/file-system/delete                  |
| check if file exists                                         | host-interaction/file-system/exists                  |
| enumerate files recursively                                  | host-interaction/file-system/files/list              |
| get file attributes                                          | host-interaction/file-system/meta                    |
| get file size (2 matches)                                    | host-interaction/file-system/meta                    |
| set file attributes (9 matches)                              | host-interaction/file-system/meta                    |
| move file                                                    | host-interaction/file-system/move                    |
| read file on Windows (2 matches)                             | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                            | host-interaction/file-system/write                   |
| get graphical window text (2 matches)                        | host-interaction/gui/window/get-text                 |
| hide graphical window (6 matches)                            | host-interaction/gui/window/hide                     |
| get disk information (2 matches)                             | host-interaction/hardware/storage                    |
| get disk size (2 matches)                                    | host-interaction/hardware/storage                    |
| check mutex and exit                                         | host-interaction/mutex                               |
| get hostname                                                 | host-interaction/os/hostname                         |
| get system information on Windows                            | host-interaction/os/info                             |
| check OS version                                             | host-interaction/os/version                          |
| create process on Windows (5 matches)                        | host-interaction/process/create                      |
| terminate process                                            | host-interaction/process/terminate                   |
| query or enumerate registry key                              | host-interaction/registry                            |
| query or enumerate registry value (8 matches)                | host-interaction/registry                            |
| delete registry key                                          | host-interaction/registry/delete                     |
| delete registry value (2 matches)                            | host-interaction/registry/delete                     |
| create thread                                                | host-interaction/thread/create                       |
| resume thread                                                | host-interaction/thread/resume                       |
| mine cryptocurrency                                          | impact/cryptocurrency                                |
| link function at runtime on Windows (7 matches)              | linking/runtime-linking                              |
| parse PE exports                                             | load-code/pe                                         |
| parse PE header (7 matches)                                  | load-code/pe                                         |
| persist via Run registry key (3 matches)                     | persistence/registry/run                             |
+--------------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Collection::Clipboard Data [T1115;6]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
8		- Impact::Resource Hijacking [T1496;8]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 75.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDTStSdtdslBphiGl.exe: Win.Trojan.Cryptolocker-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.34 MB
Data read: 0.33 MB (ratio 1.04:1)
Time: 41.219 sec (0 m 41 s)
Start Date: 2022:02:07 14:43:18
End Date:   2022:02:07 14:43:59

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Cryptolocker-2

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:43:19Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FDTStSdtdslBphiGl.exe SCORE: 729 TYPE: EXE SIZE: 348160 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f367d2cffa0> 
MD5: ffeae4a391a1d5203bd04b4161557227 
SHA1: 7c7013dd8def75c94828b40ffa139b6d89ec4683 
SHA256: 81fc45c95bdb421257645b4ff91a6afc82201d3ffe570c059994d79ff1484f90 CREATED: Mon Feb  7 14:43:18 2022 MODIFIED: Mon Feb  7 14:43:18 2022 ACCESSED: Mon Feb  7 14:44:11 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: InternetWriteFile Str6: HttpOpenRequest Str7: HttpS ... (truncated)
REASON_2: Yara Rule MATCH: network_dga SUBSCORE: 45 
DESCRIPTION: Communication using dga REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: WININET.dll Str3: CRYPT32.dll Str4: SystemTimeToFileTime Str5: GetSystemTime Str6: CryptCreateHash Str7: CryptAcqu ... (truncated)
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_4: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_5: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_6: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_7: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_8: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_9: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_10: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_11: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: win_cryptolocker_auto SUBSCORE: 45 
DESCRIPTION: Detects win.cryptolocker. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8b47048d140833c93bc273168d9b00000000 Str2: 8bf1578b46088d3c85040000008b460485ff751e Str3: 8bec8b45085356578bf98b5704 Str4: eb096a006a ... (truncated)
REASON_13: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_19: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_21: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_22: Yara Rule MATCH: Win32_Ransomware_CryptoLocker SUBSCORE: 60 
DESCRIPTION: Yara rule that detects CryptoLocker ransomware. REF: - AUTHOR: ReversingLabs 
MATCHES: Str1: 558bec83ec4053568bc1578945f4e82dfdffff84c00f84620100008b5d0832c00f57c08845fb660f1345c4eb038d490084c074086a00ff15a82141006a006a00ff75c ... (truncated)
REASON_23: Yara Rule MATCH: ransomware_windows_cryptolocker SUBSCORE: 85 
DESCRIPTION: The CryptoLocker malware propagated via infected email attachments, and via an existing botnet; when activated, the malware encrypts files stored on local and mounted network drives REF: https://www.secureworks.com/research/cryptolocker-ransomware AUTHOR: @fusionrace 
MATCHES: Str1: bb to select the method of payment and the currency. Str2: Where can I purchase a MoneyPak? Str3: Ukash is electronic cash and e-comm ... (truncated)
REASON_24: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_25: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_26: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:44:12Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
45		network_dga
65		screenshot
80		keylogger
60		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
45		win_cryptolocker_auto
2		math_entropy_close_8
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Init
60		Win32_Ransomware_CryptoLocker
85		ransomware_windows_cryptolocker
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 729

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Collection::Clipboard Data [T1115;6]', '6'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::Resource Hijacking [T1496;8]', '8'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;5]', '5'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Cryptolocker-2', '45')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('network_dga', '45'), ('screenshot', '65'), ('keylogger', '80'), ('win_mutex', '60'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('win_cryptolocker_auto', '45'), ('math_entropy_close_8', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Init', '40'), ('Win32_Ransomware_CryptoLocker', '60'), ('ransomware_windows_cryptolocker', '85'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['729']
-------------- CAPA_Score ------------
['75.5']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
13626.810856150398
============================================


==================================================================
Fichier HTTP-FDTStSdtdslBphiGl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fj8r4Z24Xl3rXkIdo4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ba947eb07d8c823949316a97364d060f                                                   |
| sha1                   | fc28eb7c35d2652df0ea88366489bdc5d1b1c3f6                                           |
| sha256                 | 547c396ad518ed087962182c01608c53d08ad61fcfaf63390cddea1d175b1a33                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fj8r4Z24Xl3rXkIdo4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Execution Guardrails::Runs as Service [E1480.m07]                             |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DEFENSE EVASION             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| initialize WinHTTP library                           | communication/http                                   |
| set HTTP header                                      | communication/http                                   |
| prepare HTTP request                                 | communication/http/client                            |
| receive HTTP response                                | communication/http/client                            |
| create new key via CryptAcquireContext (3 matches)   | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI                    | data-manipulation/encryption/aes                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                    | data-manipulation/hashing/sha1                       |
| generate random numbers via WinAPI (2 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes               | host-interaction/driver                              |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| create directory (2 matches)                         | host-interaction/file-system/create                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| read file on Windows (2 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| query service status                                 | host-interaction/service                             |
| run as service                                       | host-interaction/service                             |
| start service (2 matches)                            | host-interaction/service/start                       |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Discovery::Query Registry [T1012;1]

Score total: 25.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fj8r4Z24Xl3rXkIdo4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 44.200 sec (0 m 44 s)
Start Date: 2022:02:07 14:44:12
End Date:   2022:02:07 14:44:57

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:44:13Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fj8r4Z24Xl3rXkIdo4.exe SCORE: 224 TYPE: EXE SIZE: 38120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f374513efa0> 
MD5: ba947eb07d8c823949316a97364d060f 
SHA1: fc28eb7c35d2652df0ea88366489bdc5d1b1c3f6 
SHA256: 547c396ad518ed087962182c01608c53d08ad61fcfaf63390cddea1d175b1a33 CREATED: Mon Feb  7 14:44:12 2022 MODIFIED: Mon Feb  7 14:44:12 2022 ACCESSED: Mon Feb  7 14:45:03 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: FindClose
REASON_3: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
REASON_18: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:45:03Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		Str_Win32_Http_API
10		misc_pe_signature
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API
20		MD5_Constants

Score total: 224

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Http_API', '10'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Advapi_Hash_API', '20'), ('MD5_Constants', '20')]
-------------- LOKI_Score ------------
['224']
-------------- CAPA_Score ------------
['25.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4048.9763298551134
============================================


==================================================================
Fichier HTTP-Fj8r4Z24Xl3rXkIdo4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6xfTI2uz4DJrixurg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 64f5611cc62e65748d140e6f288ce1ea                                                   |
| sha1                   | d337d3576ae4b7495f1d58926868af8bf296cf87                                           |
| sha256                 | ec1dc1a2ee200da0c787328df4fb91a2b978fd09ca1f83f3e55994c0f9ba1d11                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6xfTI2uz4DJrixurg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| check mutex and exit                                 | host-interaction/mutex                               |
| access PE header                                     | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6xfTI2uz4DJrixurg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 44.590 sec (0 m 44 s)
Start Date: 2022:02:07 14:45:04
End Date:   2022:02:07 14:45:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:45:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F6xfTI2uz4DJrixurg.exe SCORE: 284 TYPE: EXE SIZE: 14848 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb2d54d2fa0> 
MD5: 64f5611cc62e65748d140e6f288ce1ea 
SHA1: d337d3576ae4b7495f1d58926868af8bf296cf87 
SHA256: ec1dc1a2ee200da0c787328df4fb91a2b978fd09ca1f83f3e55994c0f9ba1d11 CREATED: Mon Feb  7 14:45:04 2022 MODIFIED: Mon Feb  7 14:45:04 2022 ACCESSED: Mon Feb  7 14:45:55 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:45:55Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
65		win_token
10		ft_exe
2		math_entropy_4
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 284

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('win_token', '65'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['284']
-------------- CAPA_Score ------------
['7.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4640.765028637384
============================================


==================================================================
Fichier HTTP-F6xfTI2uz4DJrixurg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDe5pR3MWi55M3NeR9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9db13dadd1f105cdb739a3243a1463cf                                                   |
| sha1                   | a24eb7199732b56cedf040a594d3dff8eabfd285                                           |
| sha256                 | cfdd7cc431d1ed6ca72b43292daad839066425661b5a7fe30a680ae6735cfd3a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FDe5pR3MWi55M3NeR9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| get hostname                                         | host-interaction/os/hostname                         |
| create process on Windows (2 matches)                | host-interaction/process/create                      |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDe5pR3MWi55M3NeR9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 41.150 sec (0 m 41 s)
Start Date: 2022:02:07 14:45:56
End Date:   2022:02:07 14:46:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:45:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FDe5pR3MWi55M3NeR9.exe SCORE: 159 TYPE: EXE SIZE: 20480 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f902c179fa0> 
MD5: 9db13dadd1f105cdb739a3243a1463cf 
SHA1: a24eb7199732b56cedf040a594d3dff8eabfd285 
SHA256: cfdd7cc431d1ed6ca72b43292daad839066425661b5a7fe30a680ae6735cfd3a CREATED: Mon Feb  7 14:45:56 2022 MODIFIED: Mon Feb  7 14:45:56 2022 ACCESSED: Mon Feb  7 14:46:40 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:46:40Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['159']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2719.506407510058
============================================


==================================================================
Fichier HTTP-FDe5pR3MWi55M3NeR9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FhOcRp26K2ggvcrew4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 690a9f472f6aafba0e90bedab91366c2                                                   |
| sha1                   | 8f4e4a8634d704fd98d6df491149cdb472ba30ab                                           |
| sha256                 | 44b1c84811495b426ec69a15888d5824a894421df052cc378fd6ada5c32a112f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FhOcRp26K2ggvcrew4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FhOcRp26K2ggvcrew4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.692 sec (0 m 42 s)
Start Date: 2022:02:07 14:46:40
End Date:   2022:02:07 14:47:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:46:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FhOcRp26K2ggvcrew4.exe SCORE: 229 TYPE: EXE SIZE: 23552 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe3bcb3dfa0> 
MD5: 690a9f472f6aafba0e90bedab91366c2 
SHA1: 8f4e4a8634d704fd98d6df491149cdb472ba30ab 
SHA256: 44b1c84811495b426ec69a15888d5824a894421df052cc378fd6ada5c32a112f CREATED: Mon Feb  7 14:46:40 2022 MODIFIED: Mon Feb  7 14:46:40 2022 ACCESSED: Mon Feb  7 14:47:33 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:47:33Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3828.9316422328375
============================================


==================================================================
Fichier HTTP-FhOcRp26K2ggvcrew4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6WiaSI9gWhvb5Gh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6db032025bd266e5a3a52259f57f9247                                                   |
| sha1                   | 700463b333e6f007018d80048921187987840b5b                                           |
| sha256                 | 71d8a301c01f61d1bb69784d823a8040fa43cf3f063325b68e97b47cc3e3814c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6WiaSI9gWhvb5Gh.exe                          |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6WiaSI9gWhvb5Gh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.810 sec (0 m 43 s)
Start Date: 2022:02:07 14:47:34
End Date:   2022:02:07 14:48:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:47:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F6WiaSI9gWhvb5Gh.exe SCORE: 264 TYPE: EXE SIZE: 40960 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc610186fa0> 
MD5: 6db032025bd266e5a3a52259f57f9247 
SHA1: 700463b333e6f007018d80048921187987840b5b 
SHA256: 71d8a301c01f61d1bb69784d823a8040fa43cf3f063325b68e97b47cc3e3814c CREATED: Mon Feb  7 14:47:34 2022 MODIFIED: Mon Feb  7 14:47:34 2022 ACCESSED: Mon Feb  7 14:48:23 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:48:23Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 264

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['264']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4224.023274396717
============================================


==================================================================
Fichier HTTP-F6WiaSI9gWhvb5Gh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F8CuuuZ5m9SQqSOI5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:48:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F8CuuuZ5m9SQqSOI5.exe SCORE: 429 TYPE: EXE SIZE: 55808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f145e53bfa0> 
MD5: 1195d0d18be9362fb8dd9e1738404c9d 
SHA1: ef02cc3dbdff915c9149aef86911b4e780b89ae6 
SHA256: dd79b2abc21e766fe3076038482ded43e5069a1af9e0ad29e06dce387bfae900 CREATED: Mon Feb  7 14:48:24 2022 MODIFIED: Mon Feb  7 14:48:24 2022 ACCESSED: Mon Feb  7 14:49:00 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: AdjustTokenPrivileges Str4: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Ran_Mem_RagnarLocker_Nov_2020_1 SUBSCORE: 75 
DESCRIPTION: Detect memory artefacts of the Ragnarlocker ransomware (Nov 2020) REF: Internal Research AUTHOR: Arkbird_SOLG 
MATCHES: Str1: \.\PHYSICALDRIVE%d Str2: bootfont.bin Str3: bootsect.bak Str4: bootmgr.efi Str5: Internet Explorer Str6:   </trustInfo> Str7: Tor br ... (truncated)
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_18: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_19: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:49:00Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
75		Ran_Mem_RagnarLocker_Nov_2020_1
20		isExecutable
10		Contains_PE_File
25		Crypt32_CryptBinaryToString_API
20		SHA512_Constants
20		SHA2_BLAKE2_IVs

Score total: 429

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F8CuuuZ5m9SQqSOI5.exe: Win.Exploit.CVE_2017_0213-6306933-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 42.382 sec (0 m 42 s)
Start Date: 2022:02:07 14:48:24
End Date:   2022:02:07 14:49:06

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2017_0213-6306933-0

Score total: 25.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Exploit.CVE_2017_0213-6306933-0', '25')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('Ran_Mem_RagnarLocker_Nov_2020_1', '75'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Crypt32_CryptBinaryToString_API', '25'), ('SHA512_Constants', '20'), ('SHA2_BLAKE2_IVs', '20')]
-------------- LOKI_Score ------------
['429']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['25.0']
-------------- SCORE FINAL ------------
7113.923148606717
============================================


==================================================================
Fichier HTTP-F8CuuuZ5m9SQqSOI5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FALLv42l6CHYjFcwj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FALLv42l6CHYjFcwj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.21 MB
Data read: 0.20 MB (ratio 1.04:1)
Time: 37.600 sec (0 m 37 s)
Start Date: 2022:02:07 14:49:07
End Date:   2022:02:07 14:49:44

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 37f9f0d495cebf0359d06cf96e85a51f                                                   |
| sha1                   | b4e674db12ab0c2d39260dab1a7779d9947a4908                                           |
| sha256                 | 8958aec70d263062a01f77a71e2787275470340d0d39cce267b800ef09dd1538                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FALLv42l6CHYjFcwj.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| create directory                                     | host-interaction/file-system/create                  |
| delete directory                                     | host-interaction/file-system/delete                  |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| read .ini file                                       | host-interaction/file-system/read                    |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| check mutex and exit                                 | host-interaction/mutex                               |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| set registry value (6 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| delete registry value (2 matches)                    | host-interaction/registry/delete                     |
| query service status                                 | host-interaction/service                             |
| modify service                                       | host-interaction/service/modify                      |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| link function at runtime on Windows (4 matches)      | linking/runtime-linking                              |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
9		- Impact::Service Stop [T1489;9]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 37.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:49:07Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FALLv42l6CHYjFcwj.exe SCORE: 224 TYPE: EXE SIZE: 210944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f04a9f64fa0> 
MD5: 37f9f0d495cebf0359d06cf96e85a51f 
SHA1: b4e674db12ab0c2d39260dab1a7779d9947a4908 
SHA256: 8958aec70d263062a01f77a71e2787275470340d0d39cce267b800ef09dd1538 CREATED: Mon Feb  7 14:49:07 2022 MODIFIED: Mon Feb  7 14:49:07 2022 ACCESSED: Mon Feb  7 14:49:50 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent Str4: OutputDebugString
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:49:50Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
20		win_registry
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 224

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('win_registry', '20'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['224']
-------------- CAPA_Score ------------
['37.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4298.384119226223
============================================


==================================================================
Fichier HTTP-FALLv42l6CHYjFcwj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FLkrTQPOSV0PkCg08.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e88b0d6398970e74de1de457b971003f                                                   |
| sha1                   | 861185d8d7100db4acc6f1f18e67cb360e7d109c                                           |
| sha256                 | 0c3031f630adc6cdd7b877fa1c2982909cde01dff612db5dd7df58cc778dd919                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FLkrTQPOSV0PkCg08.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::OutputDebugString [B0001.016]                             |
|                             | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for OutputDebugString error                    | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| find graphical window                                | host-interaction/gui/window/find                     |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| create thread                                        | host-interaction/thread/create                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Application Window Discovery [T1010;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 11.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FLkrTQPOSV0PkCg08.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.053 sec (0 m 43 s)
Start Date: 2022:02:07 14:49:51
End Date:   2022:02:07 14:50:34

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_FindWindowA_iat_v1', '30'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('Check_OutputDebugStringA_iat', '30'), ('Check_FindWindowA_iat', '20'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['709']
-------------- CAPA_Score ------------
['11.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
11466.347900770716
============================================


==================================================================
Fichier HTTP-FLkrTQPOSV0PkCg08.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FcAJQUPvxJBYp1Qi2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f3edff85de5fd002692d54a04bcb1c09                                                   |
| sha1                   | 4c844c5b0ee7cb230c9c28290d079143e00cb216                                           |
| sha256                 | caf29650446db3842e1c1e8e5e1bafadaf90fc82c5c37b9e2c75a089b7476131                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FcAJQUPvxJBYp1Qi2.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Delete Directory:: [C0048]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (4 matches)   | host-interaction/driver                              |
| delete directory                                     | host-interaction/file-system/delete                  |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]

Score total: 15.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FcAJQUPvxJBYp1Qi2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 44.326 sec (0 m 44 s)
Start Date: 2022:02:07 14:50:44
End Date:   2022:02:07 14:51:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:50:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FcAJQUPvxJBYp1Qi2.exe SCORE: 229 TYPE: EXE SIZE: 18944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3010180fa0> 
MD5: f3edff85de5fd002692d54a04bcb1c09 
SHA1: 4c844c5b0ee7cb230c9c28290d079143e00cb216 
SHA256: caf29650446db3842e1c1e8e5e1bafadaf90fc82c5c37b9e2c75a089b7476131 CREATED: Mon Feb  7 14:50:44 2022 MODIFIED: Mon Feb  7 14:50:44 2022 ACCESSED: Mon Feb  7 14:51:36 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:51:36Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['15.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3928.6947579812813
============================================


==================================================================
Fichier HTTP-FcAJQUPvxJBYp1Qi2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fp794z4oY2UMn1SQS3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fp794z4oY2UMn1SQS3.exe: Win.Malware.EccentricBandwagon-9748740-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.17 MB
Data read: 0.16 MB (ratio 1.05:1)
Time: 43.814 sec (0 m 43 s)
Start Date: 2022:02:07 14:51:37
End Date:   2022:02:07 14:52:20

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.EccentricBandwagon-9748740-0

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa2 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa2 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:51:37Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fp794z4oY2UMn1SQS3.exe SCORE: 569 TYPE: EXE SIZE: 175104 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4e56e83fa0> 
MD5: 34404a3fb9804977c6ab86cb991fb130 
SHA1: b345e6fae155bfaf79c67b38cf488bb17d5be56d 
SHA256: c6930e298bba86c01d0fe2c8262c46b4fce97c6c5037a193904cfc634246fbec CREATED: Mon Feb  7 14:51:37 2022 MODIFIED: Mon Feb  7 14:51:37 2022 ACCESSED: Mon Feb  7 14:52:24 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetAsyncKeyState Str3: GetKeyState Str4: MapVirtualKey
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: FindFirstFileA Str7: FindClose
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_pslogger_auto SUBSCORE: 45 
DESCRIPTION: Detects win.pslogger. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8d7608660fd60f8d7f088b048d04ed4100ffe0 Str2: 899de4feffffe8788500008d95e8feffffe81d210000538d55e88d8de8feffff Str3: 81e6fdff000083ce0 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8f3020000e980feffff Str2: e8340d0000e977ffffff Str3: e8050b0000e977ffffff Str4: e8c8080000e976ffffff Str5: e823b7ffffe96cffffff
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3:    Str4:   Str5:    Str6: PDT Str7: PDT Str8: PDT Str9: PDT Str10: PDT Str11: PDT Str12: PDT Str13: PDT Str14: PDT St ... (truncated)
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_21: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:52:25Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
10		win_files_operation
10		ft_exe
45		win_pslogger_auto
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table

Score total: 569

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 34404a3fb9804977c6ab86cb991fb130                                                   |
| sha1                   | b345e6fae155bfaf79c67b38cf488bb17d5be56d                                           |
| sha256                 | c6930e298bba86c01d0fe2c8262c46b4fce97c6c5037a193904cfc634246fbec                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fp794z4oY2UMn1SQS3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                         |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
|                        | Screen Capture:: \[T1113]\                                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
|                             | Generate Pseudo-random Sequence:: [C0021]                                     |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Compression Library:: [C0060]                                                 |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| log keystrokes                                           | collection/keylog                                    |
| log keystrokes via polling                               | collection/keylog                                    |
| capture screenshot                                       | collection/screenshot                                |
| encode data using XOR (5 matches)                        | data-manipulation/encoding/xor                       |
| encrypt data using RC4 KSA                               | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 PRGA (2 matches)                  | data-manipulation/encryption/rc4                     |
| generate random numbers using the Delphi LCG (3 matches) | data-manipulation/prng/lcg                           |
| contain a resource (.rsrc) section                       | executable/pe/section/rsrc                           |
| read clipboard data                                      | host-interaction/clipboard                           |
| set environment variable                                 | host-interaction/environment-variable                |
| get common file path                                     | host-interaction/file-system                         |
| create directory                                         | host-interaction/file-system/create                  |
| delete directory (2 matches)                             | host-interaction/file-system/delete                  |
| delete file (2 matches)                                  | host-interaction/file-system/delete                  |
| check if file exists                                     | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions                   | host-interaction/file-system/files/list              |
| read file on Windows                                     | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                        | host-interaction/file-system/write                   |
| get graphical window text                                | host-interaction/gui/window/get-text                 |
| get session user name                                    | host-interaction/session                             |
| create thread                                            | host-interaction/thread/create                       |
| terminate thread                                         | host-interaction/thread/terminate                    |
| linked against XZip                                      | linking/static/xzip                                  |
| enumerate PE sections (2 matches)                        | load-code/pe                                         |
| parse PE header (2 matches)                              | load-code/pe                                         |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Collection::Clipboard Data [T1115;6]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::Account Discovery [T1087;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
6		- Collection::Screen Capture [T1113;6]
4		- Discovery::Application Window Discovery [T1010;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 44.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Collection::Clipboard Data [T1115;6]', '6'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Collection::Screen Capture [T1113;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3')]
---------------- ClamAV_Rules --------------
[('Win.Malware.EccentricBandwagon-9748740-0', '50')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('win_files_operation', '10'), ('ft_exe', '10'), ('win_pslogger_auto', '45'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25')]
-------------- LOKI_Score ------------
['569']
-------------- CAPA_Score ------------
['44.0']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
10525.420389587125
============================================


==================================================================
Fichier HTTP-Fp794z4oY2UMn1SQS3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FEEtiW3lcXAJLecd12.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:52:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FEEtiW3lcXAJLecd12.exe SCORE: 194 TYPE: EXE SIZE: 195072 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1ad7e72fa0> 
MD5: 5a968a83780406c060335be361e0ea99 
SHA1: c7ec1d45372f648657ed041b6c1c410e41117489 
SHA256: f41032bfb7ef0b2a228c46b30b40b28e9cbd7dc19879b1996e1d71f2a5782eec CREATED: Mon Feb  7 14:52:28 2022 MODIFIED: Mon Feb  7 14:52:28 2022 ACCESSED: Mon Feb  7 14:53:08 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:53:09Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 194

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FEEtiW3lcXAJLecd12.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.19 MB
Data read: 0.18 MB (ratio 1.04:1)
Time: 43.219 sec (0 m 43 s)
Start Date: 2022:02:07 14:52:28
End Date:   2022:02:07 14:53:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5a968a83780406c060335be361e0ea99                                                   |
| sha1                   | c7ec1d45372f648657ed041b6c1c410e41117489                                           |
| sha256                 | f41032bfb7ef0b2a228c46b30b40b28e9cbd7dc19879b1996e1d71f2a5782eec                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FEEtiW3lcXAJLecd12.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (2 matches)                | collection                                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 5.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['194']
-------------- CAPA_Score ------------
['5.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3184.432220697848
============================================


==================================================================
Fichier HTTP-FEEtiW3lcXAJLecd12.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FoXD1DmV5s4CmnYe4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FoXD1DmV5s4CmnYe4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 2.91 MB
Data read: 2.74 MB (ratio 1.06:1)
Time: 54.841 sec (0 m 54 s)
Start Date: 2022:02:07 14:53:12
End Date:   2022:02:07 14:54:06

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T13:53:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T13:54:10Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 648fc498110b11b4313a47a776e6ba40                                                   |
| sha1                   | 3a182e146f3549715e760b34722411eb2dad6578                                           |
| sha256                 | b483b6f21601752ff800ba52092e358050e4b370117503a9309787fd57935926                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FoXD1DmV5s4CmnYe4.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
|                        | Input Capture::Keylogging \[T1056.001]\                                             |
|                        | Screen Capture:: \[T1113]\                                                          |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Location Discovery:: \[T1614]\                                               |
|                        | System Network Configuration Discovery::Internet Connection Discovery \[T1016.001]\ |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence:: [C0021]                                     |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Suspend Thread:: [C0055]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                            | anti-analysis                                        |
| check for software breakpoints (2 matches)            | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount (3 matches)     | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (2 matches)              | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Xen               | anti-analysis/anti-vm/vm-detection                   |
| get geographical location (5 matches)                 | collection                                           |
| log keystrokes                                        | collection/keylog                                    |
| log keystrokes via polling (9 matches)                | collection/keylog                                    |
| capture screenshot                                    | collection/screenshot                                |
| send data                                             | communication                                        |
| initialize WinHTTP library                            | communication/http                                   |
| read HTTP header                                      | communication/http                                   |
| set HTTP header (3 matches)                           | communication/http                                   |
| receive HTTP response (2 matches)                     | communication/http/client                            |
| create pipe                                           | communication/named-pipe/create                      |
| compiled with Borland Delphi                          | compiler/delphi                                      |
| reference Base64 string                               | data-manipulation/encoding/base64                    |
| encode data using XOR (13 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (4 matches)               | data-manipulation/encryption/rc4                     |
| generate random numbers using the Delphi LCG          | data-manipulation/prng/lcg                           |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section         | executable/pe/section/tls                            |
| extract resource via kernel32 functions (4 matches)   | executable/resource                                  |
| accept command line arguments (2 matches)             | host-interaction/cli                                 |
| read clipboard data                                   | host-interaction/clipboard                           |
| replace clipboard data                                | host-interaction/clipboard                           |
| query environment variable                            | host-interaction/environment-variable                |
| create directory                                      | host-interaction/file-system/create                  |
| delete directory                                      | host-interaction/file-system/delete                  |
| delete file                                           | host-interaction/file-system/delete                  |
| check if file exists (2 matches)                      | host-interaction/file-system/exists                  |
| get file attributes (2 matches)                       | host-interaction/file-system/meta                    |
| get file size                                         | host-interaction/file-system/meta                    |
| get file version info (2 matches)                     | host-interaction/file-system/meta                    |
| read file on Windows (2 matches)                      | host-interaction/file-system/read                    |
| write file on Windows (4 matches)                     | host-interaction/file-system/write                   |
| enumerate gui resources (3 matches)                   | host-interaction/gui                                 |
| set application hook (4 matches)                      | host-interaction/gui                                 |
| set global application hook                           | host-interaction/gui                                 |
| find graphical window (2 matches)                     | host-interaction/gui/window/find                     |
| get graphical window text (2 matches)                 | host-interaction/gui/window/get-text                 |
| hide graphical window (15 matches)                    | host-interaction/gui/window/hide                     |
| get number of processors                              | host-interaction/hardware/cpu                        |
| get keyboard layout (5 matches)                       | host-interaction/hardware/keyboard/layout            |
| get disk size                                         | host-interaction/hardware/storage                    |
| check Internet connectivity via WinINet               | host-interaction/network/connectivity                |
| get hostname                                          | host-interaction/os/hostname                         |
| get system information on Windows                     | host-interaction/os/info                             |
| check OS version (3 matches)                          | host-interaction/os/version                          |
| get thread local storage value                        | host-interaction/process                             |
| set thread local storage value                        | host-interaction/process                             |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows                             | host-interaction/process/create                      |
| allocate RWX memory                                   | host-interaction/process/inject                      |
| query or enumerate registry key (3 matches)           | host-interaction/registry                            |
| query or enumerate registry value (6 matches)         | host-interaction/registry                            |
| set registry value                                    | host-interaction/registry/create                     |
| delete registry key                                   | host-interaction/registry/delete                     |
| delete registry value                                 | host-interaction/registry/delete                     |
| get session user name                                 | host-interaction/session                             |
| create thread (2 matches)                             | host-interaction/thread/create                       |
| resume thread (2 matches)                             | host-interaction/thread/resume                       |
| suspend thread                                        | host-interaction/thread/suspend                      |
| access PEB ldr_data (3 matches)                       | linking/runtime-linking                              |
| link function at runtime on Windows (4 matches)       | linking/runtime-linking                              |
| linked against ZLIB                                   | linking/static/zlib                                  |
| enumerate PE sections (5 matches)                     | load-code/pe                                         |
| parse PE header (13 matches)                          | load-code/pe                                         |
| persist via Run registry key                          | persistence/registry/run                             |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6		- Collection::Screen Capture [T1113;6]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Discovery::File and Directory Discovery [T1083;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2		- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
3		- Discovery::System Owner/User Discovery [T1033;3]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
6		- Collection::Clipboard Data [T1115;6]
3		- Discovery::Account Discovery [T1087;3]
2		- Execution::Shared Modules [T1129;2]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 93.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Collection::Screen Capture [T1113;6]', '6'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]', '2'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Collection::Clipboard Data [T1115;6]', '6'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['93.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1855.5939529210582
============================================


==================================================================
Fichier HTTP-FoXD1DmV5s4CmnYe4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIs4S42wpAQbTtcCah.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIs4S42wpAQbTtcCah.exe: Win.Trojan.Agent-375080 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.04 MB (ratio 1.44:1)
Time: 44.969 sec (0 m 44 s)
Start Date: 2022:02:07 15:00:02
End Date:   2022:02:07 15:00:47

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-375080
75		Win.Trojan.Agent-375080
45		Win.Trojan.Agent-375080

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:00:02Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FIs4S42wpAQbTtcCah.exe SCORE: 714 TYPE: EXE SIZE: 36864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa1c68cdfa0> 
MD5: 56bed8249e7c2982a90e54e1e55391a2 
SHA1: 92c1802eeec9c5a15af83961e53c07b04476bd4a 
SHA256: e2aed4398e0178670d9678961ca89a0f15a3eac20f396bdf29de8ac66cb853fa CREATED: Mon Feb  7 15:00:02 2022 MODIFIED: Mon Feb  7 15:00:02 2022 ACCESSED: Mon Feb  7 15:00:55 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: CreateFileA
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_1 SUBSCORE: 2 
DESCRIPTION: Very low entropy - repeating 2 bytes REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff6898204000681017400064a100000000506489250000000083ec20535657 Str3: 558bec6aff6858204000687012400064a100000000506489 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a10000000050 Str2: 558bec6aff6858204000687012400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a10000000050 Str2: 558bec6aff6858204000687012400064a10000000050
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec81 Str2: 558bec83 Str3: 558becb8 Str4: 558bec6a Str5: 558bec6aff6898204000681017400064a10000000050 Str6: 558bec6aff685820400068 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a1000000005064892500000000 Str2: 558bec6aff6858204000687012400064a1000000005064892500000000
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:00:55Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
70		escalate_priv
65		win_token
10		win_files_operation
10		ft_exe
2		math_entropy_1
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 714

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-375080', '70'), ('Win.Trojan.Agent-375080', '75'), ('Win.Trojan.Agent-375080', '45')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('escalate_priv', '70'), ('win_token', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_1', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['714']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
13708.095676581266
============================================


==================================================================
Fichier HTTP-FIs4S42wpAQbTtcCah.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FjAbXO3I88hs3hBPd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 773290480d5445f11d3dc1b800728966                                                   |
| sha1                   | e70318439993e073dc298d45a9c8eaa8cee79e4d                                           |
| sha256                 | 7b8c44c6eba0246f755f1700cc71d39ce756f23b5358957b7fe55b7ac6c30dce                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FjAbXO3I88hs3hBPd.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Virtualization/Sandbox Evasion:: \[T1497]\                                          |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Product Key/ID Testing [B0007.005]                 |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for microsoft office emulation                 | anti-analysis/anti-vm/vm-detection                   |
| check for sandbox username                           | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via device                 | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via dns suffix             | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via genuine state          | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via process name           | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via registry               | anti-analysis/anti-vm/vm-detection                   |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| get local IPv4 addresses                             | host-interaction/network/address                     |
| query or enumerate registry value                    | host-interaction/registry                            |
| get session user name                                | host-interaction/session                             |
| parse PE header (7 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
3		- Discovery::Account Discovery [T1087;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::Query Registry [T1012;1]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
7		- Defense Evasion::Virtualization/Sandbox Evasion [T1497;7]
4		- Discovery::Software Discovery [T1518;4]

Score total: 43.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FjAbXO3I88hs3hBPd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.13 MB
Data read: 0.12 MB (ratio 1.03:1)
Time: 43.345 sec (0 m 43 s)
Start Date: 2022:02:07 15:00:55
End Date:   2022:02:07 15:01:39

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:00:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FjAbXO3I88hs3hBPd.exe SCORE: 229 TYPE: EXE SIZE: 131072 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd5c23b1fa0> 
MD5: 773290480d5445f11d3dc1b800728966 
SHA1: e70318439993e073dc298d45a9c8eaa8cee79e4d 
SHA256: 7b8c44c6eba0246f755f1700cc71d39ce756f23b5358957b7fe55b7ac6c30dce CREATED: Mon Feb  7 15:00:55 2022 MODIFIED: Mon Feb  7 15:00:55 2022 ACCESSED: Mon Feb  7 15:01:42 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453594b1e80d4c8644d8d6a0b933385ff6203000000433a5c55736572735c50435c736f757263655c7265706f735c57696e646f77732053616e64626f7820446 ... (truncated)
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:01:43Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
50		ConventionEngine_Term_Users
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion [T1497;7]', '7'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['43.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4487.368206172568
============================================


==================================================================
Fichier HTTP-FjAbXO3I88hs3hBPd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FrEOb71FrG4eURE7hk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:01:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FrEOb71FrG4eURE7hk.exe SCORE: 419 TYPE: EXE SIZE: 235520 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f0310ca1fa0> 
MD5: 695500833b489cbcbfecd08b1faf81c5 
SHA1: 6d4b085c151f3849630516795077166028c14e27 
SHA256: 2a8993f81a3a8e23829fe6f13dfaf32840633b2d1aec73a7c2ac7acf15acee72 CREATED: Mon Feb  7 15:01:43 2022 MODIFIED: Mon Feb  7 15:01:43 2022 ACCESSED: Mon Feb  7 15:02:17 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier Str3: identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier Str3: identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier Str3: identifier
REASON_13: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: 45c70001
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_16: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:02:18Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
35		Anti_Automated_Sandbox
60		vmdetect_2
60		vmdetect
20		isExecutable
10		Contains_PE_File

Score total: 419

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FrEOb71FrG4eURE7hk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.23 MB
Data read: 0.22 MB (ratio 1.04:1)
Time: 44.039 sec (0 m 44 s)
Start Date: 2022:02:07 15:01:43
End Date:   2022:02:07 15:02:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 695500833b489cbcbfecd08b1faf81c5                                                   |
| sha1                   | 6d4b085c151f3849630516795077166028c14e27                                           |
| sha256                 | 2a8993f81a3a8e23829fe6f13dfaf32840633b2d1aec73a7c2ac7acf15acee72                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FrEOb71FrG4eURE7hk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| DATA                        | Non-Cryptographic Hash::FNV [C0030.005]                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query environment variable                           | host-interaction/environment-variable                |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 10.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '35'), ('vmdetect_2', '60'), ('vmdetect', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['419']
-------------- CAPA_Score ------------
['10.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6850.205019483797
============================================


==================================================================
Fichier HTTP-FrEOb71FrG4eURE7hk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FQzzw53tYl52wjSk08.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:02:29Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FQzzw53tYl52wjSk08.exe SCORE: 324 TYPE: EXE SIZE: 316928 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4f2902bfa0> 
MD5: 93aeb0de230121bad93f8cb76254faef 
SHA1: 925c9e08d60cc7607b466a57a85161c5b166924b 
SHA256: 2b3453d38387189a5b837ed8a4db7014514e5408d4b287403dadf08e4700ff58 CREATED: Mon Feb  7 15:02:29 2022 MODIFIED: Mon Feb  7 15:02:29 2022 ACCESSED: Mon Feb  7 15:03:03 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_14: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 8bc1488b8c24300200004833cc
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:03:03Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		skip20_sqllang_hook
20		isExecutable
10		Contains_PE_File

Score total: 324

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FQzzw53tYl52wjSk08.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.32 MB
Data read: 0.30 MB (ratio 1.05:1)
Time: 44.093 sec (0 m 44 s)
Start Date: 2022:02:07 15:02:29
End Date:   2022:02:07 15:03:13

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 93aeb0de230121bad93f8cb76254faef                                                   |
| sha1                   | 925c9e08d60cc7607b466a57a85161c5b166924b                                           |
| sha256                 | 2b3453d38387189a5b837ed8a4db7014514e5408d4b287403dadf08e4700ff58                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FQzzw53tYl52wjSk08.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| enumerate PE sections (2 matches)                    | load-code/pe                                         |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 9.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('skip20_sqllang_hook', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['324']
-------------- CAPA_Score ------------
['9.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5324.603863496051
============================================


==================================================================
Fichier HTTP-FQzzw53tYl52wjSk08.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFg55n2bbUse9WAxjk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7e17f0f35d50f49407841372f24fbd38                                                   |
| sha1                   | 921ad55a3f593239b906163cf1bb8001194822f3                                           |
| sha256                 | 934c3445fe9d1a3d4cca4d3ec09c9191d8f9067e13e58fa0b288cb520cd40785                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFg55n2bbUse9WAxjk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| parse credit card information                        | collection/credit-card                               |
| encrypt data using RC4 PRGA (5 matches)              | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| allocate thread local storage                        | host-interaction/process                             |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6		- Collection::Automated Collection [T1119;6]
2		- Execution::Shared Modules [T1129;2]

Score total: 12.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFg55n2bbUse9WAxjk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 44.988 sec (0 m 44 s)
Start Date: 2022:02:07 15:03:52
End Date:   2022:02:07 15:04:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 61: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 45: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 29: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:03:52Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFg55n2bbUse9WAxjk.exe SCORE: 324 TYPE: EXE SIZE: 183296 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc501d2efa0> 
MD5: 7e17f0f35d50f49407841372f24fbd38 
SHA1: 921ad55a3f593239b906163cf1bb8001194822f3 
SHA256: 934c3445fe9d1a3d4cca4d3ec09c9191d8f9067e13e58fa0b288cb520cd40785 CREATED: Mon Feb  7 15:03:52 2022 MODIFIED: Mon Feb  7 15:03:52 2022 ACCESSED: Mon Feb  7 15:04:44 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: WriteFile Str5: SetFilePointer Str6: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e86c330000e916feffff Str2: e8d3410000e915ffffff Str3: e812fcffffe9e5feffff Str4: e8b796ffffe97cffffff
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3: 0000000000002240000000000020614000000000000066400000000000804b4000000000000050400000000000c06d40000000000000514000000 ... (truncated)
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_13: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_14: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: IsDebuggerPresent
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:04:45Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 324

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Collection::Automated Collection [T1119;6]', '6'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['324']
-------------- CAPA_Score ------------
['12.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5374.485421370273
============================================


==================================================================
Fichier HTTP-FFg55n2bbUse9WAxjk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSOdrlCKRHxwuvoMd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 433d943ce267eaa3485137e0d21a7348                                                   |
| sha1                   | 0ffbae84afadf220cd379bc823f0ba7e95e50ea5                                           |
| sha256                 | 3c4de3f013d4611bbdb14ea17207e4d93eb406e14e639b1d87ce217c96747cf2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSOdrlCKRHxwuvoMd.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSOdrlCKRHxwuvoMd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 37.704 sec (0 m 37 s)
Start Date: 2022:02:07 15:04:45
End Date:   2022:02:07 15:05:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:04:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FSOdrlCKRHxwuvoMd.exe SCORE: 194 TYPE: EXE SIZE: 70144 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa7525cafa0> 
MD5: 433d943ce267eaa3485137e0d21a7348 
SHA1: 0ffbae84afadf220cd379bc823f0ba7e95e50ea5 
SHA256: 3c4de3f013d4611bbdb14ea17207e4d93eb406e14e639b1d87ce217c96747cf2 CREATED: Mon Feb  7 15:04:45 2022 MODIFIED: Mon Feb  7 15:04:45 2022 ACCESSED: Mon Feb  7 15:05:34 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_10: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_11: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:05:34Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 194

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('ImportTableIsBad', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['194']
-------------- CAPA_Score ------------
['1.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3094.6454165242485
============================================


==================================================================
Fichier HTTP-FSOdrlCKRHxwuvoMd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FQLOCO3SkT7RqkBBwa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FQLOCO3SkT7RqkBBwa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.62 MB
Data read: 0.59 MB (ratio 1.05:1)
Time: 43.639 sec (0 m 43 s)
Start Date: 2022:02:07 15:05:35
End Date:   2022:02:07 15:06:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6b25f1e754ef486bbb28a66d46bababe                                                   |
| sha1                   | a010d69bd8eec8e207578723b1052e8e018eeec5                                           |
| sha256                 | 38749e9c35921ab2fb0b8a80f8e13f89521c58c4d65d18dc4109c816c210e0fe                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FQLOCO3SkT7RqkBBwa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | System Shutdown/Reboot:: \[T1529]\                                                 |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | Interprocess Communication::Create Pipe [C0003.001]                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| create pipe                                           | communication/named-pipe/create                      |
| compiled with exe4j                                   | compiler/exe4j                                       |
| encode data using XOR (3 matches)                     | data-manipulation/encoding/xor                       |
| debug build                                           | executable/pe/debug                                  |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)   | executable/resource                                  |
| accept command line arguments (2 matches)             | host-interaction/cli                                 |
| query environment variable (12 matches)               | host-interaction/environment-variable                |
| set environment variable (4 matches)                  | host-interaction/environment-variable                |
| get common file path (6 matches)                      | host-interaction/file-system                         |
| create directory (4 matches)                          | host-interaction/file-system/create                  |
| delete directory (4 matches)                          | host-interaction/file-system/delete                  |
| delete file (3 matches)                               | host-interaction/file-system/delete                  |
| check if file exists                                  | host-interaction/file-system/exists                  |
| enumerate files recursively                           | host-interaction/file-system/files/list              |
| read file on Windows (8 matches)                      | host-interaction/file-system/read                    |
| write file on Windows (3 matches)                     | host-interaction/file-system/write                   |
| enumerate gui resources                               | host-interaction/gui                                 |
| shutdown system                                       | host-interaction/os                                  |
| check OS version (3 matches)                          | host-interaction/os/version                          |
| allocate thread local storage                         | host-interaction/process                             |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows (4 matches)                 | host-interaction/process/create                      |
| modify access privileges                              | host-interaction/process/modify                      |
| terminate process (4 matches)                         | host-interaction/process/terminate                   |
| query or enumerate registry key (2 matches)           | host-interaction/registry                            |
| query or enumerate registry value (5 matches)         | host-interaction/registry                            |
| set registry value (2 matches)                        | host-interaction/registry/create                     |
| create thread                                         | host-interaction/thread/create                       |
| link many functions at runtime (2 matches)            | linking/runtime-linking                              |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
9		- Impact::System Shutdown/Reboot [T1529;9]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 48.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 55: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 47: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 55: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 47: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:05:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FQLOCO3SkT7RqkBBwa.exe SCORE: 719 TYPE: EXE SIZE: 623104 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fcf3d5fffa0> 
MD5: 6b25f1e754ef486bbb28a66d46bababe 
SHA1: a010d69bd8eec8e207578723b1052e8e018eeec5 
SHA256: 38749e9c35921ab2fb0b8a80f8e13f89521c58c4d65d18dc4109c816c210e0fe CREATED: Mon Feb  7 15:05:35 2022 MODIFIED: Mon Feb  7 15:05:35 2022 ACCESSED: Mon Feb  7 15:06:26 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: WriteFile Str5: SetFilePointer Str6: ReadFile Str7: DeleteFileA Str8: Create ... (truncated)
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: Havex SUBSCORE: 85 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 07e8b6b0ffff59895dfce897ffffff8945e08d45e450e840ffffff593bc374 Str2: 8a46038847038a46028847028a46018847018b45085e5fc9c3 Str3: e8234f0 ... (truncated)
REASON_7: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e844f7ffffe961ffffff Str2: e820f8ffffe9ddffffff Str3: e811f8ffffe9ceffffff Str4: e863b60000e978feffff Str5: e8752e0000e91cffffff Str6 ... (truncated)
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3:  Str4:  Str5:  Str6:  Str7:  Str8:  Str9:  Str10:  Str11:  Str12:  Str13:  Str14:  Str15:  Str16:  Str17:  Str18:  St ... (truncated)
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_16: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: IsDebuggerPresent
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: BBBBBBBBBBBBBBBBBBBB
REASON_25: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_26: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_27: Yara Rule MATCH: CRC32b_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32b [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: b71dc104
REASON_28: Yara Rule MATCH: VC8_Random SUBSCORE: 15 
DESCRIPTION: Look for Random function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: e80f4100008b481469c9fd43030081c1c39e26008948148bc1c1e81025ff7f0000c3
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:06:28Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		win_files_operation
10		ft_exe
85		Havex
2		math_entropy_7
5		obfuscation_singlebyte_mov
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0
25		CRC32_poly_Constant
25		CRC32_table
25		CRC32b_poly_Constant
15		VC8_Random

Score total: 719

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::System Shutdown/Reboot [T1529;9]', '9'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('ft_exe', '10'), ('Havex', '85'), ('math_entropy_7', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('IsPacked', '10'), ('HasOverlay', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers0', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('CRC32b_poly_Constant', '25'), ('VC8_Random', '15')]
-------------- LOKI_Score ------------
['719']
-------------- CAPA_Score ------------
['48.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
12353.107964980467
============================================


==================================================================
Fichier HTTP-FQLOCO3SkT7RqkBBwa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FbAWUR3UxA3X8A1Nda.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | edc83f2d9e0f3906eeff6c5056ebeca6                                                   |
| sha1                   | 3c3bd1889d01ee717b15af7100bf1897beabda49                                           |
| sha256                 | d036bcd15fb7054aa1951bd72c776e3ba089c3e6ab5020a850a1b52ed0ed2f08                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FbAWUR3UxA3X8A1Nda.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 5.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FbAWUR3UxA3X8A1Nda.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 37.198 sec (0 m 37 s)
Start Date: 2022:02:07 15:06:28
End Date:   2022:02:07 15:07:06

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:06:29Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FbAWUR3UxA3X8A1Nda.exe SCORE: 314 TYPE: EXE SIZE: 49664 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fbc54616fa0> 
MD5: edc83f2d9e0f3906eeff6c5056ebeca6 
SHA1: 3c3bd1889d01ee717b15af7100bf1897beabda49 
SHA256: d036bcd15fb7054aa1951bd72c776e3ba089c3e6ab5020a850a1b52ed0ed2f08 CREATED: Mon Feb  7 15:06:28 2022 MODIFIED: Mon Feb  7 15:06:28 2022 ACCESSED: Mon Feb  7 15:07:11 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:07:11Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
20		isExecutable
10		Contains_PE_File

Score total: 314

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['314']
-------------- CAPA_Score ------------
['5.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5086.304051651185
============================================


==================================================================
Fichier HTTP-FbAWUR3UxA3X8A1Nda.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fesxs64IWt3Xi33gt5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:07:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fesxs64IWt3Xi33gt5.exe SCORE: 159 TYPE: EXE SIZE: 190976 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fcd74e38fa0> 
MD5: 914530f2fcb9110f4dcb2b1e027e5ae2 
SHA1: 970f592957e9466de3b0c76d6520a2e8e2a45c72 
SHA256: cd4aa8eb12f2013a19ac68d3858d0c103588096a6b81b0fd6e252bdbf5f09c85 CREATED: Mon Feb  7 15:07:12 2022 MODIFIED: Mon Feb  7 15:07:12 2022 ACCESSED: Mon Feb  7 15:07:43 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:07:44Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fesxs64IWt3Xi33gt5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.19 MB
Data read: 0.18 MB (ratio 1.04:1)
Time: 41.085 sec (0 m 41 s)
Start Date: 2022:02:07 15:07:12
End Date:   2022:02:07 15:07:53

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 914530f2fcb9110f4dcb2b1e027e5ae2                                                   |
| sha1                   | 970f592957e9466de3b0c76d6520a2e8e2a45c72                                           |
| sha256                 | cd4aa8eb12f2013a19ac68d3858d0c103588096a6b81b0fd6e252bdbf5f09c85                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fesxs64IWt3Xi33gt5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (10 matches)          | host-interaction/process/terminate                   |
| create thread (4 matches)                            | host-interaction/thread/create                       |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['159']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2579.8380454622366
============================================


==================================================================
Fichier HTTP-Fesxs64IWt3Xi33gt5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FY7UAxbfz8Q6QO6Ic.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2d3edc218a90f03089cc01715a9f047f                                                   |
| sha1                   | 52c402ab80daf46fe997151819442d8ac97932f6                                           |
| sha256                 | e606530456555bfa92c98365539b16d20bf678fae1ce180d9574a0ea48cc8a9f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FY7UAxbfz8Q6QO6Ic.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                         |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                    |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Service Stop:: \[T1489]\                                                            |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
|                        | Create or Modify System Process::Windows Service \[T1543.003]\                      |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Interprocess Communication::Connect Pipe [C0003.002]                          |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
|                             | Interprocess Communication::Read Pipe [C0003.003]                             |
|                             | Interprocess Communication::Write Pipe [C0003.004]                            |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Checksum::CRC32 [C0032.001]                                                   |
|                             | Checksum::Luhn [C0032.002]                                                    |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| receive data                                         | communication                                        |
| send data                                            | communication                                        |
| create pipe                                          | communication/named-pipe/create                      |
| read pipe (2 matches)                                | communication/named-pipe/read                        |
| write pipe (3 matches)                               | communication/named-pipe/write                       |
| hash data with CRC32                                 | data-manipulation/checksum/crc32                     |
| validate payment card number using luhn algorithm    | data-manipulation/checksum/luhn                      |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| contain an embedded PE file                          | executable/subfile/pe                                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory                                     | host-interaction/file-system/create                  |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| read file on Windows (2 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get disk information                                 | host-interaction/hardware/storage                    |
| check mutex                                          | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| get hostname                                         | host-interaction/os/hostname                         |
| read process memory                                  | host-interaction/process                             |
| create process on Windows (2 matches)                | host-interaction/process/create                      |
| inject thread                                        | host-interaction/process/inject                      |
| enumerate processes (4 matches)                      | host-interaction/process/list                        |
| terminate process (2 matches)                        | host-interaction/process/terminate                   |
| query or enumerate registry value                    | host-interaction/registry                            |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| get token membership                                 | host-interaction/session                             |
| terminate thread                                     | host-interaction/thread/terminate                    |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
| persist via Run registry key                         | persistence/registry/run                             |
| write file to startup folder                         | persistence/startup-folder                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Discovery::File and Directory Discovery [T1083;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Execution::System Services::Service Execution [T1569.002;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
9		- Impact::Service Stop [T1489;9]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
1		- Discovery::System Information Discovery [T1082;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 81.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FY7UAxbfz8Q6QO6Ic.exe: Win.Trojan.ProPOS-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 38.247 sec (0 m 38 s)
Start Date: 2022:02:07 15:08:15
End Date:   2022:02:07 15:08:53

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.ProPOS-1

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xde in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:08:15Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FY7UAxbfz8Q6QO6Ic.exe SCORE: 1014 TYPE: EXE SIZE: 42496 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb3133ddfa0> 
MD5: 2d3edc218a90f03089cc01715a9f047f 
SHA1: 52c402ab80daf46fe997151819442d8ac97932f6 
SHA256: e606530456555bfa92c98365539b16d20bf678fae1ce180d9574a0ea48cc8a9f CREATED: Mon Feb  7 15:08:15 2022 MODIFIED: Mon Feb  7 15:08:15 2022 ACCESSED: Mon Feb  7 15:09:06 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: CreateFileA Str6: SetFileAttributesA Str7: CopyFile
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_8: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: ConventionEngine_Anomaly_NulledOut SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344536ade19bb8007d04f92147832a36de67f0b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_13: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: Visual_Cpp_2005_Release_Microsoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e88a030000e963fdffff
REASON_15: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e88a030000e963fdffff
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2: @B Str3:  Str4: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_17: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_20: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_23: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_24: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_25: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: SOFTWARE\Microsoft\Windows\CurrentVersion Str2: Software\Microsoft\Windows\CurrentVersion Str3: RegQueryValue
REASON_26: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_27: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: firewall.exe
REASON_28: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_29: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_30: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_31: Yara Rule MATCH: easterjackpos SUBSCORE: 60 
DESCRIPTION: Identify JackPOS REF: - AUTHOR: Brian Wallace @botnet_hunter 
MATCHES: Str1: updateinterval= Str2: cardinterval= Str3: {[!17!]}{[!18!]}
REASON_32: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_33: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_34: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:09:07Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		network_http
60		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
50		ConventionEngine_Anomaly_NulledOut
2		math_entropy_6
5		executable_pe
15		dll_injection_thread
70		Visual_Cpp_2005_Release_Microsoft
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
45		Inject_Thread
50		Antivirus_strings
40		SEH_Save
40		SEH_Init
10		anti_dbg
60		easterjackpos
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant

Score total: 1014

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]', '6'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;5]', '5'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.ProPOS-1', '45')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('network_http', '45'), ('win_mutex', '60'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('ConventionEngine_Anomaly_NulledOut', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('dll_injection_thread', '15'), ('Visual_Cpp_2005_Release_Microsoft', '70'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('Inject_Thread', '45'), ('Antivirus_strings', '50'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('easterjackpos', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['1014']
-------------- CAPA_Score ------------
['81.0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
18253.495881987856
============================================


==================================================================
Fichier HTTP-FY7UAxbfz8Q6QO6Ic.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F7fkf51yowCmDeePs5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ae3f3dc3ed900f2a582bad86a764508c                                                   |
| sha1                   | 1e44ee63bdb2cf3a6e48b521844204218a001344                                           |
| sha256                 | 1a1876c5eed2b8cd9e14ebff3f4eeb7e21552a4c6aab4bf392a55f8df3612dab                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F7fkf51yowCmDeePs5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F7fkf51yowCmDeePs5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 44.333 sec (0 m 44 s)
Start Date: 2022:02:07 15:09:07
End Date:   2022:02:07 15:09:52

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:09:07Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F7fkf51yowCmDeePs5.exe SCORE: 229 TYPE: EXE SIZE: 17920 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2c810eefa0> 
MD5: ae3f3dc3ed900f2a582bad86a764508c 
SHA1: 1e44ee63bdb2cf3a6e48b521844204218a001344 
SHA256: 1a1876c5eed2b8cd9e14ebff3f4eeb7e21552a4c6aab4bf392a55f8df3612dab CREATED: Mon Feb  7 15:09:07 2022 MODIFIED: Mon Feb  7 15:09:07 2022 ACCESSED: Mon Feb  7 15:09:59 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:09:59Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['3.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3689.263280185016
============================================


==================================================================
Fichier HTTP-F7fkf51yowCmDeePs5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3ApQL2T2xN93PJL1j.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3ApQL2T2xN93PJL1j.exe: Win.Trojan.Agent-899040 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 39.189 sec (0 m 39 s)
Start Date: 2022:02:07 15:10:00
End Date:   2022:02:07 15:10:39

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-899040
75		Win.Trojan.Agent-899040
45		Win.Trojan.Agent-899040

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:10:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3ApQL2T2xN93PJL1j.exe SCORE: 744 TYPE: EXE SIZE: 22016 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f790657afa0> 
MD5: c335a9d41185a32ad918c5389ee54235 
SHA1: c14680366c5148cde9043a29ef8f13392159bc28 
SHA256: 77003a5710a7c95df61ea015b6e4c204daee7f54cbf69e95f3fdbdda69e05403 CREATED: Mon Feb  7 15:10:00 2022 MODIFIED: Mon Feb  7 15:10:00 2022 ACCESSED: Mon Feb  7 15:10:42 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: InternetWriteFile Str6: HttpOpenRequest Str7: HttpS ... (truncated)
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA Str6: RegCreateKeyA
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: CopyFile
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_9: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_10: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_13: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68f0094000684837400064a100000000506489250000000083ec20535657
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f0094000684837400064a10000000050
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f0094000684837400064a10000000050
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec56 Str2: 558bec6a Str3: 558bec6aff68f0094000684837400064a10000000050
REASON_17: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f0094000684837400064a1000000005064892500000000
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_21: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_23: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_24: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_25: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:10:42Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
60		win_mutex
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 744

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-899040', '70'), ('Win.Trojan.Agent-899040', '75'), ('Win.Trojan.Agent-899040', '45')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('win_mutex', '60'), ('win_registry', '20'), ('win_token', '65'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['744']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
14183.5636343196
============================================


==================================================================
Fichier HTTP-F3ApQL2T2xN93PJL1j.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6tVAn1KCo56vQONK8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 18ec5becfa3991fb654e105bafbd5a4b                                                   |
| sha1                   | 1f3f79edbb6607b9640dd6a99856ee858af9cb55                                           |
| sha256                 | bf023ff344efe2db0e0a963869368f0ef352764666bc368ad61b7a4c1d9f5975                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6tVAn1KCo56vQONK8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| copy file                                            | host-interaction/file-system/copy                    |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file via mapping                                | host-interaction/file-system/read                    |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6tVAn1KCo56vQONK8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 38.466 sec (0 m 38 s)
Start Date: 2022:02:07 15:10:42
End Date:   2022:02:07 15:11:21

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v60', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC_additional', '70'), ('Microsoft_Visual_Cpp_50', '70'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Armadillo_v4x', '70'), ('Microsoft_Visual_Cpp', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['589']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
9534.547135092846
============================================


==================================================================
Fichier HTTP-F6tVAn1KCo56vQONK8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FclDVn3GCuyLFgAxe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1ef610b1f9646063f96ad880aad9569d                                                   |
| sha1                   | bb1ca3681747a48d82d2a95d573ee82adff2b0bd                                           |
| sha256                 | 563653399b82cd443f120eceff836ea3678d4cf11d9b351bb737573c2d856299                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FclDVn3GCuyLFgAxe.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection:: [B0009]                                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| reference anti-VM strings targeting VirtualBox       | anti-analysis/anti-vm/vm-detection                   |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| interact with driver via control codes               | host-interaction/driver                              |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via ntdll functions                  | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| check mutex and exit                                 | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| create or open registry key                          | host-interaction/registry                            |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| start service                                        | host-interaction/service/start                       |
| stop service (2 matches)                             | host-interaction/service/stop                        |
| get ntdll base address (2 matches)                   | linking/runtime-linking                              |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| access PE header (2 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
9		- Impact::Service Stop [T1489;9]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]

Score total: 50.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FclDVn3GCuyLFgAxe.exe: Win.Trojan.ZeroCleare-7511225-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FclDVn3GCuyLFgAxe.exe: Win.Trojan.ZeroCleare-7511333-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FclDVn3GCuyLFgAxe.exe: Win.Trojan.ZeroCleare-7580180-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.14 MB
Data read: 0.14 MB (ratio 1.06:1)
Time: 43.558 sec (0 m 43 s)
Start Date: 2022:02:07 15:11:35
End Date:   2022:02:07 15:12:19

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.ZeroCleare-7511225-0
45		Win.Trojan.ZeroCleare-7511333-0
45		Win.Trojan.ZeroCleare-7580180-2

Score total: 135.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x87 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x87 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:11:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FclDVn3GCuyLFgAxe.exe SCORE: 569 TYPE: EXE SIZE: 146944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe8d3f1afa0> 
MD5: 1ef610b1f9646063f96ad880aad9569d 
SHA1: bb1ca3681747a48d82d2a95d573ee82adff2b0bd 
SHA256: 563653399b82cd443f120eceff836ea3678d4cf11d9b351bb737573c2d856299 CREATED: Mon Feb  7 15:11:35 2022 MODIFIED: Mon Feb  7 15:11:35 2022 ACCESSED: Mon Feb  7 15:12:26 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: CreateService Str3: ControlService Str4: StartService Str5: QueryServiceStatus
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: Intezer_Iranian_Wipers SUBSCORE: 90 
DESCRIPTION: Shamoon, ZeroCleare and Dustman REF: https://analyze.intezer.com AUTHOR: Intezer Labs
REASON_6: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445387df26eb529a5949bb381fa6a09edbd90c000000433a5c55736572735c53445c4465736b746f705c54444c5c536f757263655c4675727574616b615c6f757 ... (truncated)
REASON_7: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445387df26eb529a5949bb381fa6a09edbd90c000000433a5c55736572735c53445c4465736b746f705c54444c5c536f757263655c4675727574616b615c6f757 ... (truncated)
REASON_8: Yara Rule MATCH: SUSP_XORed_URL_in_EXE SUBSCORE: 50 
DESCRIPTION: Detects an XORed URL in an executable REF: https://twitter.com/stvemillertime/status/1237035794973560834 AUTHOR: Florian Roth 
MATCHES: Str1: c2dededa908585
REASON_9: Yara Rule MATCH: MAL_ME_RawDisk_Agent_Jan20_2 SUBSCORE: 70 
DESCRIPTION: Detects suspicious malware using ElRawDisk REF: https://twitter.com/jfslowik/status/1212501454549741568?s=09 AUTHOR: Florian Roth 
MATCHES: Str1: The Magic Word! Str2: Software\Oracle\VirtualBox Str3: \.\%s Str4: 4981c6ffffff7f4c89b42498
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: VBox Str2: VirtualBox
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:12:27Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_service
60		win_mutex
20		win_registry
10		ft_exe
90		Intezer_Iranian_Wipers
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
50		SUSP_XORed_URL_in_EXE
70		MAL_ME_RawDisk_Agent_Jan20_2
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		VBox_Detection
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 569

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.ZeroCleare-7511225-0', '45'), ('Win.Trojan.ZeroCleare-7511333-0', '45'), ('Win.Trojan.ZeroCleare-7580180-2', '45')]
-------------- LOKI_Rules ------------
[('create_service', '45'), ('win_mutex', '60'), ('win_registry', '20'), ('ft_exe', '10'), ('Intezer_Iranian_Wipers', '90'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('SUSP_XORed_URL_in_EXE', '50'), ('MAL_ME_RawDisk_Agent_Jan20_2', '70'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('VBox_Detection', '35'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['569']
-------------- CAPA_Score ------------
['50.5']
-------------- CLAMAV_Score ------------
['135.0']
-------------- SCORE FINAL ------------
11725.199040085146
============================================


==================================================================
Fichier HTTP-FclDVn3GCuyLFgAxe.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOH1k84KesZB7j8CDb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e5369ac309f1be6d77afeeb3edab0ed8                                                   |
| sha1                   | b7afd3c57b074109bf576b77b33d641fd8e87871                                           |
| sha256                 | 478383fb588665c254d416b7c50a124f82291124b002d9bad9fd758a59fd728f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FOH1k84KesZB7j8CDb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Indicator Removal on Host:: \[T1070]\                                               |
|                        | Indicator Removal on Host::Clear Windows Event Logs \[T1070.001]\                   |
|                        | Indicator Removal on Host::File Deletion \[T1070.004]\                              |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                  |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Subvert Trust Controls::Mark-of-the-Web Bypass \[T1553.005]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Network Share Discovery:: \[T1135]\                                                 |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Inhibit System Recovery:: \[T1490]\                                                 |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
|                             | Disk Content Wipe::Delete Shadow Drive [F0014.001]                            |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| impersonate file version information                 | anti-analysis/anti-forensic                          |
| clear the Windows event log (2 matches)              | anti-analysis/anti-forensic/clear-logs               |
| timestomp file (3 matches)                           | anti-analysis/anti-forensic/timestomp                |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI                    | data-manipulation/encryption/aes                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                      | data-manipulation/hashing                            |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| replace clipboard data                               | host-interaction/clipboard                           |
| query environment variable (6 matches)               | host-interaction/environment-variable                |
| bypass Mark of the Web                               | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file (4 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively (2 matches)              | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get file size (2 matches)                            | host-interaction/file-system/meta                    |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| move file (2 matches)                                | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window (2 matches)                    | host-interaction/gui/window/hide                     |
| get number of processors                             | host-interaction/hardware/cpu                        |
| get disk information (2 matches)                     | host-interaction/hardware/storage                    |
| access the Windows event log (2 matches)             | host-interaction/log/winevt/access                   |
| check mutex and exit                                 | host-interaction/mutex                               |
| enumerate network shares                             | host-interaction/network                             |
| create process on Windows (3 matches)                | host-interaction/process/create                      |
| create process suspended (3 matches)                 | host-interaction/process/create                      |
| enumerate processes                                  | host-interaction/process/list                        |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| delete registry value                                | host-interaction/registry/delete                     |
| get session information                              | host-interaction/session                             |
| create thread (3 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| delete volume shadow copies                          | impact/inhibit-system-recovery                       |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| persist via Run registry key (2 matches)             | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
6		- Defense Evasion::Subvert Trust Controls::Mark-of-the-Web Bypass [T1553.005;6]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
2		- Discovery::File and Directory Discovery [T1083;2]
8.5		- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
8		- Impact::Inhibit System Recovery [T1490;8]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
6		- Collection::Clipboard Data [T1115;6]
2		- Execution::Shared Modules [T1129;2]
8.5		- Defense Evasion::Indicator Removal on Host [T1070;8.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 114.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOH1k84KesZB7j8CDb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 32.437 sec (0 m 32 s)
Start Date: 2022:02:07 15:12:27
End Date:   2022:02:07 15:13:00

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:12:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FOH1k84KesZB7j8CDb.exe SCORE: 909 TYPE: EXE SIZE: 18432 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa152ad0fa0> 
MD5: e5369ac309f1be6d77afeeb3edab0ed8 
SHA1: b7afd3c57b074109bf576b77b33d641fd8e87871 
SHA256: 478383fb588665c254d416b7c50a124f82291124b002d9bad9fd758a59fd728f CREATED: Mon Feb  7 15:12:27 2022 MODIFIED: Mon Feb  7 15:12:27 2022 ACCESSED: Mon Feb  7 15:13:13 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: Destructive_Ransomware_Gen1 SUBSCORE: 70 
DESCRIPTION: Detects destructive malware REF: http://blog.talosintelligence.com/2018/02/olympic-destroyer.html AUTHOR: Florian Roth 
MATCHES: Str1: delete shadows /all /quiet
REASON_7: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_10: Yara Rule MATCH: Borland_Delphi_30_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_11: Yara Rule MATCH: Borland_Delphi_30_ SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_12: Yara Rule MATCH: Borland_Delphi_v40_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_13: Yara Rule MATCH: Borland_Delphi_v30 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_14: Yara Rule MATCH: Borland_Delphi_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_20: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_21: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_22: Yara Rule MATCH: Win32_Ransomware_Kangaroo SUBSCORE: 60 
DESCRIPTION: Yara rule that detects Kangaroo ransomware. REF: - AUTHOR: ReversingLabs 
MATCHES: Str1: 83ec3053558b6c243c565733ff57576a03576a0768000000c033db55895c2440897c2434897c2430ff15003140008bf083feff0f84f60100008d442428508d4c24345 ... (truncated)
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:13:13Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
60		win_mutex
20		win_registry
10		win_files_operation
10		ft_exe
70		Destructive_Ransomware_Gen1
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Borland_Delphi_30_additional
70		Borland_Delphi_30_
70		Borland_Delphi_v40_v50
70		Borland_Delphi_v30
70		Borland_Delphi_DLL
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		Win32_Ransomware_Kangaroo
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 909

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Defense Evasion::Subvert Trust Controls::Mark-of-the-Web Bypass [T1553.005;6]', '6'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]', '8.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Impact::Inhibit System Recovery [T1490;8]', '8'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;5]', '5'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]', '6'), ('- Collection::Clipboard Data [T1115;6]', '6'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Indicator Removal on Host [T1070;8.5]', '8.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('win_mutex', '60'), ('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '10'), ('Destructive_Ransomware_Gen1', '70'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_v50v60_MFC', '70'), ('Borland_Delphi_30_additional', '70'), ('Borland_Delphi_30_', '70'), ('Borland_Delphi_v40_v50', '70'), ('Borland_Delphi_v30', '70'), ('Borland_Delphi_DLL', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Win32_Ransomware_Kangaroo', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['909']
-------------- CAPA_Score ------------
['114.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
16681.278158536043
============================================


==================================================================
Fichier HTTP-FOH1k84KesZB7j8CDb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCgi1M3xwL2lh3MPIc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCgi1M3xwL2lh3MPIc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.48 MB
Data read: 0.46 MB (ratio 1.05:1)
Time: 41.445 sec (0 m 41 s)
Start Date: 2022:02:07 15:13:14
End Date:   2022:02:07 15:13:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 25: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 24: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 45: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 38: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 33: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 32: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 24: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 45: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 24: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 23: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:13:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FCgi1M3xwL2lh3MPIc.exe SCORE: 1849 TYPE: EXE SIZE: 485888 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2623747fa0> 
MD5: 321338196a46b600ea330fc5d98d0699 
SHA1: 4383ae835ced10ee49f88fe5a965d70679d4a8bc 
SHA256: 66e51558f8bf9a329f2e9a2feb4592a4a30fd9124e171a8e2f17ba00fb902b0f CREATED: Mon Feb  7 15:13:14 2022 MODIFIED: Mon Feb  7 15:13:14 2022 ACCESSED: Mon Feb  7 15:14:06 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: FindClose
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e805000000e95affffff Str2: e805000000e945ffffff Str3: e861aeffffe9abfdffff Str4: e831acffffe97bfbffff Str5: e844a8ffffe98ef7ffff Str6 ... (truncated)
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_12: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_13: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_14: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_15: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_16: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_17: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_31: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_32: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_33: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: dbghelp.dll
REASON_34: Yara Rule MATCH: antisb_threatExpert SUBSCORE: 60 
DESCRIPTION: Anti-Sandbox checks for ThreatExpert REF: - AUTHOR: x0r 
MATCHES: Str1: dbghelp.dll
REASON_35: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_36: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_37: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_38: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_39: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:14:07Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		antisb_threatExpert
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 1849

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 321338196a46b600ea330fc5d98d0699                                                   |
| sha1                   | 4383ae835ced10ee49f88fe5a965d70679d4a8bc                                           |
| sha256                 | 66e51558f8bf9a329f2e9a2feb4592a4a30fd9124e171a8e2f17ba00fb902b0f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FCgi1M3xwL2lh3MPIc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check QueryPerformanceCounter [B0001.033]    |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Resume Thread:: [C0054]                                                       |
|                             | Suspend Thread:: [C0055]                                                      |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via QueryPerformanceCounter     | anti-analysis/anti-debugging/debugger-detection      |
| compiled with dmd                                    | compiler/d                                           |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| hash data using murmur3 (3 matches)                  | data-manipulation/hashing/murmur                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query environment variable                           | host-interaction/environment-variable                |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get memory capacity (2 matches)                      | host-interaction/hardware/memory                     |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| resume thread (3 matches)                            | host-interaction/thread/resume                       |
| suspend thread                                       | host-interaction/thread/suspend                      |
| terminate thread                                     | host-interaction/thread/terminate                    |
| access PEB ldr_data (3 matches)                      | linking/runtime-linking                              |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE exports (9 matches)                         | load-code/pe                                         |
| parse PE header (32 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 19.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('antisb_threatExpert', '60'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['1849']
-------------- CAPA_Score ------------
['19.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
29693.751280024917
============================================


==================================================================
Fichier HTTP-FCgi1M3xwL2lh3MPIc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FaifWB4xL4xGMBRC95.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 39009536cafe30c6ef2501fe46c9df5e                                                   |
| sha1                   | 6ff7b4d30f31186de899665c704a105227704b72                                           |
| sha256                 | 93d2604f7fdf7f014ac5bef63ab177b6107f3cfc26da6cbd9a7ab50c96564a04                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FaifWB4xL4xGMBRC95.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                             |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Service Discovery:: \[T1007]\                                                |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
|                        | System Services::Service Execution \[T1569.002]\                                    |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
|                        | Create or Modify System Process::Windows Service \[T1543.003]\                      |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                               |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable (5 matches)               | host-interaction/environment-variable                |
| create directory                                     | host-interaction/file-system/create                  |
| delete file (3 matches)                              | host-interaction/file-system/delete                  |
| get file version info                                | host-interaction/file-system/meta                    |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information                                 | host-interaction/hardware/storage                    |
| get system information on Windows                    | host-interaction/os/info                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| modify access privileges                             | host-interaction/process/modify                      |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (4 matches)        | host-interaction/registry                            |
| set registry value (4 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| enumerate services                                   | host-interaction/service/list                        |
| modify service                                       | host-interaction/service/modify                      |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Discovery::Application Window Discovery [T1010;4]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 47.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:14:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FaifWB4xL4xGMBRC95.exe SCORE: 494 TYPE: EXE SIZE: 197632 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f69e2d95fa0> 
MD5: 39009536cafe30c6ef2501fe46c9df5e 
SHA1: 6ff7b4d30f31186de899665c704a105227704b72 
SHA256: 93d2604f7fdf7f014ac5bef63ab177b6107f3cfc26da6cbd9a7ab50c96564a04 CREATED: Mon Feb  7 15:14:53 2022 MODIFIED: Mon Feb  7 15:14:53 2022 ACCESSED: Mon Feb  7 15:15:34 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:15:35Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
65		screenshot
80		keylogger
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 494

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FaifWB4xL4xGMBRC95.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.20 MB
Data read: 0.19 MB (ratio 1.04:1)
Time: 44.619 sec (0 m 44 s)
Start Date: 2022:02:07 15:14:53
End Date:   2022:02:07 15:15:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_token', '65'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsWindowsGUI', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['494']
-------------- CAPA_Score ------------
['47.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8777.121970368116
============================================


==================================================================
Fichier HTTP-FaifWB4xL4xGMBRC95.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FnRaB12F3s8T2FD7fk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FnRaB12F3s8T2FD7fk.exe: Win.Exploit.CVE_2019_1219-7151042-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.52 MB
Data read: 0.50 MB (ratio 1.06:1)
Time: 44.150 sec (0 m 44 s)
Start Date: 2022:02:07 15:15:38
End Date:   2022:02:07 15:16:22

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2019_1219-7151042-2

Score total: 25.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3cb21ae76ff3da4b7e02d77ff76e82be                                                   |
| sha1                   | 7156270661549f75c253f169fe8988690f6fc700                                           |
| sha256                 | c2c49f2592f78b7a70fd984dbbb25f7251dd1c851caa884f39ff1c8075f0b228                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FnRaB12F3s8T2FD7fk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Data from Information Repositories:: \[T1213]\                                     |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Asynchronous Procedure Call \[T1055.004]\                       |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
|                        | Virtualization/Sandbox Evasion::User Activity Based Checks \[T1497.002]\           |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
|                        | Windows Management Instrumentation:: \[T1047]\                                     |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection:: [B0001]                                                  |
|                             | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
|                             | Debugger Detection::CheckRemoteDebuggerPresent [B0001.002]                    |
|                             | Debugger Detection::Memory Write Watching [B0001.010]                         |
|                             | Debugger Detection::OutputDebugString [B0001.016]                             |
|                             | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]        |
|                             | Debugger Detection::SetHandleInformation [B0001.024]                          |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Debugger Detection::WudfIsAnyDebuggerPresent [B0001.031]                      |
|                             | Emulator Detection:: [B0004]                                                  |
|                             | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Human User Check [B0009.012]                       |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
| COMMUNICATION               | ICMP Communication::Echo Request [C0014.002]                                  |
| DISCOVERY                   | Analysis Tool Discovery::Process Detection [B0013.001]                        |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference analysis tools strings                     | anti-analysis                                        |
| check for OutputDebugString error                    | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB NtGlobalFlag flag                      | anti-analysis/anti-debugging/debugger-detection      |
| check for debugger via API                           | anti-analysis/anti-debugging/debugger-detection      |
| check for protected handle exception                 | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| check for trap flag exception                        | anti-analysis/anti-debugging/debugger-detection      |
| check for unexpected memory writes (3 matches)       | anti-analysis/anti-debugging/debugger-detection      |
| check process job object                             | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-debugging instructions (2 matches)      | anti-analysis/anti-debugging/debugger-detection      |
| check if process is running under wine (2 matches)   | anti-analysis/anti-emulation/wine                    |
| check for unmoving mouse cursor                      | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Parallels        | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Qemu             | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualBox       | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualPC        | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Xen              | anti-analysis/anti-vm/vm-detection                   |
| reference WMI statements (30 matches)                | collection/database/wmi                              |
| log keystrokes via application hook                  | collection/keylog                                    |
| get MAC address on Windows                           | collection/network                                   |
| send ICMP echo request                               | communication/icmp                                   |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable (4 matches)               | host-interaction/environment-variable                |
| get Program Files directory (2 matches)              | host-interaction/file-system                         |
| get common file path (5 matches)                     | host-interaction/file-system                         |
| read raw disk data                                   | host-interaction/file-system                         |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (2 matches)                      | host-interaction/file-system/meta                    |
| set console window title                             | host-interaction/gui/console                         |
| find graphical window                                | host-interaction/gui/window/find                     |
| get number of processor cores                        | host-interaction/hardware/cpu                        |
| get number of processors                             | host-interaction/hardware/cpu                        |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| enumerate disk properties                            | host-interaction/hardware/storage                    |
| get disk information (2 matches)                     | host-interaction/hardware/storage                    |
| get disk size (2 matches)                            | host-interaction/hardware/storage                    |
| print debug messages (6 matches)                     | host-interaction/log/debug/write-event               |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows (4 matches)        | host-interaction/os/info                             |
| get process heap flags (2 matches)                   | host-interaction/process                             |
| get process heap force flags (2 matches)             | host-interaction/process                             |
| read process memory (2 matches)                      | host-interaction/process                             |
| allocate RWX memory (2 matches)                      | host-interaction/process/inject                      |
| inject APC                                           | host-interaction/process/inject                      |
| inject dll                                           | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| get Explorer PID                                     | host-interaction/process/list                        |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| enumerate process modules (2 matches)                | host-interaction/process/modules/list                |
| terminate process                                    | host-interaction/process/terminate                   |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry value                    | host-interaction/registry                            |
| enumerate services                                   | host-interaction/service/list                        |
| enumerate threads (2 matches)                        | host-interaction/thread/list                         |
| connect to WMI namespace via WbemLocator             | host-interaction/wmi                                 |
| get kernel32 base address                            | linking/runtime-linking                              |
| link function at runtime on Windows (7 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
4.5		- Execution::Windows Management Instrumentation [T1047;4.5]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
4		- Discovery::Application Window Discovery [T1010;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
5		- Collection::Data from Information Repositories [T1213;5]
2		- Execution::Shared Modules [T1129;2]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
7.5		- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
4		- Discovery::Software Discovery [T1518;4]

Score total: 88.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Process Discovery [T1057;4]', '4'), ('- Execution::Windows Management Instrumentation [T1047;4.5]', '4.5'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]', '6'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]', '5'), ('- Collection::Data from Information Repositories [T1213;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]', '7.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Software Discovery [T1518;4]', '4')]
---------------- ClamAV_Rules --------------
[('Win.Exploit.CVE_2019_1219-7151042-2', '25')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('escalate_priv', '70'), ('screenshot', '65'), ('keylogger', '80'), ('migrate_apc', '45'), ('win_mutex', '60'), ('win_registry', '20'), ('win_token', '65'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '10'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_5', '2'), ('obfuscation_singlebyte_mov', '5'), ('executable_pe', '5'), ('self_inject', '15'), ('dll_injection_thread', '15'), ('dll_injection_hook', '15'), ('possible_includes_base64_packed_functions', '25'), ('Microsoft_Visual_Cpp_V80_Debug', '70'), ('Microsoft_Visual_Cpp_80_Debug_', '70'), ('Microsoft_Visual_Cpp_80_Debug', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('virtualbox_detection', '10'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '35'), ('Check_Dlls', '30'), ('Check_VBox_DeviceMap', '60'), ('Check_VBox_VideoDrivers', '60'), ('Check_VmTools', '60'), ('vmdetect_2', '60'), ('WMI_VM_Detect_v1', '50'), ('AtomTable_Inject', '35'), ('DLL_inject', '40'), ('Inject_Thread', '45'), ('Win_Hook_v12', '35'), ('Process_Doppelganging', '35'), ('Atom_Bombing', '40'), ('APC_Inject', '40'), ('Debugger_Check__GlobalFlags', '60'), ('Debugger_Check__QueryInfo', '60'), ('Debugger_Check__RemoteAPI', '60'), ('Debugger_Hiding__Thread', '60'), ('DebuggerHiding__Active_v1', '60'), ('DebuggerException__ConsoleCtrl_v1', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('ThreadControl__Context_v1', '60'), ('SEH__vectored_v1', '60'), ('Check_Debugger_v1', '60'), ('Check_Qemu_Description', '40'), ('Check_Qemu_DeviceMap', '40'), ('vmdetect', '60'), ('WMI_VM_Detect', '50'), ('anti_dbg', '10'), ('vmdetect_misc', '50'), ('VMdetectMisc', '25'), ('SandboxDetectMisc', '70'), ('avdetect_procs', '70'), ('dbgdetect_procs', '70'), ('TrojanDownloaderCbeplaySample', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('MD5_API', '25')]
-------------- LOKI_Score ------------
['2919']
-------------- CAPA_Score ------------
['88.0']
-------------- CLAMAV_Score ------------
['25.0']
-------------- SCORE FINAL ------------
48333.59447806105
============================================


==================================================================
Fichier HTTP-FnRaB12F3s8T2FD7fk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FKIxjE1vFMOSCFh2Mh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c62801f2fd980d444ec12455f83cf536                                                   |
| sha1                   | 82f508b9caaf23f766935d03d43c28c787ae1b2b                                           |
| sha256                 | 5b63cdaa6b386340186d48fca6687b51d666f4457c1d1228c4915bdd2917a315                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FKIxjE1vFMOSCFh2Mh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get disk information                                 | host-interaction/hardware/storage                    |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 4.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:17:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FKIxjE1vFMOSCFh2Mh.exe SCORE: 229 TYPE: EXE SIZE: 17920 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f643cd49fa0> 
MD5: c62801f2fd980d444ec12455f83cf536 
SHA1: 82f508b9caaf23f766935d03d43c28c787ae1b2b 
SHA256: 5b63cdaa6b386340186d48fca6687b51d666f4457c1d1228c4915bdd2917a315 CREATED: Mon Feb  7 15:17:12 2022 MODIFIED: Mon Feb  7 15:17:12 2022 ACCESSED: Mon Feb  7 15:17:53 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:17:54Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FKIxjE1vFMOSCFh2Mh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 44.007 sec (0 m 44 s)
Start Date: 2022:02:07 15:17:12
End Date:   2022:02:07 15:17:56

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_5', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80', '70'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['229']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3709.2159033347043
============================================


==================================================================
Fichier HTTP-FKIxjE1vFMOSCFh2Mh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FNAYpG4dOoFvmSU4ek.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FNAYpG4dOoFvmSU4ek.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.32 MB
Data read: 0.30 MB (ratio 1.05:1)
Time: 48.927 sec (0 m 48 s)
Start Date: 2022:02:07 15:17:56
End Date:   2022:02:07 15:18:45

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 63: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 62: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:17:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FNAYpG4dOoFvmSU4ek.exe SCORE: 524 TYPE: EXE SIZE: 315904 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f99bca7ffa0> 
MD5: e4c33ac3638eef68311f8ac0d72483c7 
SHA1: f78bc256038330de1b23be28e93206d9b64d03ef 
SHA256: 033f4cb193b78f18f70c36e53ab46b21b81449c59e9fe302e1778a6898a5479a CREATED: Mon Feb  7 15:17:56 2022 MODIFIED: Mon Feb  7 15:17:56 2022 ACCESSED: Mon Feb  7 15:18:50 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA Str6: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453e9937259b583cf48a17705ed53425f9301000000433a5c55736572735c757365725c736f757263655c7265706f735c61737369676e6d656e74325c4465627 ... (truncated)
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Users_User SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453e9937259b583cf48a17705ed53425f9301000000433a5c55736572735c757365725c736f757263655c7265706f735c61737369676e6d656e74325c4465627 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8ca030000e917feffff Str2: e804720000e9a1ffffff Str3: e806000000e962ffffff Str4: e81ee5ffffe92affffff Str5: e804000000e9d3fdffff Str6 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3:  Str4:  Str5:  Str6:  Str7:  Str8:  Str9:  Str10:  Str11:  Str12:  Str13:  Str14:  Str15:  Str16:  Str17:  Str18:  St ... (truncated)
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_16: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:18:51Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_Users_User
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
60		DebuggerException__SetConsoleCtrl_v1
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
25		Crypt32_CryptBinaryToString_API

Score total: 524

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e4c33ac3638eef68311f8ac0d72483c7                                                   |
| sha1                   | f78bc256038330de1b23be28e93206d9b64d03ef                                           |
| sha256                 | 033f4cb193b78f18f70c36e53ab46b21b81449c59e9fe302e1778a6898a5479a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FNAYpG4dOoFvmSU4ek.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| initialize Winsock library                           | communication/socket                                 |
| encode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set environment variable (2 matches)                 | host-interaction/environment-variable                |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| read file via mapping                                | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| get hostname                                         | host-interaction/os/hostname                         |
| get session user name                                | host-interaction/session                             |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| inject DLL reflectively                              | load-code/pe                                         |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::Account Discovery [T1087;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 25.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5.5]', '5.5'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]', '5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '10'), ('ConventionEngine_Term_Users', '50'), ('ConventionEngine_Term_Users_User', '50'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('VC8_Microsoft_Corporation', '70'), ('Microsoft_Visual_Cpp_8', '70'), ('IsPE32', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('SEH_Save', '40'), ('SEH_Init', '40'), ('anti_dbg', '10'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Crypt32_CryptBinaryToString_API', '25')]
-------------- LOKI_Score ------------
['524']
-------------- CAPA_Score ------------
['25.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8813.632218813298
============================================


==================================================================
Fichier HTTP-FNAYpG4dOoFvmSU4ek.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FPblla4SuwQGMsD3K9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FPblla4SuwQGMsD3K9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.23 MB
Data read: 0.23 MB (ratio 1.03:1)
Time: 45.560 sec (0 m 45 s)
Start Date: 2022:02:07 15:19:29
End Date:   2022:02:07 15:20:14

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:19:29Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FPblla4SuwQGMsD3K9.exe SCORE: 309 TYPE: EXE SIZE: 239416 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fed2cd99fa0> 
MD5: 05aeb5e395b205d60ae010c5105b71f9 
SHA1: b2ae6398c50353baf9de5b1c16a74f79437f9310 
SHA256: 29649c628aa857904fa83bf577ef4f70527fa73bb4fa4c1539f6dc8ddfb896aa CREATED: Mon Feb  7 15:19:29 2022 MODIFIED: Mon Feb  7 15:19:29 2022 ACCESSED: Mon Feb  7 15:20:25 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:20:25Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 309

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 05aeb5e395b205d60ae010c5105b71f9                                                   |
| sha1                   | b2ae6398c50353baf9de5b1c16a74f79437f9310                                           |
| sha256                 | 29649c628aa857904fa83bf577ef4f70527fa73bb4fa4c1539f6dc8ddfb896aa                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FPblla4SuwQGMsD3K9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate gui resources                              | host-interaction/gui                                 |
| terminate process via fastfail (6 matches)           | host-interaction/process/terminate                   |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
4		- Discovery::Application Window Discovery [T1010;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 11.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Location Discovery [T1614;1.5]', '1.5'), ('- Discovery::Application Window Discovery [T1010;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['309']
-------------- CAPA_Score ------------
['11.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5126.775130926261
============================================


==================================================================
Fichier HTTP-FPblla4SuwQGMsD3K9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FBz4Q84HZVxHR8P7kd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FBz4Q84HZVxHR8P7kd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.28 MB
Data read: 0.27 MB (ratio 1.06:1)
Time: 45.063 sec (0 m 45 s)
Start Date: 2022:02:07 15:20:38
End Date:   2022:02:07 15:21:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:20:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FBz4Q84HZVxHR8P7kd.exe SCORE: 544 TYPE: EXE SIZE: 282488 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fec53012fa0> 
MD5: b1116e05a2aeda8e95f89e74c1525a6c 
SHA1: 7685045ccd89e21943330c049a84e6f0184104be 
SHA256: 1cdf9d33b2c92a212c8a297802178127f354131d6d05641b6fdb6c52aff5fde3 CREATED: Mon Feb  7 15:20:38 2022 MODIFIED: Mon Feb  7 15:20:38 2022 ACCESSED: Mon Feb  7 15:21:29 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_19: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 340b71789a9b7dc52cae1c90b8a71a90
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:21:30Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
60		win_mutex
10		misc_pe_signature
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
45		Inject_Thread
60		Debugger_Check__QueryInfo
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 544

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b1116e05a2aeda8e95f89e74c1525a6c                                                   |
| sha1                   | 7685045ccd89e21943330c049a84e6f0184104be                                           |
| sha256                 | 1cdf9d33b2c92a212c8a297802178127f354131d6d05641b6fdb6c52aff5fde3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FBz4Q84HZVxHR8P7kd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| PROCESS                     | Resume Thread:: [C0054]                                                       |
|                             | Suspend Thread:: [C0055]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| decode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| read file on Windows                                 | host-interaction/file-system/read                    |
| check OS version                                     | host-interaction/os/version                          |
| acquire debug privileges                             | host-interaction/process/modify                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| resume thread                                        | host-interaction/thread/resume                       |
| suspend thread                                       | host-interaction/thread/suspend                      |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 19.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_mutex', '60'), ('misc_pe_signature', '10'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('Microsoft_Visual_Cpp_80_DLL', '70'), ('IsPE64', '10'), ('IsConsole', '10'), ('HasOverlay', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '35'), ('VMWare_Detection', '35'), ('Anti_Automated_Sandbox', '35'), ('Inject_Thread', '45'), ('Debugger_Check__QueryInfo', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['544']
-------------- CAPA_Score ------------
['19.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
9010.895118407387
============================================


==================================================================
Fichier HTTP-FBz4Q84HZVxHR8P7kd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFVBvDDWokrN27Gj9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFVBvDDWokrN27Gj9.exe: Win.Trojan.Buzus-9327 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.57 MB
Data read: 0.41 MB (ratio 1.39:1)
Time: 44.588 sec (0 m 44 s)
Start Date: 2022:02:07 15:21:47
End Date:   2022:02:07 15:22:31

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Buzus-9327

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:21:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFVBvDDWokrN27Gj9.exe SCORE: 799 TYPE: EXE SIZE: 429568 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa7a94f6fa0> 
MD5: db9fe790b4e18abf55df31aa0b81e558 
SHA1: 97f2462c4462364babbc82ad49b7bd65e8647474 
SHA256: d7dbe8d8a68c26bf5d00adb957a4dbf5bd6415a81b50a823a4b872a6d2f494cf CREATED: Mon Feb  7 15:21:47 2022 MODIFIED: Mon Feb  7 15:21:47 2022 ACCESSED: Mon Feb  7 15:22:37 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: USER32.DLL Str3: GetAsyncKeyState
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: KERNEL32.DLL Str3: WriteFile Str4: DeleteFileA Str5: CreateFileA
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: PEBundle_v244_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd
REASON_7: Yara Rule MATCH: PEBundle_v310 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd3d29400001
REASON_8: Yara Rule MATCH: PEBundle_v310_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd3d29400001
REASON_9: Yara Rule MATCH: PEBundle_20x_24x_Jeremy_Collake SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd
REASON_10: Yara Rule MATCH: PEBundle_v244 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd
REASON_11: Yara Rule MATCH: PEBundlev310 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd3d29400001
REASON_12: Yara Rule MATCH: PEBundlev244 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: USER32.DLL Str3: SetWindowsHookExA Str4: CallNextHookEx
REASON_19: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: pebundle
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 88888888888888888888
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:22:38Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
10		win_files_operation
10		ft_exe
2		math_entropy_4
5		executable_pe
70		PEBundle_v244_additional
70		PEBundle_v310
70		PEBundle_v310_additional
70		PEBundle_20x_24x_Jeremy_Collake
70		PEBundle_v244
70		PEBundlev310
70		PEBundlev244
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
35		Win_Hook_v12
60		suspicious_packer_section
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0

Score total: 799

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Buzus-9327', '45')]
-------------- LOKI_Rules ------------
[('keylogger', '80'), ('win_files_operation', '10'), ('ft_exe', '10'), ('math_entropy_4', '2'), ('executable_pe', '5'), ('PEBundle_v244_additional', '70'), ('PEBundle_v310', '70'), ('PEBundle_v310_additional', '70'), ('PEBundle_20x_24x_Jeremy_Collake', '70'), ('PEBundle_v244', '70'), ('PEBundlev310', '70'), ('PEBundlev244', '70'), ('IsPE32', '10'), ('IsWindowsGUI', '10'), ('HasRichSignature', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('Win_Hook_v12', '35'), ('suspicious_packer_section', '60'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Big_Numbers0', '10')]
-------------- LOKI_Score ------------
['799']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
13229.813043071672
============================================


==================================================================
Fichier HTTP-FFVBvDDWokrN27Gj9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FH9QBW2JD7vVyRVHo.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ad82b246ddc7b8a49936670ec1ecbec8                                                   |
| sha1                   | e7be001f09b210ad402f76a7f7d336477440d762                                           |
| sha256                 | f405ef44de0fa7c79c20a4843fe0f76eebf64e34d32ebb29aa98d998acf89036                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FH9QBW2JD7vVyRVHo.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::3DES [C0027.004]                                                |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DEFENSE EVASION             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt (3 matches)          | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI (2 matches)        | data-manipulation/encryption/aes                     |
| encrypt data using DES via WinAPI                    | data-manipulation/encryption/des                     |
| hash data via WinCrypt (2 matches)                   | data-manipulation/hashing                            |
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                    | data-manipulation/hashing/sha1                       |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FH9QBW2JD7vVyRVHo.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.11 MB
Data read: 0.11 MB (ratio 1.00:1)
Time: 42.979 sec (0 m 42 s)
Start Date: 2022:02:07 15:22:39
End Date:   2022:02:07 15:23:22

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:22:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FH9QBW2JD7vVyRVHo.exe SCORE: 184 TYPE: EXE SIZE: 111616 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd434bf9fa0> 
MD5: ad82b246ddc7b8a49936670ec1ecbec8 
SHA1: e7be001f09b210ad402f76a7f7d336477440d762 
SHA256: f405ef44de0fa7c79c20a4843fe0f76eebf64e34d32ebb29aa98d998acf89036 CREATED: Mon Feb  7 15:22:39 2022 MODIFIED: Mon Feb  7 15:22:39 2022 ACCESSED: Mon Feb  7 15:23:32 2022 
REASON_1: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:23:32Z

-------- Score ----------------
Scores		Rules
.......		...............
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 184

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_token', '65'), ('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE64', '10'), ('IsDLL', '10'), ('IsConsole', '10'), ('HasDebugData', '10'), ('HasRichSignature', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['184']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2996.0139667272033
============================================


==================================================================
Fichier HTTP-FH9QBW2JD7vVyRVHo.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F5Kw8a1jRGiMwYrM45.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5b3968b47eb16a1cb88525e3b565eab1                                                   |
| sha1                   | 43f2c73e08b589d6885bd248b056fe4ac99a590b                                           |
| sha256                 | 5f70c76b6771b7c56bc5da34e424eb9a090cedeb807c795795a88c415a2e772c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F5Kw8a1jRGiMwYrM45.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| compiled with MinGW for Windows                      | compiler/mingw                                       |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| write file on Windows                                | host-interaction/file-system/write                   |
| get thread local storage value                       | host-interaction/process                             |
| execute command                                      | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (4 matches)                          | load-code/pe                                         |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
| reference NCR ATM library routines                   | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
2		- Execution::Shared Modules [T1129;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 11.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F5Kw8a1jRGiMwYrM45.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8777987
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 39.561 sec (0 m 39 s)
Start Date: 2022:02:07 15:23:33
End Date:   2022:02:07 15:24:12

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220207T14:23:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3876 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-F5Kw8a1jRGiMwYrM45.exe SCORE: 79 TYPE: EXE SIZE: 50176 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f19fb515fa0> 
MD5: 5b3968b47eb16a1cb88525e3b565eab1 
SHA1: 43f2c73e08b589d6885bd248b056fe4ac99a590b 
SHA256: 5f70c76b6771b7c56bc5da34e424eb9a090cedeb807c795795a88c415a2e772c CREATED: Mon Feb  7 15:23:33 2022 MODIFIED: Mon Feb  7 15:23:33 2022 ACCESSED: Mon Feb  7 15:24:26 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: MinGW_1 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: _pusher_ 
MATCHES: Str1: msvcrt.dll Str2: mingw32 Str3: Mingw runtime failure:
REASON_7: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_9: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220207T14:24:27Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsConsole
10		MinGW_1
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 79

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '10'), ('math_entropy_6', '2'), ('executable_pe', '5'), ('IsPE32', '10'), ('IsConsole', '10'), ('MinGW_1', '10'), ('PE_File', '2'), ('isExecutable', '20'), ('Contains_PE_File', '10')]
-------------- LOKI_Score ------------
['79']
-------------- CAPA_Score ------------
['11.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1471.5444766908563
============================================


==================================================================
Fichier HTTP-F5Kw8a1jRGiMwYrM45.exe Légitime
==================================================================

